"""
Test the performance of Gibbs sampling for recovering a toy dataset, where we 
vary the fraction of entries that are missing.
We repeat this 10 times per fraction and average that.

We use the correct number of latent factors and same priors as used to generate the data.

I, J, K, L = 100, 80, 5, 5
"""

project_location = "/home/tab43/Documents/Projects/libraries/"
import sys
sys.path.append(project_location)

from BNMTF.code.bnmtf_gibbs_optimised import bnmtf_gibbs_optimised
from BNMTF.experiments.generate_toy.bnmf.generate_bnmf import try_generate_M
from ml_helpers.code.mask import calc_inverse_M

import numpy, matplotlib.pyplot as plt

##########

fractions_unknown = [0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95] #[ 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9 ]

input_folder = project_location+"BNMTF/experiments/generate_toy/bnmtf/"

repeats = 10 # number of times we try each fraction
iterations = 1000
burn_in = 800
thinning = 5

init_S = 'random'
init_FG = 'kmeans'
I,J,K,L = 100, 80, 5, 5

alpha, beta = 1., 1.
lambdaF = numpy.ones((I,K))/10.
lambdaS = numpy.ones((K,L))/10.   
lambdaG = numpy.ones((J,L))/10.
priors = { 'alpha':alpha, 'beta':beta, 'lambdaF':lambdaF, 'lambdaS':lambdaS, 'lambdaG':lambdaG }

metrics = ['MSE', 'R^2', 'Rp']

# Load in data
R = numpy.loadtxt(input_folder+"R.txt")

# Seed all of the methods the same
numpy.random.seed(3)

# Generate matrices M - one list of M's for each fraction
M_attempts = 100
all_Ms = [ 
    [try_generate_M(I,J,fraction,M_attempts) for r in range(0,repeats)]
    for fraction in fractions_unknown
]
all_Ms_test = [ [calc_inverse_M(M) for M in Ms] for Ms in all_Ms ]

# Make sure each M has no empty rows or columns
def check_empty_rows_columns(M,fraction):
    sums_columns = M.sum(axis=0)
    sums_rows = M.sum(axis=1)
    for i,c in enumerate(sums_rows):
        assert c != 0, "Fully unobserved row in M, row %s. Fraction %s." % (i,fraction)
    for j,c in enumerate(sums_columns):
        assert c != 0, "Fully unobserved column in M, column %s. Fraction %s." % (j,fraction)
        
for Ms,fraction in zip(all_Ms,fractions_unknown):
    for M in Ms:
        check_empty_rows_columns(M,fraction)


# We now run the Gibbs sampler on each of the M's for each fraction.
all_performances = {metric:[] for metric in metrics} 
average_performances = {metric:[] for metric in metrics} # averaged over repeats
for (fraction,Ms,Ms_test) in zip(fractions_unknown,all_Ms,all_Ms_test):
    print "Trying fraction %s." % fraction
    
    # Run the algorithm <repeats> times and store all the performances
    for metric in metrics:
        all_performances[metric].append([])
    for (repeat,M,M_test) in zip(range(0,repeats),Ms,Ms_test):
        print "Repeat %s of fraction %s." % (repeat+1, fraction)
    
        # Run the Gibbs sampler
        BNMTF = bnmtf_gibbs_optimised(R,M,K,L,priors)
        BNMTF.initialise(init_S, init_FG)
        BNMTF.run(iterations)
    
        # Measure the performances
        performances = BNMTF.predict(M_test,burn_in,thinning)
        for metric in metrics:
            # Add this metric's performance to the list of <repeat> performances for this fraction
            all_performances[metric][-1].append(performances[metric])
            
    # Compute the average across attempts
    for metric in metrics:
        average_performances[metric].append(sum(all_performances[metric][-1])/repeats)
    
 
print "repeats=%s \nfractions_unknown = %s \nall_performances = %s \naverage_performances = %s" % \
    (repeats,fractions_unknown,all_performances,average_performances)


'''
repeats=10 
fractions_unknown = [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9] 
all_performances = {'R^2': [[0.998185524304205, 0.9951921450688566, 0.998047302865917, 0.9979297007628247, 0.9980625717620314, 0.998378361980241, 0.9975783292477035, 0.9980969649399992, 0.9978271991362235, 0.9979706579627173], [0.997723944694483, 0.9976717932557062, 0.9979283182367938, 0.9979044934487292, 0.9978787138668564, 0.9978090755612372, 0.9980795897686455, 0.9978830357811582, 0.9978341649867523, 0.9978573890051081], [0.9979083188011675, 0.9971158506788501, 0.9977732504857821, 0.9976214575531412, 0.9977090529028667, 0.9977815698725234, 0.9978868803897982, 0.9980511456785648, 0.9976944005620709, 0.9977959916656446], [0.9979177373002986, 0.9978004131318091, 0.997829350371225, 0.99780183337049, 0.9978994246007876, 0.9976844457355755, 0.9978511309201912, 0.9978247398255468, 0.9977256142072066, 0.9977870877840281], [0.9977234628694933, 0.9976852127966278, 0.9976071695270259, 0.9977859850373401, 0.9976132566922483, 0.9976079271348435, 0.997578230648432, 0.9976254659027803, 0.9976079355283997, 0.9976454739808525], [0.997265259479572, 0.9975247556973685, 0.9973786511663026, 0.9961660989980509, 0.9974865218552995, 0.9972506763740759, 0.9975673652535634, 0.9976273304247582, 0.9975941120548334, 0.9975653934212548], [0.9969585094263553, 0.997109006550793, 0.9969670467901287, 0.9969727936979911, 0.996913632325234, 0.9970156140254414, 0.9973842281908838, 0.9969572559224866, 0.9971345207674233, 0.9932651382409295], [0.9899713517883306, 0.9884157279987293, 0.9944292790671685, 0.9953493028356852, 0.995238434769166, 0.9955427054635841, 0.9946775860106445, 0.9959215116703484, 0.9954410623106186, 0.995332232643651], [0.9091400319245768, 0.9382383944759967, 0.9716975989003879, 0.6305571752981689, 0.9239030213291858, 0.938537688800508, 0.9667833708402461, 0.94836777578012, 0.9140916693584875, 0.9186176141782751]], 'MSE': [[1.044130764499906, 2.4139080359128964, 1.174428094440781, 1.1566256157501953, 1.2086740245842329, 1.0743758985283698, 1.1968751870910701, 1.0711357758414488, 1.1079168527324941, 1.1240827365415809], [1.173765399856709, 1.1959007007153171, 1.224971734594779, 1.232630411841106, 1.1485666675968322, 1.2014701188076251, 1.1855453745811888, 1.1614322408030453, 1.2017315515847555, 1.1958011354092706], [1.2769991864744963, 1.7995554215940275, 1.1805496214511799, 1.2587603241528436, 1.2672897357533193, 1.1779994486717276, 1.219228000984155, 1.1765313124260157, 1.2306338733957012, 1.2116574978377836], [1.2808309070364796, 1.2569301076499761, 1.260573621936822, 1.2527015001756732, 1.2632051787402248, 1.2968694875345366, 1.1923630725527183, 1.2616223819897514, 1.2557209546512635, 1.2321210808332639], [1.267550124381795, 1.3505814547898933, 1.3889670863756638, 1.3413898710816359, 1.343374918637654, 1.3321739978233957, 1.3636928344478072, 1.2915660732473415, 1.3694959327698075, 1.3156670856004009], [1.4753610142200577, 1.4143945088000158, 1.5437207196644922, 2.1326412026451087, 1.4441471316678816, 1.4466596195057999, 1.4283718400593597, 1.4732136761022112, 1.4428493946266663, 1.4071468300730523], [1.7632238986108744, 1.6905153642210393, 1.7693326322920491, 1.7426467708059412, 1.7771316614806749, 1.7365641247512897, 1.5751189955367642, 1.712675402288736, 1.6437985708622473, 3.8051370686753114], [5.5581304664405806, 6.4771216251795556, 3.2415948718074321, 2.7215311301175076, 2.6222991473624346, 2.5604231415857353, 3.0733280716712916, 2.3804113323328675, 2.6784281225778197, 2.592153036828059], [51.951819511913257, 36.265800647062591, 16.62730305107635, 206.18532128377154, 43.73050111129875, 35.356542003298834, 19.045634587537538, 28.968309668740257, 49.227672608650025, 47.281594631408829]], 'Rp': [[0.99909250017920925, 0.99761844083589213, 0.99903945323235999, 0.9989778896652548, 0.99903914439579089, 0.99919142448208687, 0.9988040895207041, 0.99905604640044021, 0.99892144781606063, 0.99898622117657587], [0.99886484386624896, 0.99883562421300864, 0.99896469790006648, 0.99895181783185061, 0.99894116021977508, 0.99890471566946004, 0.99904011194899633, 0.99894612350718592, 0.9989169762501855, 0.99892897390532198], [0.99895424519569498, 0.99855773549452265, 0.99888914758589042, 0.99881120658850497, 0.99885640031361655, 0.99889032864094907, 0.99894536004257384, 0.99902516695731458, 0.99884687435442043, 0.99889911796498354], [0.99895888553845535, 0.99889979633693793, 0.99891469941796951, 0.99890165269091669, 0.99895216655777896, 0.99884186623078364, 0.9989252997587762, 0.99891318105401083, 0.99886504782766938, 0.99889412271436839], [0.9988627669968384, 0.99884447164728374, 0.99880587095634854, 0.99889468571464179, 0.99880593674998785, 0.99880400616233955, 0.99878897123152843, 0.99881295002839798, 0.99880472744854498, 0.99882416422016929], [0.99863285670978785, 0.99876172284556386, 0.99869120999842176, 0.99808198155755901, 0.9987449011022056, 0.99862539017529961, 0.99878376010502345, 0.99881334791813337, 0.99879671546335402, 0.99878226577274787], [0.99848189520699726, 0.99855443832412261, 0.99848307278147952, 0.99848656793117407, 0.99845766495764365, 0.99851235748913691, 0.99869520612017348, 0.99847913824422296, 0.9985682153194877, 0.99664066589941136], [0.995001457350564, 0.99433541390483104, 0.99721523562188163, 0.9976906456123551, 0.99761676089746587, 0.99777277941086762, 0.99734725597516205, 0.99796029073810621, 0.99773563153387479, 0.99766568802104738], [0.95707697063246222, 0.9700767467356135, 0.98587621212658116, 0.86539133938137569, 0.96122616458200916, 0.97077634374349631, 0.9835812601299353, 0.97555456397485762, 0.95823767716712493, 0.95859963448773389]]} 
average_performances = {'R^2': [0.99772687580307196, 0.99785705186054707, 0.99773379185904099, 0.99781217772471575, 0.99764801201180442, 0.99734261647250799, 0.99666777459376665, 0.99403191945579261, 0.90599343408859545], 'MSE': [1.2572152985922973, 1.1921815335790629, 1.279920442274125, 1.2552938293100708, 1.3364459379155396, 1.5208505937364645, 1.9216144489524929, 3.3905420945903288, 53.464049910475794], 'Rp': [0.99887266577043743, 0.9989295045312101, 0.9988675583138471, 0.99890667181276671, 0.99882485511560815, 0.99867141516480973, 0.99833592222738488, 0.99703411590661573, 0.95863969129611915]}

repeats=10 
fractions_unknown = [0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95] 
all_performances = {'R^2': [[0.9977304165364558, 0.9958484337632015, 0.9946991016733259, 0.9984600739509231, 0.9987108787043687, 0.996918438442937, 0.9948947326980404, 0.9965477614437267, 0.9973521482525584, 0.9962344815335836], [0.9980538990931249, 0.9928462779556669, 0.9979315128565555, 0.9964088417402559, 0.9978681516926907, 0.997851062731593, 0.9978759873895352, 0.9984341365572093, 0.9981768331751985, 0.9977355874876593], [0.9979372115606541, 0.9979564006205363, 0.997607370815898, 0.9981244572138728, 0.997943406603862, 0.9980147312842443, 0.997698448099084, 0.9973346164189013, 0.9946206357137068, 0.9960210703758193], [0.9979192849747648, 0.997875686232387, 0.9954254684143276, 0.9960777066575863, 0.9977538800289228, 0.9950654155796524, 0.9975941079546732, 0.9978209146167978, 0.9959879080678158, 0.9980606226324391], [0.9978631539344189, 0.9968971611684223, 0.9979163383832613, 0.9970255282842687, 0.9975297939828608, 0.9975890628673468, 0.9979592472996135, 0.9953038274366172, 0.9946044992763476, 0.997983657882271], [0.9980061989678627, 0.9978309203206511, 0.9960003804822812, 0.997731132462974, 0.9955441583020259, 0.9979322189560865, 0.9954272774806003, 0.9978409791549313, 0.9978356182616736, 0.9977561243686403], [0.9978252190764109, 0.995744293399712, 0.9956179546015647, 0.9977825028495262, 0.9978391158972572, 0.9976395620825507, 0.9979872893188194, 0.9976854992430177, 0.9950414979175285, 0.9980448774039337], [0.9952238578462257, 0.9979680379835076, 0.9976040206927023, 0.9975997087894845, 0.9963816900624036, 0.9977648921751733, 0.9978366527544721, 0.997802338360167, 0.9977982539923363, 0.9978584594775837], [0.9976237067126693, 0.9977117613166041, 0.9949296918384868, 0.9951114165984976, 0.9951770856192504, 0.9954427959890109, 0.9978314653181303, 0.9977853782959724, 0.9977420714019365, 0.9978177091175003], [0.9977083941295597, 0.9976228126025786, 0.997654897078054, 0.9977085881025979, 0.9949896410877794, 0.9974815415080514, 0.9949751208076849, 0.9977608283878059, 0.997556248956862, 0.9976322746711433], [0.9957009786671515, 0.9956539545901317, 0.9975842356345869, 0.9977503247384579, 0.9974858105198536, 0.9975752413262848, 0.9975736007229752, 0.9950953702091059, 0.99766257041422, 0.9973899945326758], [0.9970442018601582, 0.9976247828095824, 0.9949035494677398, 0.9975591063704334, 0.9974854118932346, 0.9975776876275864, 0.997289132264497, 0.9974530372888757, 0.9946404069298848, 0.9974764131696962], [0.9969754175746416, 0.9939918966459342, 0.9974484905937855, 0.997347449525218, 0.9970998847678205, 0.9973947898180123, 0.997154826214691, 0.9972984924795981, 0.9973768839481293, 0.9966568609787594], [0.9936107074071697, 0.9972190435801113, 0.9969188708847818, 0.9968944647921016, 0.9969701172449037, 0.9968688433844136, 0.9970095089744409, 0.9972244442686635, 0.9969616128769491, 0.9935512469348506], [0.9957694164840568, 0.9966817665698352, 0.9964889866122081, 0.9963220982964596, 0.9942473237474563, 0.9963712066265045, 0.9965521408016388, 0.9965206204573674, 0.9941395701342747, 0.9962691245209846], [0.9956429696524687, 0.9925720422461043, 0.9923862213753434, 0.9800294091232294, 0.9944171902306017, 0.9956514078810652, 0.9942821793687842, 0.9934481874328244, 0.9909567184971732, 0.9934276568284861], [0.9284840463670238, 0.9841006014517468, 0.9859174422297259, 0.9877755198689593, 0.9874925388349071, 0.988815307608537, 0.9889044182039436, 0.9880012131722612, 0.9828373990992629, 0.9656637780949258], [0.877071356940868, 0.9286596827164708, 0.958341938650275, 0.9162842138097168, 0.8588077078987749, 0.9100375647128197, 0.8978820872621931, 0.922918161117212, 0.9424646030474616, 0.8979264645170958], [0.7222324451651807, 0.8708184244358632, 0.665323596322362, 0.7233247555599016, 0.7552643235075459, 0.6450585159311075, 0.8287125342544006, 0.8553790737977089, 0.8057501684345134, 0.7922859863574737]], 'MSE': [[1.1764781531117299, 2.2275267674425798, 3.0008788176762722, 1.0639343340632765, 1.1392254341337529, 1.1875563783066223, 2.892553784925521, 2.1339559335571807, 1.2247585831930456, 2.2967294364415536], [1.1803215262907516, 3.1059682683281493, 1.153275511421664, 2.3179314857194093, 1.2838584845914454, 1.240168934762079, 1.2578026389128505, 1.1238460304079094, 1.3004741417558332, 1.1947565294902596], [1.2337280450057084, 1.0670773988282041, 1.2469462387313637, 1.1656196215235559, 1.140297530025616, 1.1860713534706495, 1.1472861462583426, 1.1802521728911124, 2.8631901993078483, 2.456931605434002], [1.1520538262655575, 1.2011201215774403, 2.660359827132297, 2.262296770641834, 1.2401820571594289, 2.8402413746499171, 1.1747837483098442, 1.2341097057140873, 2.2680139560281973, 1.1958060798926251], [1.3126768480036195, 1.6678581173075409, 1.2464267675030476, 1.6582535439212407, 1.2405664537642731, 1.2799233460800901, 1.1504638902909821, 2.525480052360046, 2.8019452621614764, 1.1523968139924883], [1.1636160336539527, 1.1580139066269926, 2.4554229232127529, 1.2254300694321481, 2.6920393970882777, 1.2282702031861594, 2.5991006580092622, 1.1835171919965726, 1.2467398653818922, 1.2785127730698094], [1.1994087891429377, 2.6279296184877015, 2.6113469811628405, 1.218802873814155, 1.2553153931171701, 1.3468169231593705, 1.1794255333025006, 1.3110730640435284, 2.6067560442611928, 1.2318244850215094], [2.5588185200468128, 1.2899601201023896, 1.3105371516573641, 1.3274033010474411, 1.9068054395473326, 1.2234479351143532, 1.2189996214231322, 1.3322041576845336, 1.2584199778951619, 1.2342248450130042], [1.285888611280585, 1.3614857285631687, 2.6258003829505649, 2.7895632744672088, 2.6192514367075241, 2.7522118830721376, 1.3169063003962225, 1.2926458801770926, 1.3104472168488477, 1.3566619502360693], [1.3195154321636966, 1.3278570702140824, 1.3080960704059392, 1.2644817265375026, 2.832768947903928, 1.3558555904253387, 3.0105499727886116, 1.2675577345437978, 1.3276610982244237, 1.3819080487654307], [2.626593170193356, 2.373156604497793, 1.3988342270760086, 1.2966570017110333, 1.3968875195785748, 1.39657370460328, 1.4026288702843954, 2.7987935129102994, 1.3463790757842173, 1.409414662594535], [1.738970057658604, 1.3982789906654829, 2.9734517363468287, 1.4195411741123394, 1.4323766372494673, 1.4378570708761791, 1.4908805845158193, 1.4491336987441736, 3.0794107159520352, 1.4595244188402428], [1.7196998043574991, 3.2792724966986979, 1.4257403109494302, 1.5745483650618026, 1.7399394025536181, 1.5499407780839021, 1.5736742288496135, 1.5588950118473246, 1.5499680440207659, 1.9395369924172021], [3.8351315866346574, 1.6409483741360269, 1.7421067320155894, 1.7168250070872448, 1.7440359184134477, 1.7725827063391923, 1.7635646492243144, 1.6327018790008012, 1.7795082979576189, 3.692859445615976], [2.3635685338693491, 1.9388580929788004, 2.0327703213822947, 2.0963067743668486, 3.3926983981491414, 2.1303089819107734, 1.8977976220850989, 2.0275177577218249, 3.4049450702135653, 2.1200353727774393], [2.5010206593364201, 4.3832137267840023, 4.1653661304123641, 11.712182665661985, 3.2269644084958906, 2.553673699017013, 3.4168242050315256, 3.8494172527655803, 5.1459810423263708, 3.7558274843814434], [40.192124911138158, 9.3678106616751915, 8.1396809324352351, 7.0302210414553068, 7.2514938545056298, 6.311214300028106, 6.3817466252832826, 6.9012545395731983, 9.6268825906850548, 18.900030438202464], [70.426523646657557, 41.016554485200288, 23.810101911622631, 48.222969262549064, 81.941121699778208, 50.980350054607946, 58.411863950644786, 44.65380776459606, 32.65388627783161, 57.385325905147006], [159.73498747447229, 74.739066062873007, 193.80481627602379, 157.50512178291694, 140.20450214609838, 204.53990476002966, 98.457613867779301, 82.670359094909983, 111.14616452473722, 118.66610721031037]], 'Rp': [[0.9988664028033124, 0.9979419322352554, 0.99735088221433044, 0.99923042837419118, 0.99935902425521062, 0.99846304494818339, 0.9974441821437382, 0.99830792210140418, 0.9986872774683101, 0.99811829291181753], [0.99903060725383863, 0.99646237008423866, 0.99896559748208813, 0.99821172297128269, 0.99894446632996625, 0.99892864312559104, 0.99893760939875575, 0.99921690700531551, 0.99909018723536014, 0.99887949163852929], [0.99897081547119149, 0.99897949331737235, 0.99880335393416542, 0.99906635056065274, 0.99897165267322585, 0.99900744942121467, 0.9988488942620517, 0.99867127453838911, 0.99730809792921915, 0.99800936804549689], [0.99895910615773564, 0.99893808080172464, 0.99771178787382808, 0.99803734781345466, 0.99887969192466897, 0.99754492867336364, 0.99879759936041146, 0.99891054199954632, 0.99800476140487293, 0.99903157866230374], [0.9989318488819926, 0.99844966769490484, 0.99896086125592742, 0.99851288162213314, 0.99876697403460568, 0.99879567088920951, 0.99898168731432335, 0.99765956847022508, 0.9973087294250329, 0.99899205326650975], [0.9990032619191388, 0.9989187086636736, 0.99799823510018359, 0.99886605211542678, 0.99777362618386212, 0.99896603192708389, 0.99771182640077172, 0.99892033826379212, 0.99891877609614643, 0.99887767717525777], [0.99891214252607508, 0.99787121009084412, 0.99781015795367911, 0.99889352336837156, 0.99892196828044477, 0.99882005870415935, 0.99899657806967401, 0.99884210368785165, 0.99752022541174701, 0.99902547786136686], [0.9976122832805242, 0.99898841950810402, 0.99880410175538781, 0.99880607225040063, 0.99818928488999892, 0.99888454204569921, 0.99891878741005902, 0.99890083509046079, 0.99890214616724537, 0.99892910898479947], [0.99881140888417719, 0.99885608988628061, 0.99747738994065893, 0.99755707166497365, 0.99758579207313913, 0.99772931671322462, 0.99891548243027461, 0.99889216976106576, 0.99887463493268325, 0.99890886768249065], [0.99885365200687526, 0.99881260188628229, 0.99882761053670344, 0.99885532512567932, 0.99749361225587363, 0.99874015909443925, 0.9974937329880571, 0.9988801279435302, 0.99878186186373219, 0.99881835093407856], [0.99784829109829476, 0.99782729909663959, 0.99879383447501913, 0.99887513496588753, 0.99874977321910174, 0.99879193382063747, 0.99878803014433815, 0.99754621369726526, 0.99883153592109475, 0.99869641528079722], [0.99852257422424306, 0.9988117555909205, 0.99747959174142076, 0.99878042251638643, 0.99874621772452743, 0.99878820679202696, 0.99864442568684841, 0.99872911379759943, 0.99732256515265527, 0.99873762912129482], [0.99848727554465766, 0.99699979348434098, 0.99872583842906837, 0.99867437267994164, 0.99854906695260881, 0.99869786898223567, 0.99857988392404295, 0.9986485530360163, 0.99868879620721074, 0.99832869999350915], [0.99680256308799131, 0.99860889803210817, 0.99845889004856847, 0.9984462527681528, 0.99848521316747108, 0.99843439888885099, 0.99850531428715483, 0.99861185420023002, 0.99848086244765388, 0.99677157377272962], [0.99789193543621613, 0.99834052781750726, 0.99824568406675962, 0.99816592055606435, 0.99714627961696289, 0.99818423274421164, 0.99827519338624104, 0.99826208699033914, 0.99707933814311833, 0.99813309695788277], [0.99782091199974199, 0.99630577280155519, 0.99623452374566734, 0.99014358038785444, 0.99720579030256118, 0.99782474148921185, 0.99715687519500751, 0.9967201783455174, 0.9954681710462302, 0.99670919475922704], [0.96695613696128979, 0.99207217395155045, 0.99301461839459038, 0.99393285159056477, 0.99373344960994792, 0.99441728623683134, 0.99447297804009793, 0.99402229679606413, 0.99170209618039229, 0.98290847371189616], [0.94318260822999733, 0.96500687689542797, 0.97953452633476068, 0.95736138467100629, 0.9340562192933326, 0.95639483923981206, 0.95293454168750036, 0.96400422235651617, 0.97162856531622932, 0.95281340409056725], [0.85997653964949738, 0.93520796435754228, 0.85182560181273481, 0.87140377802299651, 0.8875239151940425, 0.86176506842112843, 0.91277377460973708, 0.92937107857990342, 0.91459481837498291, 0.89854150575191216]]} 
average_performances = {'R^2': [0.9967396466999121, 0.9973182290679489, 0.9973258348706577, 0.9969580995159367, 0.9970672270515427, 0.9971905008757727, 0.9971207811790321, 0.9973837912134055, 0.9967173082208058, 0.9971090347332117, 0.9969472081355445, 0.9969053729681688, 0.996874499254659, 0.9963228860348388, 0.9959362254250788, 0.9922813982636081, 0.9787992264931292, 0.9110393780672886, 0.7664149823766058], 'MSE': [1.8343597622851533, 1.5158403551680351, 1.4687400311476402, 1.7228967467371228, 1.6035991095384801, 1.6230663021657818, 1.6588699705512906, 1.4660821069531527, 1.8710862664699419, 1.639625169197275, 1.7445918349233493, 1.7879425084961174, 1.7911215434839858, 2.1320264596424869, 2.3404806925455137, 4.4710471274212598, 12.010245989498163, 50.950250495863514, 134.14686432001514], 'Rp': [0.99837693894557522, 0.99866676025249679, 0.99866367501529785, 0.99848154246719112, 0.99853599428548634, 0.9985954533845337, 0.99856134459542134, 0.99869355813826799, 0.99836082239689694, 0.99855570346352507, 0.99847484617190752, 0.99845625023479234, 0.99843801492336315, 0.99816058207009117, 0.99797242957153043, 0.99615897400725739, 0.98972323614732249, 0.95769171881151516, 0.89229840447744768]}
'''


# Plot the MSE, R^2 and Rp
for metric in metrics:
    plt.figure()
    x = fractions_unknown
    y = average_performances[metric]
    plt.plot(x,y)
    plt.xlabel("Fraction missing")
    plt.ylabel(metric)