"""
Test the performance of variational Bayes for recovering a toy dataset, where 
we vary the fraction of entries that are missing.

We use the correct number of latent factors and same priors as used to generate the data.

I, J, K, L = 100, 50, 10, 5
"""

project_location = "/home/tab43/Documents/Projects/libraries/"
import sys
sys.path.append(project_location)

from BNMTF.code.bnmtf_vb_optimised import bnmtf_vb_optimised
from BNMTF.experiments.generate_toy.bnmtf.generate_bnmtf import try_generate_M
from ml_helpers.code.mask import calc_inverse_M

import numpy, matplotlib.pyplot as plt

##########

fractions_unknown = [0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95] #[ 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9 ]

input_folder = project_location+"BNMTF/experiments/generate_toy/bnmtf/"

repeats = 10 # number of times we try each fraction
iterations = 1000
I,J,K,L = 100, 80, 5, 5

alpha, beta = 1., 1.
lambdaF = numpy.ones((I,K))/10.
lambdaS = numpy.ones((K,L))/10.
lambdaG = numpy.ones((J,L))/10.
priors = { 'alpha':alpha, 'beta':beta, 'lambdaF':lambdaF, 'lambdaS':lambdaS, 'lambdaG':lambdaG }

init_S = 'random'
init_FG = 'kmeans'

metrics = ['MSE', 'R^2', 'Rp']

# Load in data
R = numpy.loadtxt(input_folder+"R.txt")

# Seed all of the methods the same
numpy.random.seed(3)

# Generate matrices M - one list of M's for each fraction
M_attempts = 100
all_Ms = [ 
    [try_generate_M(I,J,fraction,M_attempts) for r in range(0,repeats)]
    for fraction in fractions_unknown
]
all_Ms_test = [ [calc_inverse_M(M) for M in Ms] for Ms in all_Ms ]

# Make sure each M has no empty rows or columns
def check_empty_rows_columns(M,fraction):
    sums_columns = M.sum(axis=0)
    sums_rows = M.sum(axis=1)
    for i,c in enumerate(sums_rows):
        assert c != 0, "Fully unobserved row in M, row %s. Fraction %s." % (i,fraction)
    for j,c in enumerate(sums_columns):
        assert c != 0, "Fully unobserved column in M, column %s. Fraction %s." % (j,fraction)
        
for Ms,fraction in zip(all_Ms,fractions_unknown):
    for M in Ms:
        check_empty_rows_columns(M,fraction)


# We now run the VB algorithm on each of the M's for each fraction.
all_performances = {metric:[] for metric in metrics} 
average_performances = {metric:[] for metric in metrics} # averaged over repeats
for (fraction,Ms,Ms_test) in zip(fractions_unknown,all_Ms,all_Ms_test):
    print "Trying fraction %s." % fraction
    
    # Run the algorithm <repeats> times and store all the performances
    for metric in metrics:
        all_performances[metric].append([])
    for (repeat,M,M_test) in zip(range(0,repeats),Ms,Ms_test):
        print "Repeat %s of fraction %s." % (repeat+1, fraction)
    
        # Run the VB algorithm
        BNMTF = bnmtf_vb_optimised(R,M,K,L,priors)
        BNMTF.initialise(init_S,init_FG)
        BNMTF.run(iterations)
    
        # Measure the performances
        performances = BNMTF.predict(M_test)
        for metric in metrics:
            # Add this metric's performance to the list of <repeat> performances for this fraction
            all_performances[metric][-1].append(performances[metric])
    
    # Compute the average across attempts
    for metric in metrics:
        average_performances[metric].append(sum(all_performances[metric][-1])/repeats)
        

print "repeats=%s \nfractions_unknown = %s \nall_performances = %s \naverage_performances = %s" % \
    (repeats,fractions_unknown,all_performances,average_performances)


'''
repeats=10 
fractions_unknown = [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9] 
all_performances = {'R^2': [[0.9950277311670301, 0.9950362540064918, 0.9977338762826371, 0.9946418108005373, 0.9984314418887056, 0.9979171620315069, 0.9982375822670195, 0.9981472503628788, 0.9976181499418831, 0.9982023621563685], [0.994796648525581, 0.9977153753127386, 0.998095838501728, 0.9978227916289657, 0.9982815606110297, 0.9983027985302119, 0.9955787303766429, 0.9949469934228514, 0.9978972809253873, 0.9952479717554424], [0.9977480926165051, 0.9980685063734909, 0.9957328274572746, 0.9977347232024003, 0.9950283364083812, 0.9954314156259906, 0.9951030139929761, 0.9978582793458053, 0.9954916017454035, 0.9953709637017584], [0.9977319322135799, 0.997687088737984, 0.994946942179349, 0.9949536855384639, 0.9950621464173323, 0.9978791402297771, 0.9979310192347216, 0.9978046639030107, 0.9978505415336579, 0.995849608377376], [0.9977155944222503, 0.9952479671434111, 0.9689641168223063, 0.995260359919225, 0.995250983933575, 0.9744961487049554, 0.9953063281467225, 0.9950617811119985, 0.9707114581654543, 0.9732861326889626], [0.9735061002342034, 0.9728466153373351, 0.9947599190009041, 0.9948960324500463, 0.9949461228865316, 0.994865632554931, 0.9948504782894455, 0.974797101037195, 0.9717573278727932, 0.9696867239821485], [0.9663439526247147, 0.9685369361042374, 0.9712678819552871, 0.9940464888515127, 0.9699058477359624, 0.9712432932901175, 0.9687191998424838, 0.9713571770401356, 0.9944948321180072, 0.9709790071625185], [0.9680331784831949, 0.9638252691829845, 0.9567874670120828, 0.9603646899881294, 0.9666936166921205, 0.9460833406184549, 0.9554628031118125, 0.9649361961029994, 0.9577191791733791, 0.9616833474402544], [0.8978838535283761, 0.9133593258182544, 0.9032214670066678, 0.9081531157581764, 0.9318886911810746, 0.9052656310769353, 0.9083605976522274, 0.9083860602114315, 0.9019612406798678, 0.8508822932819876]], 'MSE': [[2.5690679020125105, 2.6230751690901486, 1.1875172610544722, 2.5589152559511326, 1.1180264569052294, 1.1806693736737592, 1.1501341539616372, 1.1304715320116827, 1.1606818630980338, 1.0423986988231237], [2.7028553044362815, 1.2952389738583379, 1.1922107904845272, 1.1928545946117648, 1.2338003167777349, 1.1162418385839967, 2.6283360550034076, 2.8090357462404563, 1.1929282632957234, 2.4819678904821041], [1.206773931576069, 1.2576820539879119, 2.4560848649633007, 1.2431073549114398, 2.6836572952414479, 2.6421439967270337, 2.8157250241168597, 1.2085902656108276, 2.4297302861812717, 2.7345722356687618], [1.1750966372504097, 1.326909891614934, 2.6671327349641132, 2.8137891351688298, 2.7504832018970609, 1.267010892794691, 1.2050482263152056, 1.2547299207237541, 1.2555319752255851, 2.45469211521015], [1.3125799670217229, 2.9280965338523437, 17.871096625690203, 2.7109506834144077, 2.6740406632748051, 14.088530610418518, 2.6397519531013556, 2.8787168876784084, 15.889736336652422, 15.525039507066241], [15.935804011504203, 15.397322216717646, 3.0700822539145065, 3.0354431163934068, 2.8612933732674413, 3.1151683931513632, 2.9274513615773663, 14.295230867400248, 15.725075146373452, 16.571422575544709], [19.267423426482345, 17.311021683613312, 16.452431105066676, 3.4970347264040083, 16.982186660187228, 16.65709177072673, 17.941515232117851, 16.24443402638974, 3.264741151910485, 16.457635760568635], [18.38319881379693, 21.672455898217198, 25.241619174400661, 22.191529441855756, 19.394644897563001, 30.274956985107384, 25.210283046297203, 19.997192203359688, 23.967108976951032, 22.521792474824839], [57.999642364109533, 49.628370346413817, 56.184034523132212, 52.810738994732148, 38.67731867855111, 53.485198888748151, 52.351827681455454, 52.375659920923709, 55.638334994140322, 83.975284945245662]], 'Rp': [[0.99761749026084123, 0.99752261197260328, 0.99886918284591508, 0.99731846172815442, 0.99921631217022377, 0.99895817837649048, 0.9991290606699833, 0.99907838488622802, 0.99880910010583546, 0.99910190856425674], [0.99740076464038108, 0.99885777618563687, 0.99904945305637205, 0.9989115074913697, 0.99914133141295558, 0.99915189712806773, 0.99778776511168032, 0.99748310011231534, 0.99895203564433788, 0.99762370046939242], [0.99887362711069705, 0.99903791776253348, 0.99786523089933277, 0.99886851169004043, 0.99751301048096686, 0.9977163912005319, 0.99755257373710504, 0.99892869048730681, 0.997743390561459, 0.99768380336783768], [0.99886775014717044, 0.99884537089121361, 0.99748405742546542, 0.99747618721438225, 0.997531595757987, 0.99894240887195651, 0.99896561848911569, 0.99890260985772705, 0.99892548487710497, 0.99793131046923778], [0.99885992882656371, 0.99762822599135359, 0.98440474644165676, 0.99763552999821836, 0.99762266628386953, 0.98722742295368149, 0.99765154026069192, 0.99754002649692564, 0.98535720622923084, 0.98656132967826082], [0.98666423349660159, 0.98636925524194763, 0.99737819562566143, 0.99744602635934176, 0.99746994031682679, 0.9974463063612653, 0.99742526574047186, 0.98732219723463632, 0.98578189587658605, 0.98474359185872384], [0.9831967783043416, 0.98414690970813468, 0.98570406525321341, 0.99701903782135781, 0.98486074552004454, 0.98553177985683516, 0.98425224576241144, 0.9857552545952557, 0.99726941096560517, 0.98545250822422581], [0.9838949235668043, 0.98175632611174024, 0.97820289675532945, 0.98029398758884145, 0.98323405786295071, 0.9741814795324456, 0.9780612374039469, 0.98232229041777752, 0.97901377075938256, 0.98067533893216707], [0.94957860676727501, 0.9570512150575875, 0.95055391393911348, 0.95374057059794737, 0.96863208622115105, 0.95386511302885924, 0.95359173477112102, 0.95337309590377739, 0.95201684470361014, 0.93503054821936826]]} 
average_performances = {'R^2': [0.9970993620905059, 0.9968685989590579, 0.9963567760469985, 0.9967696768365254, 0.986130087105886, 0.9836912053645535, 0.9746894616724978, 0.9601589087805413, 0.9029362276194999], 'MSE': [1.572095766658173, 1.7845469773774334, 2.0678067308984924, 1.8170424731164734, 7.8518539768170426, 9.2934293315844343, 14.407551554346702, 22.885478191237368, 55.312641133745217], 'Rp': [0.99856206915805301, 0.99843593312525081, 0.99817831472978114, 0.99838723940013607, 0.99304886231604539, 0.99180469081120626, 0.98731887360114268, 0.98016363089313852, 0.9527433729209811]}

repeats=10 
fractions_unknown = [0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95] 
all_performances = {'R^2': [[0.9977006683930278, 0.9966943703073206, 0.9986120987495751, 0.9964720411691669, 0.9919355448723148, 0.9947525704423978, 0.9954892869737146, 0.997628681823473, 0.9976724250222543, 0.9981235779093628], [0.9678988210348753, 0.9980151930230418, 0.9980433300439043, 0.9981844931322473, 0.997883550316856, 0.9983325978037331, 0.9969740666994525, 0.9980464205361672, 0.9982280613574255, 0.9964186133053866], [0.9959777672580927, 0.9956158994785365, 0.9954332522729695, 0.9980231065868871, 0.9953488235934648, 0.9958865332603605, 0.9954995365952796, 0.982722306514392, 0.9979051941780704, 0.9979022824551776], [0.997680773027442, 0.9976796132635622, 0.9950305463181409, 0.9978660425979449, 0.9955241250332677, 0.9954015088476484, 0.9980232191368472, 0.9963687642268484, 0.995373906350267, 0.9975841092222684], [0.9957437281070717, 0.9762964000313374, 0.9949631425482995, 0.9949897007399612, 0.9960650283071762, 0.9955559119159711, 0.9961419906221786, 0.995665341601579, 0.9754646796994492, 0.9948015916285938], [0.9953353367565079, 0.997891868326322, 0.9958646504973667, 0.9978672682167422, 0.9977478919982001, 0.9725179074461503, 0.9978329942720663, 0.995327172423397, 0.995642796919082, 0.9956866057669127], [0.9958363160624261, 0.9951028837167735, 0.997715972611882, 0.9961531471381281, 0.9978894484634087, 0.9955333912584289, 0.9949011713531943, 0.9956039900086885, 0.995326288579562, 0.9955070135265345], [0.9976657209459519, 0.9743490128519192, 0.9977488999776981, 0.9949435573688411, 0.9976847457449154, 0.9977244762965239, 0.9959289127963934, 0.9740793423906937, 0.9955403875888291, 0.994960902125144], [0.9953280810500336, 0.9976725509311054, 0.9765434379423625, 0.9953695417384406, 0.9954964154632383, 0.9977763074400111, 0.9744681019214216, 0.9950397307282717, 0.9977551856253037, 0.9950214152300616], [0.9744906634087062, 0.9952824515645314, 0.9754335901211766, 0.9951632944261242, 0.9942078065665281, 0.9733497758553119, 0.9716489286920924, 0.9951191517134539, 0.9712746132098727, 0.9952481590209418], [0.9742263145920499, 0.9953258544796155, 0.997454141217115, 0.9700870764916829, 0.9720988867296809, 0.9949783816861746, 0.9975600116856875, 0.974399292513021, 0.9946465895842856, 0.9711141463036762], [0.9954311256335348, 0.9949784827122841, 0.9706835058985607, 0.9950223391760827, 0.9951800396400141, 0.9974235196178383, 0.9717458446633533, 0.9929951620939532, 0.9719793832764467, 0.9751005367492004], [0.9731955289473813, 0.9722453455145845, 0.9943428559102748, 0.9698829352074525, 0.994000406194376, 0.9697960574362029, 0.9741961905697181, 0.9713348939403086, 0.9711896099812724, 0.9696133108718682], [0.9617146420936931, 0.9671576779360624, 0.9943392886655344, 0.9616966752134279, 0.9940166488997917, 0.969349368254668, 0.9716616103158128, 0.9730878574553301, 0.969988942559874, 0.9701542139097535], [0.9934821279570089, 0.9483232569402642, 0.9632233005025453, 0.9696926201374039, 0.9938688110802893, 0.967174769117133, 0.9688053800543105, 0.8041395099390125, 0.9625465573854802, 0.9685747595825607], [0.958756628803076, 0.9561173941497608, 0.9613323944333442, 0.9625183416557881, 0.9648318300553911, 0.9633022601666763, 0.9557170893687541, 0.9460018889000406, 0.9611745144274751, 0.9575706442268681], [0.9496467607543836, 0.9386653871912044, 0.9569365538418357, 0.9524568959454887, 0.9134046969869835, 0.9540801402506179, 0.9609263587705696, 0.955023083136412, 0.956678865884998, 0.9543328512672947], [0.8829412304720841, 0.8999653094189439, 0.9081633265973288, 0.9248214804994964, 0.8928759011566261, 0.9003352525367259, 0.8995973913603058, 0.901589095117178, 0.8971558112551657, 0.8969989216533258], [0.8395426030135819, 0.8470369796922508, 0.8513427202237499, 0.8532117889321122, 0.8549143222464521, 0.8778127260754379, 0.8299020508178856, 0.8394295432374045, 0.8544393780812345, 0.8483426108637303]], 'MSE': [[1.1735182635852033, 2.2563347799001892, 1.1970670794057774, 2.5015650982131641, 3.9683843989492544, 3.8032203029899536, 2.0861617362458129, 1.1961720705264758, 1.1441385560143613, 1.1512018060845512], [17.434551811176007, 1.0938951100733878, 1.1364574669119132, 1.1430419176305993, 1.2035038064220023, 1.1083807979758751, 2.2044812190527607, 1.1915513618146385, 1.1081693088745197, 2.1423911955787185], [2.2010522037884743, 2.6299690170587882, 2.5330376793699143, 1.1392606172833291, 2.4603930992872756, 2.3202503687819664, 2.225414089150819, 11.014627055447201, 1.1542249287706896, 1.1108140186609705], [1.196722009869192, 1.2411570544873998, 2.4719208479310093, 1.2438160020538758, 3.0022692325648284, 2.7658096549173581, 1.2000652369133975, 2.2144053951432259, 2.3495894800343873, 1.197843436977164], [2.3547966352658531, 14.013338254218249, 2.4841196306270348, 2.6662769699964861, 2.4730853850784063, 2.5381364521727079, 2.318841700295585, 2.3354915255979329, 14.287286387917103, 2.9976402433343359], [2.7164774317485905, 1.2040854793636369, 2.4147700597269468, 1.2625345530205163, 1.1946735149492684, 15.952051508666885, 1.2240568350067476, 2.5696365479709335, 2.600229928596939, 2.5040991576505198], [2.4042840925426563, 2.5853208740838536, 1.2896718348532761, 2.207090772269392, 1.1795104395844012, 2.8947757737186897, 2.6741514501579831, 2.4347234782391549, 2.6670479714448043, 2.5206058317437807], [1.2877207644795374, 13.952474093967346, 1.2617666562057273, 2.6247824841301997, 1.3085445130583688, 1.2497321242779882, 2.5141210494214148, 14.454758804894205, 2.6054285305073575, 2.8993452024834716], [2.653666710959008, 1.2874651565240423, 14.550217360437356, 2.5508806633921868, 2.601987523411001, 1.3149249379436172, 13.740352782808595, 2.6244845885817467, 1.4073423101206286, 2.7969604955508065], [15.157213141707794, 2.6779072759448956, 15.108471576612713, 2.7907862413345761, 3.0476835047965132, 14.737345124853315, 15.980711078235402, 2.8161610605123677, 16.517728466667418, 2.8930170834001352], [14.298340602700584, 2.8552006862612482, 1.4438510665526174, 16.248810525013347, 15.728363520892536, 2.8644073220241819, 1.3711300561108495, 15.047530606826539, 3.1340891610732156, 16.68404713537868], [2.6995216666171693, 2.8300268269348581, 17.043319241461827, 2.9389827547492406, 2.8248143863322071, 1.3960528971068411, 15.647412216328137, 4.0350306203704118, 15.79103695111111, 15.100423744493337], [14.873123157027218, 16.435834992314035, 3.1238602494863574, 16.649042310584456, 3.3738940996839251, 16.347618631109953, 14.893979385743153, 16.676032247960372, 16.735166679023362, 17.988558453364199], [21.776289220623479, 19.124540271154569, 3.2403401792036166, 22.114946856905998, 3.4305181499738553, 17.383747162274997, 16.323073955677195, 15.081694896082922, 17.53850419512732, 17.203228546648774], [3.6668884271994413, 28.639933775692551, 20.898964820133827, 17.007142503923667, 3.4019337128868883, 19.523891605865177, 17.891140259203585, 116.09730415817856, 22.003315008779289, 17.820591285540008], [23.553483082325059, 24.889940618928858, 21.96707656977425, 21.306003352468839, 19.875032373308251, 21.015445390761688, 25.338436510126122, 31.729706070198617, 22.12762636080198, 23.758918405090569], [28.577005631009857, 35.755268290714248, 25.011676394868914, 27.159210465035805, 51.91277456006511, 25.894063256029995, 22.756570721042191, 25.77096289326709, 24.579637158435865, 25.800553849525116], [68.142163461996873, 57.547054718428519, 52.817858787854583, 43.196888253896518, 61.458008814491755, 57.325913166683655, 56.32872017328674, 57.001080278185775, 58.67974535404386, 59.126240160133158], [92.658729365414217, 85.989136098740701, 86.029536233511465, 84.582682982565146, 83.02127151815057, 70.614950977240042, 95.536777236140978, 91.375286589088176, 83.535222409316248, 87.891396480432348]], 'Rp': [[0.99886096927738621, 0.99835259870232396, 0.99930689870811928, 0.99823563351338895, 0.99611180382415898, 0.99739395375724049, 0.99774342050345577, 0.99881893413272804, 0.99883590091058316, 0.99907047510516467], [0.9839531372106447, 0.99900933269451475, 0.99902137700712224, 0.9990939794874828, 0.99894248287360554, 0.99916920869826165, 0.99849690613952913, 0.99903090681614781, 0.99912572611112094, 0.99820949843086293], [0.99799099392294432, 0.99780559989688677, 0.99773541751250172, 0.99901350374410736, 0.99767727826743524, 0.9979444352319996, 0.99774920854932014, 0.99133556616625917, 0.99895245297805779, 0.99895092672195052], [0.99884118694781576, 0.99884295051533745, 0.99751267047810677, 0.99893535922424581, 0.99776619119586751, 0.99770108223120224, 0.99901278293111528, 0.99818569478893138, 0.99769884761211813, 0.99879389877604052], [0.99787360211566156, 0.98810353552480867, 0.99748662707443803, 0.99749633785573566, 0.99803183756014235, 0.99777622318656833, 0.99807831294692972, 0.99783040444988358, 0.98765797117035803, 0.997411604063692], [0.9976662026348222, 0.99894614378638269, 0.99793174632174297, 0.99893361155157523, 0.99887397900652453, 0.98616461271402867, 0.99891646723926353, 0.99766561191825309, 0.99782751299907446, 0.99784510815782457], [0.99791653963701199, 0.9975579888087277, 0.99885849500687329, 0.99807555287008687, 0.9989457867403233, 0.99777253153810164, 0.99744952319745506, 0.99780212509436783, 0.99766606994952589, 0.99775261441240637], [0.99883329915833174, 0.98709596190553928, 0.99887382741594644, 0.99747108422194541, 0.99884897626475355, 0.99886228235521368, 0.99796252132967045, 0.98698667944765373, 0.99777193565548561, 0.99748017770552999], [0.99766178258915672, 0.9988380992860032, 0.98830756654964413, 0.99768509429284269, 0.99774708597531536, 0.99888770672389049, 0.98715872362634538, 0.99753197460298271, 0.99887838600412748, 0.99751683219579501], [0.98718593616341255, 0.997639845217966, 0.98764243239489147, 0.99758203923085365, 0.99709982723123258, 0.98662789418725294, 0.98573005969881988, 0.99755947805812595, 0.98555803586049584, 0.99762529174661096], [0.98703520328757788, 0.99766397518297323, 0.99873248164701423, 0.98498258541277894, 0.98596795148173089, 0.9974877665710119, 0.99878023644186664, 0.98713035865113008, 0.99732784455437751, 0.98583984532004931], [0.99771312449054794, 0.99748817519223631, 0.98537397468451349, 0.99750899768536838, 0.9975905435461534, 0.99871182882024467, 0.98586017878238885, 0.99649413799148456, 0.98589908999400278, 0.98749401940240189], [0.98650852739070982, 0.98607677729498922, 0.99716920284738231, 0.98486709068660228, 0.9970051201300153, 0.9848000963721546, 0.98701627877996823, 0.98556769752232587, 0.98559962642354704, 0.98471337517663649], [0.98080685600153772, 0.98369247199056964, 0.99717899485784478, 0.98086151554887369, 0.99700971531301785, 0.98463389969017101, 0.98576334235480689, 0.9864630885332899, 0.98493901833732966, 0.98503853547679465], [0.99674403009248247, 0.97460407298331775, 0.98162915420550301, 0.9847517253400675, 0.99693267056609292, 0.98351231279228202, 0.98432580846816919, 0.89957541194629764, 0.98112431499067843, 0.98434159408777766], [0.97921071955610139, 0.97836645300842284, 0.98071754126854671, 0.98116664259940956, 0.98234759882382905, 0.98156584882759956, 0.9779357780201503, 0.97310375719719089, 0.98057595238481765, 0.97882071187835118], [0.97470556943777642, 0.97042935906765104, 0.97830608367331895, 0.97598712257060471, 0.9559193515475215, 0.97747472977143002, 0.98029801804972927, 0.97741234529254295, 0.97814556246059192, 0.97703389415252007], [0.93981558771652596, 0.94899845868304988, 0.95325235369331474, 0.96282367536427493, 0.9456907833678021, 0.94946080402623267, 0.94941988030989488, 0.94984093019206162, 0.94821033813496236, 0.94740621179088313], [0.91778205124195633, 0.9250343362281539, 0.92318251211918134, 0.9282329239703111, 0.93330460058342091, 0.93811117216560425, 0.91796551018354067, 0.92236857144276485, 0.92659494096600292, 0.92155547674588711]]} 
average_performances = {'R^2': [0.9965081265662608, 0.9948025147253091, 0.995031470219323, 0.9966532608024238, 0.9915687515201619, 0.9941714492622747, 0.9959569622719027, 0.9920625958086908, 0.9920470768070251, 0.984121843457874, 0.984189069528299, 0.9860539939461267, 0.9759797134573438, 0.9733166925303948, 0.9539831092696007, 0.9587322986187173, 0.9492151594029787, 0.9004443720067179, 0.8495974723183839], 'MSE': [2.0477764091914743, 2.976642399551042, 2.8789043077599428, 1.8883598350891837, 4.84690131845037, 3.3642615016700987, 2.2857182518637993, 4.4158674223425622, 4.5528282529728985, 9.1727024554065135, 8.9675770682833793, 8.0306621305505139, 13.709711020629703, 15.321688343367274, 26.695110555740296, 23.556166873378423, 29.321772321999418, 57.162367316900145, 86.123498989059982], 'Rp': [0.99827305884345496, 0.99740525554692927, 0.99751553829914597, 0.99832906647007813, 0.99577464559482176, 0.99707709963294922, 0.99797972272548796, 0.9960186745460069, 0.99602132518461028, 0.99202508397896616, 0.99209482485505107, 0.99301340705893415, 0.98793237926243305, 0.98663874381042349, 0.97675410954726671, 0.97938110035644177, 0.9745712036023686, 0.94949190232790026, 0.92541320956468243]}
'''


# Plot the MSE, R^2 and Rp
for metric in metrics:
    plt.figure()
    x = fractions_unknown
    y = average_performances[metric]
    plt.plot(x,y)
    plt.xlabel("Fraction missing")
    plt.ylabel(metric)