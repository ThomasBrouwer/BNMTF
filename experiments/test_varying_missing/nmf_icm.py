"""
Test the performance of ICM for recovering a toy dataset, where 
we vary the level of noise, and use 10% test data.
We repeat this 10 times per noise level and average that.

We use the correct number of latent factors and same priors as used to generate the data.

I, J, K = 100, 80, 10
"""

project_location = "/home/tab43/Documents/Projects/libraries/"
import sys
sys.path.append(project_location)

from BNMTF.code.nmf_icm import nmf_icm
from BNMTF.experiments.generate_toy.bnmf.generate_bnmf import try_generate_M
from ml_helpers.code.mask import calc_inverse_M

import numpy, matplotlib.pyplot as plt

##########

fractions_unknown = [0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95] #[ 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9 ]

input_folder = project_location+"BNMTF/experiments/generate_toy/bnmf/"

repeats = 10 # number of times we try each fraction
iterations = 1000
I,J,K = 100, 80, 10 #20,10,3 #

alpha, beta = 1., 1.
lambdaU = numpy.ones((I,K))/10.
lambdaV = numpy.ones((J,K))/10.    
priors = { 'alpha':alpha, 'beta':beta, 'lambdaU':lambdaU, 'lambdaV':lambdaV }

init_UV = 'random'

minimum_TN = 0.1

metrics = ['MSE', 'R^2', 'Rp']

#'''
# Load in data
R = numpy.loadtxt(input_folder+"R.txt")

# Seed all of the methods the same
numpy.random.seed(3)

# Generate matrices M - one list of M's for each fraction
M_attempts = 100
all_Ms = [ 
    [try_generate_M(I,J,fraction,M_attempts) for r in range(0,repeats)]
    for fraction in fractions_unknown
]
all_Ms_test = [ [calc_inverse_M(M) for M in Ms] for Ms in all_Ms ]


# Make sure each M has no empty rows or columns
def check_empty_rows_columns(M,fraction):
    sums_columns = M.sum(axis=0)
    sums_rows = M.sum(axis=1)
    for i,c in enumerate(sums_rows):
        assert c != 0, "Fully unobserved row in M, row %s. Fraction %s." % (i,fraction)
    for j,c in enumerate(sums_columns):
        assert c != 0, "Fully unobserved column in M, column %s. Fraction %s." % (j,fraction)
        
for Ms,fraction in zip(all_Ms,fractions_unknown):
    for M in Ms:
        check_empty_rows_columns(M,fraction)


# We now run the VB algorithm on each of the M's for each fraction.
all_performances = {metric:[] for metric in metrics} 
average_performances = {metric:[] for metric in metrics} # averaged over repeats
for (fraction,Ms,Ms_test) in zip(fractions_unknown,all_Ms,all_Ms_test):
    print "Trying fraction %s." % fraction
    
    # Run the algorithm <repeats> times and store all the performances
    for metric in metrics:
        all_performances[metric].append([])
    for (repeat,M,M_test) in zip(range(0,repeats),Ms,Ms_test):
        print "Repeat %s of fraction %s." % (repeat+1, fraction)
    
        BNMF = nmf_icm(R,M,K,priors)
        BNMF.initialise(init_UV)
        BNMF.run(iterations,minimum_TN=minimum_TN)
    
        # Measure the performances
        performances = BNMF.predict(M_test)
        for metric in metrics:
            # Add this metric's performance to the list of <repeat> performances for this fraction
            all_performances[metric][-1].append(performances[metric])
            
    # Compute the average across attempts
    for metric in metrics:
        average_performances[metric].append(sum(all_performances[metric][-1])/repeats)
    
    
print "repeats=%s \nfractions_unknown = %s \nall_performances = %s \naverage_performances = %s" % \
    (repeats,fractions_unknown,all_performances,average_performances)


'''
repeats=10 
fractions_unknown = [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9] 
all_performances = {'R^2': [[0.9675308056342089, 0.9706731183201378, 0.963515388656442, 0.9641470395458833, 0.9655826279217266, 0.9672294102359171, 0.9646001028981867, 0.9640619445467564, 0.9690036553956349, 0.9654409469483706], [0.9639738759573419, 0.963567010099971, 0.9654223808085468, 0.9643410967733337, 0.9624560435500431, 0.964324471631967, 0.9623909262839379, 0.9608493186526555, 0.9657672670199301, 0.9659115228364663], [0.9614572511485779, 0.9589819094877396, 0.963989588472418, 0.9608121334638506, 0.9642719642530541, 0.9608971571013196, 0.9612212583750915, 0.9612404133396623, 0.9618299957652703, 0.961369171789454], [0.9585160253993189, 0.9575779061062479, 0.9574643720429868, 0.9594241418510507, 0.9584959767975174, 0.9604005841420141, 0.9589059353654282, 0.9604642942489454, 0.95750675995146, 0.9607169405608774], [0.9512913413870069, 0.9542372391958707, 0.9570930945184041, 0.9536261975478091, 0.9535052419653446, 0.9511312110680381, 0.9509401809556668, 0.9504006562363108, 0.9512952600303107, 0.9533992700930061], [0.9421897455772862, 0.9377710137581358, 0.93923072477646, 0.9359583884993236, 0.9401515756921959, 0.9160080327252482, 0.9388377747710379, 0.9333978218918502, 0.9410161118470081, 0.4172077771215297], [0.6492870470824728, 0.41808562676856553, 0.8601954384863069, 0.18391754468568988, -0.3712969781058011, 0.1928831001369935, -0.04476264055036028, -0.07822039466291453, 0.7782838803614673, 0.8471368345342142], [-15.154083055897928, -3.2260813954603647, -3.0404150913693346, -2.8912227984149217, -1.6365028486809656, -3.701950932661954, -1.3347890580260828, -2.9721167590862185, -7.579224246222399, -0.8305063766953791], [-25.229116347034754, -2.584717328359927, -7.805478147382384, -4.3858408057911555, -45.58291647127771, -172.62011291578443, -11.135481520827124, -38.9551194732589, -45.484597899013046, -9.811203434168704]], 'MSE': [[1.187157164954578, 1.3898297200725369, 1.3783972956361257, 1.3143989657901607, 1.3677641943629277, 1.32361845717388, 1.3648837705275227, 1.3285044801517296, 1.1829726301849688, 1.2651118784833626], [1.453364418735541, 1.3700096800001251, 1.3376849941391245, 1.4339828974782167, 1.3969112642935315, 1.4114103780266951, 1.4552342906907807, 1.5236834547871951, 1.4261476182236223, 1.396701158803284], [1.5405572085051735, 1.5127404138095704, 1.4583016848597918, 1.5515746462240012, 1.4437979737297169, 1.5164660159943102, 1.4769147682537309, 1.4750441757138248, 1.5148205392710512, 1.5329485512131671], [1.6332378436324435, 1.6091543761045901, 1.6674524973738523, 1.5849445704145741, 1.6275463811308035, 1.5545596959921908, 1.7123338748280075, 1.5426972993965666, 1.626169671913325, 1.5774155055271952], [1.8827083597062471, 1.8869800012441869, 1.6869415553799403, 1.8643145673603752, 1.8209797481971748, 1.8191245605478923, 1.8684620275369468, 1.8263604829944977, 1.9202701967828466, 1.8196651252973335], [2.2619641354569513, 2.4692946761188788, 2.3902065843598028, 2.4807743653310128, 2.3144651089404418, 3.4190015777729346, 2.4776173216749866, 2.6065406236207629, 2.4281860289525961, 23.157360984753783], [13.888138409142835, 23.191374771463085, 5.4875067563411362, 32.046162842779452, 52.300603873623579, 31.832906750343106, 41.306738372637341, 42.640943734195858, 8.7846347172410315, 6.0689159243055224], [637.82330632690832, 164.64775884872782, 160.14683783654888, 154.27762959286534, 104.33047904751766, 183.18459490341436, 90.908851265961275, 158.29703989937892, 340.46365883945168, 72.517089326534872], [1027.0193630787844, 140.01123141089118, 345.50548111476979, 209.4833772439263, 1841.2300141903368, 6816.5173720613329, 476.1871633364039, 1591.571192212532, 1818.4092301141911, 425.908306211411]], 'Rp': [[0.98371254375777983, 0.9852593042200033, 0.98169025730922743, 0.9820463841118251, 0.98264745037432177, 0.98364597296075718, 0.98215363830320457, 0.98189268015836306, 0.98442356198749348, 0.98263394115834157], [0.98191812061810446, 0.98162072345629237, 0.98270050186274183, 0.98206503621597818, 0.98108147768777143, 0.98213101679579162, 0.98114539350026431, 0.98024769311959414, 0.98286605201274857, 0.98294943837519688], [0.98056513858036443, 0.97933317147454091, 0.98186393539653039, 0.98021947354660055, 0.98198582351158248, 0.98040588610494672, 0.98048303802774139, 0.98055718063417985, 0.98086247278375616, 0.98049684325918762], [0.97913294286247166, 0.9786355908419283, 0.97856675075222943, 0.97967119266141989, 0.97909324390033037, 0.98018288502510165, 0.97946117067749672, 0.98005418069212935, 0.97855095740841946, 0.98022701605169793], [0.97541613729030174, 0.97698358058682688, 0.97842381853910809, 0.97659228688440214, 0.97663770073844913, 0.97534140334396213, 0.97528835458281882, 0.97513083651584087, 0.97555595094597558, 0.97651242166614194], [0.97072674123090485, 0.96872680951692303, 0.96967332358728719, 0.96779800442128827, 0.96999790525567497, 0.95802255524500712, 0.96950122809024442, 0.96641199125903743, 0.97057469601659108, 0.77834325806882843], [0.8458462324193643, 0.76874646860456841, 0.93532706265827947, 0.73021663349220967, 0.66315121760061924, 0.71472380265694679, 0.6823375995997647, 0.69144435374124924, 0.89964626185006069, 0.92403445885840774], [0.31332946027253189, 0.39537928253773769, 0.47679860124063189, 0.39897732785199841, 0.4991530080173564, 0.45565956293722693, 0.4961447404344001, 0.45378913782676389, 0.33345827202983858, 0.5135021247128172], [0.3434072088157063, 0.47061044993748996, 0.39680929075293253, 0.39124671575428283, 0.34861242077073645, 0.22469325738464976, 0.29643158775236977, 0.28413749892097034, 0.28533432255364599, 0.34385929058618586]]} 
average_performances = {'R^2': [0.9661785040103265, 0.9639003913614193, 0.9616070843196438, 0.9589472936465846, 0.9526919692997768, 0.8841768966660075, 0.3435509458736634, -4.236689256251556, -36.35945843428981], 'MSE': [1.3102638557337791, 1.4205130155178114, 1.5023165977574338, 1.6135511716313551, 1.8395806625047442, 4.6005411406982146, 25.7547926152073, 206.65972458873088, 1469.1842730974581], 'Rp': [0.98301057343413178, 0.98187254536444846, 0.980677296331943, 0.9793575930873224, 0.97618824910938273, 0.94897765126917866, 0.78554740914814702, 0.43361915178613025, 0.33851420432289692]}

repeats=10 
fractions_unknown = [0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95] 
all_performances = {'R^2': [[0.9646588220320363, 0.9744017897369437, 0.9661210190894278, 0.969802848062672, 0.965476872595392, 0.9670624316916201, 0.9728664524056745, 0.971176375566901, 0.9648256397442762, 0.9649026044524933], [0.9640763008036166, 0.9626339752479472, 0.9681567935024334, 0.9661353174417285, 0.9662175675124474, 0.9715662939098224, 0.9707315218179083, 0.9699923600970786, 0.9653035655898666, 0.9664734894086203], [0.9633972797734844, 0.9613889477090745, 0.9633155400542408, 0.9631868017024905, 0.9650005051889149, 0.9683135728474723, 0.9646223689489576, 0.962812973503456, 0.9678537500615519, 0.9630758881678614], [0.9647906168171374, 0.9615626276121297, 0.9664017963616047, 0.965807030429661, 0.9635705064247597, 0.9651284643798599, 0.9661642561079591, 0.9611595050726959, 0.9648979122538076, 0.9656864637861943], [0.9617910761509388, 0.9622938519210792, 0.9664243504358435, 0.9654731800857685, 0.9662465103997169, 0.9642327939957898, 0.9658007830159676, 0.9637036898952889, 0.9657552613705543, 0.9664413893301579], [0.9612495027889931, 0.9603477783110483, 0.9585368175053959, 0.9638765137419028, 0.9622678858049218, 0.9623215799662406, 0.9608749263149422, 0.9627668392405861, 0.9619310420008448, 0.9621780756495445], [0.9585764566451669, 0.9619247686593589, 0.9582557644679749, 0.9588577800309206, 0.9592089991210807, 0.9585017000597045, 0.9603166347644169, 0.9589136483511163, 0.9618894579719319, 0.9625461136872147], [0.9573348772422919, 0.9606195868670749, 0.9576288002345882, 0.9586687487253401, 0.9600221001417386, 0.956582609039941, 0.9599676242758199, 0.9576461865633775, 0.9588797397181873, 0.9583114532248218], [0.957728108793864, 0.9570402091693019, 0.9575428135832431, 0.956450915408119, 0.9569389333676624, 0.951696208169665, 0.957591926883792, 0.9565914359033977, 0.9555384201874338, 0.9564214296003611], [0.9515852501929368, 0.953367242361147, 0.9505134991265246, 0.9546104749807054, 0.9549505688726565, 0.9537153287945578, 0.955091971488353, 0.9542244131658796, 0.9529869866197305, 0.9527748576523243], [0.9420434595756004, 0.9479026161921178, 0.9467033602490232, 0.9480673330148461, 0.9453125370917438, 0.9420166088826993, 0.9505653368810594, 0.9467512614422515, 0.9470082359084901, 0.9431031933098671], [0.9360494819384965, 0.936639463368596, 0.9351492199438556, 0.9399089558229732, 0.9447938065299957, 0.9384641662214507, 0.9394766190203735, 0.9376294934870604, 0.9417799891360793, 0.9419438114364511], [0.9024199640151825, 0.8987390371758867, 0.9234426785016546, 0.7990116016523392, 0.9160834584130289, 0.9277815400940939, 0.921553778305238, 0.9201685700731983, 0.7816528084852962, 0.9230727579545454], [0.5948346697949861, 0.38966937921254097, 0.7152509107408433, 0.5121347832324528, 0.6917203481806345, -0.19570932116933726, 0.6281907453334525, 0.5191308550817573, 0.20883268555770118, 0.7460564107414729], [-1.114305363686979, -0.14317123682778887, -0.8227083192787743, -2.5168276797134976, -2.8314145540478184, -1.7157689835918806, -1.4460036756536314, -4.432028363293397, -1.9542062524824177, -2.20537571931408], [-7.158008488200778, -2.149561560181636, -4.153230092342037, -6.59788743353105, -4.982813892375419, -18.821374948545802, -2.54708243533606, -1.0093264080486315, -7.538723904838152, -0.9224534688603399], [-10.638628539166355, -3.1353272699715955, -9.832468280750915, -7.748568416579909, -12.01180556851429, -2.521000468598625, -8.912678390492218, -17.053360366455575, -2.418925332065935, -10.203398167152656], [-16.71119840822288, -18.86304304649908, -17.490919492764306, -8.988213386773568, -2.2443277363559595, -53.63948069764641, -6.340076371868526, -11.586703960357593, -39.77090188489713, -2.670565527948003], [-2.9991157910674557, -1.1047812921283673, -4.252211807572713, -8.655115190125118, -1.941764250155218, -2.2501238622149757, -2.398908934598071, -2.9831664956574446, -3.0110616315482464, -4.392950526379743]], 'MSE': [[1.3068878553534384, 1.2728600658795628, 1.1694231900614449, 1.3435147321596586, 1.3241734835378016, 1.3111065171418457, 1.1146207618462132, 1.381435269976397, 1.4067231747631745, 1.2954293537465802], [1.4049645974251284, 1.3985004418947549, 1.3373578191091928, 1.3389832835693232, 1.342244514889221, 1.3235213165695416, 1.2251176863382529, 1.2318869420603697, 1.2871522152420181, 1.2675665938521545], [1.3043884852215519, 1.4109949764516914, 1.3652341396127343, 1.3752535094846476, 1.3227887368153155, 1.2405841708054504, 1.4325202373215173, 1.3990547413838681, 1.3408730928982637, 1.4019895862338529], [1.4211193839205623, 1.4364331602420395, 1.4269733463787011, 1.3285520324251072, 1.4037041392890501, 1.4636076896335206, 1.3288615089259281, 1.4434497506181614, 1.3805780591263934, 1.3228378322209524], [1.4585658158640977, 1.3825012038494837, 1.3653008971663836, 1.3781637335667971, 1.4144387982359425, 1.4922567535995772, 1.3787812370651165, 1.5098810096750064, 1.3705949802824897, 1.3961970465759497], [1.4704221482301882, 1.514866214725253, 1.5228499684576888, 1.4567995620940899, 1.5109131992575717, 1.4860704611643829, 1.5082706699447088, 1.4784484798791904, 1.5248415976500245, 1.5326369992621036], [1.6311607043367158, 1.5634287989271278, 1.5872903387842261, 1.6286343737620241, 1.5864632357890343, 1.5931842919910362, 1.6120479988091887, 1.5536546849286197, 1.4779829384686463, 1.4745732716012327], [1.7492716869018545, 1.5996959412372846, 1.7097206037792916, 1.6672119518139275, 1.5876010519427772, 1.6201291256301225, 1.5696675224718621, 1.6814412961487653, 1.6585153035908424, 1.6352960498206781], [1.635829933236604, 1.7229299569189627, 1.6704598913543416, 1.7304118927555308, 1.7103959581333288, 1.8471680210951695, 1.6837003659750991, 1.810366226226191, 1.6884044979868267, 1.6367092389810465], [1.8424004764078987, 1.8603294582801375, 1.8832443220917485, 1.7470688318892944, 1.7678447414557066, 1.8759421335604214, 1.8162861920282789, 1.7900390962903414, 1.9127546825574491, 1.7992695241359944], [2.2735614291301172, 1.9458790176624092, 2.0590688033100615, 2.0641272766922714, 2.158803019364933, 2.2183034337119163, 1.9181863312806529, 2.0154184079153441, 2.0695856789133931, 2.212505355254621], [2.5358924185739995, 2.3829145329484023, 2.4670439478279591, 2.3753226027967074, 2.273732662908436, 2.4063115088343094, 2.3405416824714407, 2.4547998920227805, 2.2221412751288998, 2.2527137635075767], [3.910399952057066, 3.9200786274483428, 3.0254036700789904, 7.8286585052955049, 3.3361952508472354, 2.8062706523382284, 3.133639101932423, 3.113728198725799, 8.5756422796414533, 3.0541640559658201], [16.087144060205272, 23.628572367305289, 10.888949694616919, 19.106037582501401, 12.392796432409028, 46.866483969850137, 14.836241984623172, 19.173276485046067, 30.494454509437169, 9.8426184534571615], [82.219177946016572, 45.776112953383866, 72.485356819877538, 138.11819497368788, 147.40119067961797, 105.94748683055944, 98.174591072050276, 216.39741676830656, 115.85268401894912, 124.06343350565874], [317.28165441221523, 122.88221954380145, 202.86406861012668, 294.3944546435381, 235.49554562020839, 780.91898466318412, 138.89855722772879, 81.531471360797568, 339.16242340534939, 74.874626228073652], [463.10232594666491, 158.86301509202335, 419.21093847868559, 343.63845775052295, 515.65959093461845, 140.32594316500976, 387.02269589321122, 700.76981150741028, 135.83640865973368, 441.13465489904326], [694.97781814069515, 772.45229410477282, 735.35115794113813, 395.73542965618213, 126.42550944338964, 2112.1393628573542, 289.63773664141087, 491.17268192719689, 1596.9561179733985, 143.19256477611415], [157.47353560409803, 83.19569191263561, 203.67057231042682, 380.74356119105926, 116.13813453928844, 127.46342106389626, 134.89949620637577, 158.56858595065574, 158.34610177280038, 214.39919548358225]], 'Rp': [[0.98219200873993129, 0.98717601673482969, 0.98302969238037108, 0.98479690398735076, 0.98267937790726634, 0.98348259343575595, 0.98634724257835593, 0.98563229169003896, 0.98229527682325368, 0.98234635222274003], [0.98188599962825374, 0.98114449899603584, 0.98410129022071868, 0.98312659798589874, 0.98299690266885753, 0.98568089842924855, 0.98526785569134157, 0.98499399059373172, 0.9825120941300941, 0.98319452126783136], [0.98155089163587239, 0.98054033707083743, 0.98151959434040603, 0.98142960986840833, 0.98236908412995039, 0.98405874535326987, 0.98218645954640393, 0.98125359876027796, 0.98381164704474766, 0.98136813861361405], [0.98233023301584965, 0.98064851416459098, 0.98310739930807711, 0.98275992693733261, 0.98162469929022655, 0.98245472717986027, 0.98294399336158256, 0.98039223694191791, 0.98234678639485373, 0.98279492364985865], [0.98071596923824922, 0.98101577919428284, 0.98312849051934681, 0.98263010378556748, 0.98307530252020636, 0.98198219906456274, 0.98281355006586124, 0.98175137023295411, 0.98273664402360805, 0.98327650371070618], [0.98049018722765391, 0.98004645685921332, 0.9790802937819022, 0.98181579577861877, 0.98102310784704116, 0.98102995062014087, 0.98047098990162795, 0.98126032289459075, 0.98101844225244739, 0.98092808644708696], [0.97914522876284948, 0.98082158578790823, 0.97901315915579989, 0.97930636024192796, 0.97942440574410838, 0.97911605032112947, 0.97997327766132558, 0.97927681958279056, 0.98094288306982969, 0.9811705348073102], [0.97851962927011493, 0.98026112151525069, 0.97874980247187748, 0.97920172925988613, 0.97998819749932575, 0.97816279419609287, 0.97978542474022257, 0.97881983809355766, 0.9794982819739515, 0.97905127532640224], [0.97870290594141562, 0.97833344771318898, 0.97857413946316851, 0.9779923426543442, 0.97864853497511117, 0.97570192078716544, 0.97869589802966639, 0.97868496480078282, 0.97766064417602649, 0.97805112347846501], [0.97579897102752255, 0.97663990046972338, 0.97497846391076426, 0.97734618449231447, 0.97753585207864702, 0.97684525868545236, 0.97738497447218764, 0.97704748602416924, 0.97652981094275626, 0.97640650698354536], [0.97139282092183443, 0.97378287785565187, 0.97319739040823039, 0.97405654622410665, 0.97245379650919539, 0.97100212931306185, 0.9751917704587274, 0.97321388886214233, 0.97354011109505012, 0.97159164234985396], [0.96801072707240776, 0.96829834132676773, 0.96743193614557366, 0.96979112617883423, 0.97231838930697034, 0.96950638767605646, 0.96969846707772267, 0.96884614044885542, 0.97132668622547058, 0.97062842817121675], [0.95233249521014263, 0.95102699866195661, 0.96218245148170678, 0.90296045003909009, 0.95894206885700217, 0.96371338306350984, 0.96280527692116213, 0.96052068745403407, 0.89743756732658986, 0.96170244035756214], [0.82626322494349136, 0.75249301751214437, 0.87334244061026267, 0.80214414525122479, 0.85861789503841246, 0.64000139991140459, 0.83508672145834983, 0.80988350939221454, 0.73011864423779438, 0.8796382480894519], [0.52117241565645311, 0.64268520204696955, 0.56374124452080465, 0.42852564127993314, 0.43728532542191717, 0.48414023905722137, 0.51996125750378308, 0.41299288061797368, 0.49373656329002297, 0.4897073586318399], [0.32741774929740824, 0.420213287162369, 0.435686438852952, 0.34869809798245854, 0.42320220523062912, 0.29088149747615893, 0.46939678742089097, 0.4897942669732141, 0.33658464184062548, 0.49720298313747274], [0.30889655015237838, 0.45233073107402999, 0.29694101649314042, 0.34202356093940889, 0.27246242053082953, 0.43836463079717619, 0.35262071551978302, 0.2950164596439343, 0.46566221354838588, 0.35225579133249207], [0.39726931970189905, 0.2941512869653673, 0.24289147967670127, 0.42302434548549495, 0.45582435838488983, 0.31656179953862373, 0.36280725910290029, 0.33278218431431439, 0.27818828566325021, 0.4716814206540299], [1.2438453189076574e-16, 0.46293256569061891, 0.42322081204890288, 0.30484014499444811, 0.41147453903910358, 0.43918932217592527, 0.38196879781489285, -1.0540860479575021e-15, 2.2883671484449312e-16, 0.43298534066997812]]} 
average_performances = {'R^2': [0.9681294855377438, 0.9671287185331471, 0.9642967627957505, 0.964516917924581, 0.9648162886601105, 0.9616350961324421, 0.9598991323758884, 0.9585661726033182, 0.956354040106684, 0.9533820593254815, 0.9459473942547698, 0.9391835006905331, 0.8913926194670463, 0.4810111466706505, -1.9181810147890268, -5.58804626322599, -8.447616079974807, -17.830543051333343, -3.3989199781447352], 'MSE': [1.2926174404466115, 1.3157295410949961, 1.3593681676228893, 1.3956116902780416, 1.4146681475880842, 1.5006119300665204, 1.5708420637397853, 1.6478550533337404, 1.7136375982663103, 1.829517945869727, 2.0935438753235722, 2.3711414287020505, 4.2704180294330865, 20.33165755394516, 114.64356455681079, 258.83040057150231, 370.55638423269227, 735.80406734616531, 173.48982960348184], 'Rp': [0.98399777564998936, 0.98349046496120118, 0.9820088106363789, 0.98214034402441508, 0.9823125912355346, 0.9807163633610323, 0.97981903051349784, 0.97920380943466812, 0.97810459220193346, 0.9766513409087082, 0.97294229739978544, 0.96958566296298765, 0.94736238193727562, 0.80075892464447507, 0.49939481280269182, 0.40390779553741785, 0.35765740900315585, 0.35751817394874708, 0.28566115224338695]}
'''


# Plot the MSE, R^2 and Rp
for metric in metrics:
    plt.figure()
    x = fractions_unknown
    y = average_performances[metric]
    plt.plot(x,y)
    plt.xlabel("Fraction missing")
    plt.ylabel(metric)