"""
Test the performance of non-probabilistic NMF for recovering a toy dataset, 
where we vary the level of noise, and use 10% test data.
We repeat this 10 times per noise level and average that.

We use the correct number of latent factors and same priors as used to generate the data.

I, J, K = 100, 80, 10
"""

project_location = "/home/tab43/Documents/Projects/libraries/"
import sys
sys.path.append(project_location)

from BNMTF.code.nmf_np import NMF
from BNMTF.experiments.generate_toy.bnmf.generate_bnmf import try_generate_M
from ml_helpers.code.mask import calc_inverse_M

import numpy, matplotlib.pyplot as plt

##########

fractions_unknown = [0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95] #[ 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9 ]

input_folder = project_location+"BNMTF/experiments/generate_toy/bnmf/"

repeats = 10 # number of times we try each fraction
iterations = 1000
I,J,K = 100, 80, 10

init_UV = 'exponential'
expo_prior = 1/10.

metrics = ['MSE', 'R^2', 'Rp']

#'''
# Load in data
R = numpy.loadtxt(input_folder+"R.txt")

# Seed all of the methods the same
numpy.random.seed(3)

# Generate matrices M - one list of M's for each fraction
M_attempts = 100
all_Ms = [ 
    [try_generate_M(I,J,fraction,M_attempts) for r in range(0,repeats)]
    for fraction in fractions_unknown
]
all_Ms_test = [ [calc_inverse_M(M) for M in Ms] for Ms in all_Ms ]


# Make sure each M has no empty rows or columns
def check_empty_rows_columns(M,fraction):
    sums_columns = M.sum(axis=0)
    sums_rows = M.sum(axis=1)
    for i,c in enumerate(sums_rows):
        assert c != 0, "Fully unobserved row in M, row %s. Fraction %s." % (i,fraction)
    for j,c in enumerate(sums_columns):
        assert c != 0, "Fully unobserved column in M, column %s. Fraction %s." % (j,fraction)
        
for Ms,fraction in zip(all_Ms,fractions_unknown):
    for M in Ms:
        check_empty_rows_columns(M,fraction)


# We now run the VB algorithm on each of the M's for each fraction.
all_performances = {metric:[] for metric in metrics} 
average_performances = {metric:[] for metric in metrics} # averaged over repeats
for (fraction,Ms,Ms_test) in zip(fractions_unknown,all_Ms,all_Ms_test):
    print "Trying fraction %s." % fraction
    
    # Run the algorithm <repeats> times and store all the performances
    for metric in metrics:
        all_performances[metric].append([])
    for (repeat,M,M_test) in zip(range(0,repeats),Ms,Ms_test):
        print "Repeat %s of fraction %s." % (repeat+1, fraction)
    
        nmf = NMF(R,M,K)
        nmf.initialise(init_UV,expo_prior)
        nmf.run(iterations)
    
        # Measure the performances
        performances = nmf.predict(M_test)
        for metric in metrics:
            # Add this metric's performance to the list of <repeat> performances for this fraction
            all_performances[metric][-1].append(performances[metric])
            
    # Compute the average across attempts
    for metric in metrics:
        average_performances[metric].append(sum(all_performances[metric][-1])/repeats)
    
    
print "repeats=%s \nfractions_unknown = %s \nall_performances = %s \naverage_performances = %s" % \
    (repeats,fractions_unknown,all_performances,average_performances)


'''
repeats=10 
fractions_unknown = [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9] 
all_performances = {'R^2': [[0.9008720358092512, 0.9601292556538269, 0.9612346327882337, 0.9632370353344099, 0.9633416652818967, 0.9622524390617689, 0.9603462698770026, 0.9671543638475553, 0.963321176365319, 0.9647502561162388], [0.9587423807980398, 0.9594551242359872, -3.4181530290314203e+31, 0.9667705271422598, 0.9594795927427342, 0.9555980739163884, 0.9641509195014247, 0.9600012125982704, 0.9607054683210157, 0.9661084282762575], [0.9382181233060924, 0.9555854839521907, 0.9368037902628257, 0.9582622859261749, 0.9620448532122527, -9.575051602187483e+42, 0.9471224531572379, 0.7562029493130721, 0.9548875991119727, 0.9555910437196921], [0.9496402766263484, 0.9392930203111193, 0.9442935216869608, 0.9237404390903083, 0.9252803184201542, 0.9523531935481676, 0.9307580665584911, -8.133649834554712e+20, 0.9388936675208388, 0.9048524050134544], [-1.1598779258816443e+27, 0.9372133879068926, -3.961690031106814e+20, 0.9440248592259005, 0.9394813432143667, 0.9271719222979232, 0.9071206814997375, 0.9298946916088988, 0.9401015477550159, 0.9236712109281022], [0.8383378704069995, 0.8782152271084063, 0.917929309782159, 0.9064879190269263, -1.7332687521184305e+39, 0.8912375905665959, 0.8842081930840828, 0.9140398760507505, 0.9003029739978541, 0.9050855834326664], [0.4291718721362058, 0.2408221511005295, 0.633924944674207, 0.6059517361949012, 0.4764804275809116, 0.5876339971706936, 0.30137189935767383, 0.4659353092966517, 0.49461273376976167, 0.6103288971363448], [-2.342700361645398, -0.8577504348916534, -1.9468133763345055, -0.34252122761398285, -0.5991572676542325, -2.0317122701006682, -0.8312242875276055, -0.108334186297536, -0.17997801861930718, -0.5320222201096987], [-0.11243196632724661, 0.03940719301589024, -0.13528418448295598, -0.042675187196357545, -0.2120072997424549, -0.29388458483317614, -0.44435489468160605, -0.3475109932763185, -0.5122262467188277, -0.2011759238351314]], 'MSE': [[4.0862243392120989, 1.4299724526688331, 1.5478315731222576, 1.4485566598730231, 1.3419174296956933, 1.5154235230084641, 1.4766552639482657, 1.3331249217264756, 1.4567687519365884, 1.366132427982282], [1.5620403080588923, 1.4860195677252179, 1.3493431600534702e+33, 1.4751202752786454, 1.5220438439697228, 1.5607297865294163, 1.580556659686865, 1.5575718640615679, 1.5531311163348624, 1.4407339893520088], [2.3582786615099707, 1.7864543793984091, 2.4581876144444004, 1.6801830604913042, 1.6522341731931889, 3.7924425129609333e+44, 2.2929758478949553, 9.7356857972305821, 1.6214648973461219, 1.6976979410909789], [1.9142355382829572, 2.2816879721009702, 2.1346299355636189, 3.0480041665231195, 2.8851446240861547, 1.8758131708232826, 2.6862617238018971, 3.2579614472979008e+22, 2.4249045742967557, 3.8554037589132593], [4.6664732336351262e+28, 2.4824394405414516, 1.6265363356071028e+22, 2.1730815060057629, 2.3421266313290734, 2.743063926102657, 3.6572585424434725, 2.7496852131846103, 2.4005124113313241, 2.8468050558976619], [6.3329922360184616, 4.7910446382609768, 3.1623679445952599, 3.7030770129419066, 6.7674716120028753e+40, 4.2640269018660009, 4.567875948754005, 3.2404421535746017, 3.8234178604209772, 3.74623027931688], [22.002711432613282, 30.064556119472648, 14.683106704960636, 15.508973138068894, 20.51025684726568, 16.187068250196642, 26.826087912654543, 21.201330005593618, 20.008006653752226, 15.132184360577902], [131.83114074936503, 73.02538576627569, 119.33165121728589, 53.356695570391032, 63.919770764393228, 118.94930276474862, 71.317449613104927, 43.423013478239774, 47.509622297765574, 60.297065158413986], [43.577479696712679, 37.858347282609508, 45.531407591938404, 41.668997730021523, 48.279141935932088, 50.56517035994198, 57.213708264108064, 52.686229820235006, 59.166699743979777, 47.645945746358706]], 'Rp': [[0.95037857405740567, 0.97988404582615307, 0.98053049839702078, 0.98153477649269993, 0.98152521993533759, 0.98104821713427215, 0.97999923277144063, 0.98355933957506247, 0.98149880299043935, 0.98223755187360473], [0.97920353349754341, 0.97961173074760421, 0.030200726212311672, 0.98332653963263617, 0.97974966075550363, 0.97790157562680458, 0.98199762785234446, 0.97992759439844479, 0.98032876744747344, 0.98300650347533247], [0.96920967282957282, 0.97758323107328726, 0.96804413788979149, 0.97922104249115349, 0.98084388878994777, 0.0034839916357522665, 0.97329363289935722, 0.89072044389126603, 0.97732163806555494, 0.97764917791994499], [0.97464651976991989, 0.96944953281324575, 0.97210318321723144, 0.96179891441702603, 0.96218400971305429, 0.97598836501352693, 0.96543049507150214, -0.0051467773616229607, 0.9695531230206752, 0.95432741700674417], [-0.013080893326172505, 0.9687709598282892, 0.0154222415085759, 0.97228143642665765, 0.9698418909324481, 0.96359737010165236, 0.95359032632328022, 0.96465991235344772, 0.96975971293391483, 0.96172047493248258], [0.92145297881044197, 0.93887770864955522, 0.95923092603473969, 0.95307064461122093, 0.0019191481769650135, 0.94475008508827107, 0.94116943735172731, 0.9569184836230441, 0.94975816616296227, 0.95213011428914041], [0.75281984174534367, 0.69344700368562529, 0.82433916270976315, 0.8149423647725671, 0.77192858325793101, 0.80172230931040822, 0.71370441334474222, 0.76595337257687091, 0.7795462531197147, 0.81482529264009951], [0.4022157265391581, 0.49987556610742007, 0.40335727391104315, 0.55323898257513349, 0.5197183311959761, 0.41229207287725705, 0.53897287199072397, 0.60251608432676695, 0.56678540039532477, 0.54895666941604127], [0.58262057427916281, 0.59721078387221338, 0.53555919427868337, 0.5712455094801655, 0.53586240999279489, 0.5234212547737318, 0.49312408378952566, 0.53725758782329591, 0.52895742581609639, 0.56688119771431333]]} 
average_performances = {'R^2': [0.9566639130135502, -3.41815302903142e+30, -9.575051602187484e+41, -8.133649834554712e+19, -1.1598783220506474e+26, -1.7332687521184306e+38, 0.48462339684178807, -0.9772213650794589, -0.2262144088078184], 'MSE': [1.7002607343173981, 1.3493431600534702e+32, 3.7924425129609332e+43, 3.2579614472979009e+21, 4.6664748601714616e+27, 6.7674716120028753e+39, 20.212428142515609, 78.296109737998364, 48.41931281718378], 'Rp': [0.9782196259053435, 0.88552542596459993, 0.86973708574856268, 0.87003347826813027, 0.7726563432014576, 0.85192776927980685, 0.77332285971630665, 0.50479289793348447, 0.54721400218199834]}

repeats=10 
fractions_unknown = [0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95] 
all_performances = {'R^2': [[0.9689982320056162, 0.9689917090673902, 0.9584654970391766, 0.9702397316702163, 0.9659699311572578, 0.9607874067781528, 0.9620344908386754, 0.9652920571129262, 0.9622916408094269, 0.9617588832149964], [0.9598437316888161, 0.9622924145658958, 0.9677960408561996, 0.9602434737470198, 0.9594643815302007, 0.9693661064070987, 0.9695486139574616, 0.9604711451375875, 0.9610284970693976, 0.9617925706594852], [0.9631133665266515, 0.9622463690704579, 0.9644905915126607, 0.9624600432303675, 0.9666850830046918, 0.9663524825759241, 0.9572154317059923, 0.9580084823000874, 0.962397059627732, 0.966867665543729], [0.9628790861715747, -3254066661770114.5, 0.957833080545854, 0.9575328931203445, 0.8900584102712475, 0.9583618928046787, 0.9657816626801784, 0.841580082114134, 0.9525619016639351, 0.9569640020126929], [0.9607880533317379, 0.9157439062264688, 0.9589573186083807, 0.9180226447384124, 0.9469749189838722, 0.9597140810809299, 0.9622271720890319, 0.958118547187024, 0.9540428525348618, 0.9566849003010336], [-2.55868148161001e+42, 0.957683182882155, 0.9587232855238976, -1.3415450235337558e+28, 0.9593870187594239, 0.9622407821599628, 0.9407569208274621, 0.9612911929277, 0.9593698469748104, 0.9371284041428767], [0.9567818821374593, 0.954149388490502, 0.9592523234860723, 0.9525245083026567, 0.9505813363404699, 0.9529680711662232, 0.9562292080514075, 0.9582795812576681, -6.771507556480724e+48, 0.9586656036159685], [0.9519234697608772, 0.9254403519065733, 0.9535435966511446, 0.953042814767579, 0.953842865985006, 0.9481449963045427, -3.342898208367701e+29, 0.9537344937713133, 0.9520765614961054, 0.9524343165954939], [0.9260161563363417, 0.949102125328357, 0.9516657231859105, 0.9424782338059539, 0.9528841462273592, 0.9458148637457714, -1.344325854907069e+49, 0.9342351118142681, 0.9421536825264263, 0.9366036279708401], [0.9456769430736538, 0.9206456954910301, 0.8912473296353778, 0.9145563360767159, -3.3421416171517766e+43, 0.9463731176571757, 0.9363812798211818, -5.044368521293507e+37, 0.9451235856937855, -4.815728647882289e+39], [0.9264118011874416, 0.9319537578255552, 0.9308555374523724, 0.7931815399864768, 0.8517528187732719, -2.3339054163897264e+47, 0.9381256448257252, 0.9360939404776755, 0.9184807048679889, 0.9355681331830422], [-1.7828311957942265e+42, 0.9155502861253152, -9.50361552573879e+26, -2.1487464433752587e+22, 0.911004420997275, 0.8970489762062017, 0.9085837816089444, 0.9199986520873049, 0.8635546374415994, 0.8955021057003668], [0.7889711656904008, 0.7035937739289586, -7.600237543299226e+39, 0.8905470493348479, 0.662818734883198, 0.5857342249504401, 0.7298748250346663, -4.8768599038663476e+35, 0.775201105727966, 0.8432735002742656], [-1.5681012657202642e+33, 0.5296116621493883, 0.16894790684150274, 0.6286771509001827, 0.5277955356265289, 0.32158413992182533, -0.20362791685214754, 0.05728122000535929, 0.5540660363757446, -1.176104872802147e+22], [0.16858042412274465, -1.1250762581170175, 0.23414151949605255, -0.47627590166173284, -0.2917214342152843, -0.019385740840076604, 0.34052104276537487, -0.5436105806994096, 0.3692490334513584, 0.1500210782625928], [-0.4750244959474528, -0.2100999024110033, -0.40185498231576644, -1.2996346501824472, -0.44286374758647673, -3.077743108044516e+31, -1.3457161039842909, -0.52598194624073, -0.40769432340512113, -0.26048882687732], [-0.36215033222912907, -0.9117409339503786, -0.8898736211118687, -0.5738977323331467, -0.45584815709294113, -0.5428881223555295, -1.9183092272410014, -0.6745141643604253, -0.8530675846021665, -0.5308027988549875], [-0.19864828000522228, -0.18469100420696805, -0.3084046383467123, -0.03134978563147128, -0.6247612355338237, -0.27912563505798005, -0.3630148129793844, -0.30046909769890773, -0.11319161374774467, -0.2547511374374025], [-0.5842406128103734, -1.1423230553785806, -1.0345608572604004, -0.8683489576868813, -0.4220735018942332, -0.5677464555522593, -0.7283767576125377, -0.10139318601236713, -0.7239328487602648, -0.5908808231418072]], 'MSE': [[1.1802712051106858, 1.4126262627064516, 1.3923692667473091, 1.2449925479234853, 1.2877932481021859, 1.4236867126039514, 1.4018130667156958, 1.4013138866247794, 1.6455582642658668, 1.4826511458047276], [1.5410649856343073, 1.303102060087437, 1.4358020607608071, 1.5793946511293586, 1.403074633596856, 1.2683215421358502, 1.3140945090364153, 1.4925795904278212, 1.3782972813548691, 1.4216230597083566], [1.4284095121822744, 1.4649654547359812, 1.459510390227442, 1.4728224512956694, 1.4682270263910033, 1.4029980295146676, 1.6662092738702408, 1.5450993059621192, 1.4619019006284073, 1.4607329431942684], [1.4527887731270694, 1.28471194978576e+17, 1.5978594131366182, 1.7060529164773934, 4.1405428510325377, 1.6963038832046735, 1.4056426211887652, 6.2175898134952945, 1.7686046714639767, 1.5933653897347384], [1.576472439252127, 3.4942121712835421, 1.5713451544780426, 3.1574823012504871, 2.1164399179301929, 1.5463139412545714, 1.5577352386966241, 1.5563986668325174, 1.6941649916290349, 1.6474415026221223], [9.7435369133537068e+43, 1.683463803447468, 1.6380058016525623, 5.1438466653810227e+29, 1.6817967692472262, 1.5358185902719765, 2.4774127086023636, 1.6287533435786079, 1.6231301199604844, 2.5573851372265568], [1.7196523514646631, 1.819155204427821, 1.6100147728666587, 1.8020918542697395, 1.867270585868499, 1.8102501713325201, 1.7452458803631219, 1.6829507289594419, 2.6377407036408025e+50, 1.6867755713199684], [1.8844705158092441, 2.9603043927499164, 1.9219347391611974, 1.8394204285223834, 1.8707331840186461, 2.0826265642915986, 1.3542401945513279e+31, 1.7861342506410813, 1.9042447585546483, 1.8613669573398948], [2.9578069332408026, 2.0758341265594167, 1.953742080364389, 2.2008448542602528, 1.8447826468176223, 2.282414574568568, 5.2259339601978801e+50, 2.653528295921848, 2.208609769660197, 2.4809563654362146], [2.09369073740059, 3.1705299172627837, 4.1222275259875296, 3.4698419507856411, 1.2819563046400907e+45, 2.1093322600681481, 2.4841845856791802, 2.0051503600031294e+39, 2.1252389680422934, 1.9232132124808484e+41], [2.7541215904009415, 2.6627352501698751, 2.7533384462302251, 7.9439920760319467, 5.7784899529506815, 9.3102307935582702e+48, 2.4374485882397976, 2.4840103110403429, 3.0728073191245775, 2.5707657440905067], [7.1120552354010848e+43, 3.3590401226907005, 3.7470380492005788e+28, 8.6430369800031231e+23, 3.6664148100338192, 3.9355205663497221, 3.5080913079881522, 3.0632051911468978, 5.2556160776850316, 3.9532166534727646], [8.2140023605177817, 11.837555765030311, 3.0474640261512159e+41, 4.4274353069611152, 12.952825545632704, 16.119197497591752, 10.677342801192514, 1.9211169014058091e+37, 9.014872677123801, 6.0682969472140016], [5.964336501347473e+34, 17.932575767468986, 33.072599261530634, 14.768252316927763, 18.143817135325932, 26.339020648085057, 46.634705256237503, 38.106739564081963, 18.255055412834867, 4.7151296494996335e+23], [33.041437207861975, 84.851950719380639, 30.237197815698917, 58.2445851581829, 50.60851964565547, 40.141668672252891, 26.015523071919421, 57.920090994787209, 24.360551446402727, 32.976211260607172], [57.984790534559451, 47.81508501354574, 55.812434212385206, 90.784343664348924, 56.204466810719033, 1.1792894866306272e+33, 92.97829994380146, 58.639036572691147, 56.094034210991161, 50.344217931643016], [54.021377664968909, 76.908903438334164, 73.425636123523844, 62.461391725976362, 57.152733372469157, 60.925560160560117, 112.88417970554843, 66.30652951883981, 72.547888753439054, 59.053812135843401], [47.743480120657715, 45.367252816441152, 51.637637952619883, 40.582623491159282, 63.957366560854311, 49.680642861708606, 53.012992159273139, 51.558369991964696, 43.750666071340795, 48.577461814030329], [62.202041491149032, 83.667810862065295, 79.718821802198292, 73.166805592742421, 55.835740352014, 61.774983793541601, 67.25576053930709, 43.136059224316718, 67.706943836689973, 61.712698069700565]], 'Rp': [[0.98465775510093068, 0.98440237618724624, 0.97911925346370121, 0.98500811514719377, 0.98284718166105978, 0.98024738746185613, 0.98085155260956436, 0.98261066414885456, 0.98100703694691394, 0.98084847546332932], [0.97992939133473445, 0.9810142404849177, 0.98380841637764627, 0.9800009522768145, 0.98004578555265687, 0.98461051891877605, 0.98477444184598584, 0.98011748031275214, 0.98032561387379369, 0.98085702601386004], [0.98150846134487124, 0.98099890724685557, 0.98218683627643355, 0.98105262308582208, 0.98321815405911472, 0.98303681551128708, 0.97862875073385225, 0.97904659353777579, 0.98103029929312602, 0.98332531308699755], [0.98129726904739023, -0.0049120308121148029, 0.97876236880065337, 0.97857619824877251, 0.94732055878368593, 0.97904142688124018, 0.9827496093435294, 0.92675001100298804, 0.97622665646572149, 0.97853942220224266], [0.98023268133408836, 0.9579508250243427, 0.97927020576541424, 0.95883908095730441, 0.97326380790488265, 0.9797609489423712, 0.98107332560865268, 0.97884996873242847, 0.97694766613776329, 0.97811126095017831], [0.0031883950180226438, 0.97875561242318154, 0.97925460284105881, -0.021651372145925451, 0.97954272813842358, 0.98110019637312573, 0.97047347155771557, 0.98064479721580777, 0.97956816871020591, 0.96850329877907126], [0.97822373215404068, 0.97682285049970052, 0.97951837490220339, 0.97606424931018954, 0.97504448306808944, 0.9763012830377914, 0.97798504657982199, 0.9789721267516549, -0.015942100929582023, 0.97930038985069301], [0.97578459272558671, 0.96310342422866069, 0.97668804927476449, 0.97648951896078928, 0.97668910848454293, 0.97400933626136343, -0.0099835882110452332, 0.97665633357941384, 0.97592100674377535, 0.97632796424738222], [0.96248591519084981, 0.97429199568920388, 0.975619638094533, 0.97105122683329004, 0.97643416259453553, 0.97275194575278223, 0.0068388438226997536, 0.96715033607594758, 0.97085300714616962, 0.96869581540056193], [0.9726581614564479, 0.96024580685902727, 0.94552292290344098, 0.95744629144892557, 0.05636481653700439, 0.97304973196075928, 0.96776803069727158, -0.0035101415067815334, 0.97228155657838933, -0.0082754766372177511], [0.96345311566912339, 0.96580117183901959, 0.96524088907976713, 0.9034839564205005, 0.92730464612073871, -0.023267118495971514, 0.96896843692824342, 0.9680254000183206, 0.95910374328898396, 0.96753733966915456], [0.013043336926545336, 0.9573913587040106, -0.0069263580139984557, -0.015273496727157509, 0.95546030682699845, 0.9489348384191103, 0.95455028920798179, 0.95962387952357642, 0.9330029205523579, 0.94718585201272731], [0.89522762892607743, 0.85961581352269234, -0.014575615087317129, 0.94664230880954781, 0.84672909252064454, 0.81023239697196481, 0.86866420042656589, 0.021618411266052295, 0.89234277011765917, 0.9226811614599304], [-0.01950436567811074, 0.79462273955956053, 0.70833982061806411, 0.82583768673492608, 0.80482376487336071, 0.73299716323250819, 0.65163891259137841, 0.69291327516217016, 0.78499965087236401, 0.018292899645978456], [0.6886338084788225, 0.4981679599944373, 0.6836182596782896, 0.54902644488388352, 0.61188235993581541, 0.64225137181813985, 0.72363243403613964, 0.57380804566480847, 0.71294693512561713, 0.66948246534889233], [0.56095625960120499, 0.5655642223132914, 0.55562650639979705, 0.47791063850242815, 0.55448917382386187, -0.0063349302370715619, 0.51207695582492607, 0.5438505905263572, 0.5554895845144926, 0.5771852678863193], [0.55012582935098686, 0.47731388752097337, 0.51568035139701274, 0.53812739530622056, 0.56797193224881048, 0.52313899777476558, 0.42047688197233918, 0.51325645969317957, 0.48614450370630469, 0.52245265693858189], [0.56725183001055868, 0.57888029300813937, 0.52402483719445025, 0.57606980010301911, 0.53782341244400145, 0.54145419923433535, 0.55378844797235449, 0.53446600620951068, 0.57519922544107238, 0.57104861985921385], [0.51628999325013769, 0.43627902867432566, 0.46270143561543892, 0.45884566085590112, 0.51791106593512037, 0.43880781799457313, 0.50282493075512535, 0.51824988530748706, 0.4518772485859705, 0.4471729511972467]]} 
average_performances = {'R^2': [0.9644829579693834, 0.9631846975619162, 0.9629836575098294, -325406666177010.56, 0.9491274395081752, -2.5586814816100233e+41, -6.7715075564807235e+47, -3.3428982083677006e+28, -1.3443258549070688e+48, -3.342628234385086e+42, -2.3339054163897263e+46, -1.7828311957942274e+41, -7.600725229289613e+38, -1.568101265732025e+32, -0.11935568174353975, -3.077743108044516e+30, -0.7713092674131573, -0.26584072406456166, -0.6763877056109706], 'MSE': [1.3873075606605139, 1.4137354373872077, 1.4830876288002073, 12847119497857600.0, 1.9918006325229261, 9.7435369133537581e+42, 2.6377407036408024e+49, 1.3542401945513278e+30, 5.2259339601978799e+49, 1.2821506311116989e+44, 9.3102307935582698e+47, 7.1120552354010885e+42, 3.0476561378413562e+40, 5.9643365013946247e+33, 43.83977359927492, 1.1792894866306272e+32, 69.568801259950334, 49.586849384004992, 65.617766556372501], 'Rp': [0.982159979819065, 0.98154838669919386, 0.98140327541761363, 0.87243514899641084, 0.97442997713574275, 0.77993798989106877, 0.87822904352246023, 0.87616857462952336, 0.87461728866005739, 0.67935517002972667, 0.85656515805378797, 0.66469929274321526, 0.70491781689338173, 0.59949615476121998, 0.63534500849648456, 0.48968142691556071, 0.51146888959091741, 0.55600066714766549, 0.47509600181713257]}
'''


# Plot the MSE, R^2 and Rp
for metric in metrics:
    plt.figure()
    x = fractions_unknown
    y = average_performances[metric]
    plt.plot(x,y)
    plt.xlabel("Fraction missing")
    plt.ylabel(metric)