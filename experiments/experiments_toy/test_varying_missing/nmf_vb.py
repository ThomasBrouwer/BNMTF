"""
Test the performance of Variational Bayes for recovering a toy dataset, where 
we vary the fraction of entries that are missing.
We repeat this 10 times per fraction and average that.

We use the correct number of latent factors and same priors as used to generate the data.

I, J, K = 100, 80, 10
"""

project_location = "/Users/thomasbrouwer/Documents/Projects/libraries/"
import sys
sys.path.append(project_location)

from BNMTF.code.models.bnmf_vb_optimised import bnmf_vb_optimised
from BNMTF.data_toy.bnmf.generate_bnmf import try_generate_M
from BNMTF.code.cross_validation.mask import calc_inverse_M

import numpy, matplotlib.pyplot as plt

##########

fractions_unknown = [0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95] #[ 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9 ]

input_folder = project_location+"BNMTF/data_toy/bnmf/"

repeats = 10 # number of times we try each fraction
iterations = 1000
I,J,K = 100, 80, 10 #20,10,3 #

alpha, beta = 1., 1.
lambdaU = numpy.ones((I,K))/10.
lambdaV = numpy.ones((J,K))/10.    
priors = { 'alpha':alpha, 'beta':beta, 'lambdaU':lambdaU, 'lambdaV':lambdaV }

init_UV = 'random'

metrics = ['MSE', 'R^2', 'Rp']

#'''
# Load in data
R = numpy.loadtxt(input_folder+"R.txt")

# Seed all of the methods the same
numpy.random.seed(3)

# Generate matrices M - one list of M's for each fraction
M_attempts = 100
all_Ms = [ 
    [try_generate_M(I,J,fraction,M_attempts) for r in range(0,repeats)]
    for fraction in fractions_unknown
]
all_Ms_test = [ [calc_inverse_M(M) for M in Ms] for Ms in all_Ms ]


# Make sure each M has no empty rows or columns
def check_empty_rows_columns(M,fraction):
    sums_columns = M.sum(axis=0)
    sums_rows = M.sum(axis=1)
    for i,c in enumerate(sums_rows):
        assert c != 0, "Fully unobserved row in M, row %s. Fraction %s." % (i,fraction)
    for j,c in enumerate(sums_columns):
        assert c != 0, "Fully unobserved column in M, column %s. Fraction %s." % (j,fraction)
        
for Ms,fraction in zip(all_Ms,fractions_unknown):
    for M in Ms:
        check_empty_rows_columns(M,fraction)


# We now run the VB algorithm on each of the M's for each fraction.
all_performances = {metric:[] for metric in metrics} 
average_performances = {metric:[] for metric in metrics} # averaged over repeats
for (fraction,Ms,Ms_test) in zip(fractions_unknown,all_Ms,all_Ms_test):
    print "Trying fraction %s." % fraction
    
    # Run the algorithm <repeats> times and store all the performances
    for metric in metrics:
        all_performances[metric].append([])
    for (repeat,M,M_test) in zip(range(0,repeats),Ms,Ms_test):
        print "Repeat %s of fraction %s." % (repeat+1, fraction)
    
        BNMF = bnmf_vb_optimised(R,M,K,priors)
        BNMF.initialise(init_UV)
        BNMF.run(iterations)
    
        # Measure the performances
        performances = BNMF.predict(M_test)
        for metric in metrics:
            # Add this metric's performance to the list of <repeat> performances for this fraction
            all_performances[metric][-1].append(performances[metric])
            
    # Compute the average across attempts
    for metric in metrics:
        average_performances[metric].append(sum(all_performances[metric][-1])/repeats)
    
    
print "repeats=%s \nfractions_unknown = %s \nall_performances = %s \naverage_performances = %s" % \
    (repeats,fractions_unknown,all_performances,average_performances)


'''
repeats=10 
fractions_unknown = [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9] 
all_performances = {'R^2': [[0.9630856037244127, 0.9670215107562922, 0.9661045051134491, 0.9722018575258015, 0.9675999313577555, 0.9714297004377326, 0.9608472667855322, 0.9730333544231496, 0.9666510063942921, 0.9603541051163762], [0.9665170350567773, 0.964946197097694, 0.9663350781598471, 0.9627130095757848, 0.9616497277432379, 0.9640427240029992, 0.9678159049304254, 0.9669349000437315, 0.9641029182026513, 0.9685062857795189], [0.959773536111611, 0.9619285393512471, 0.9612240892216553, 0.9614987452100451, 0.9584291900683835, 0.9625229889130691, 0.9613925806791348, 0.9635766555104377, 0.9619711274413051, 0.9637773429736658], [0.9582224235087118, 0.9591420955113374, 0.9595049864880968, 0.9589604749797365, 0.9590359277212913, 0.9585875441047893, 0.960902037779746, 0.9614427654183628, 0.9609469576204902, 0.9589845126561516], [0.9527508903860804, 0.9532794041128106, 0.9514561283382098, 0.9542335555606037, 0.9566239021533259, 0.9540670856579738, 0.9545119685902426, 0.9565341570138918, 0.9549420865598607, 0.9552309386352669], [0.944824160627708, 0.9443509173528474, 0.9417312447125505, 0.9438389652711955, 0.9427625876422, 0.9425193651599165, 0.9418179180323941, 0.9424462796553271, 0.9420853896708117, 0.9465518001065166], [0.9001951862432918, 0.9183769138373294, 0.9166251929599342, 0.9069886075247062, 0.9115460497313663, 0.9151656497212621, 0.9123698613361313, 0.9124628297593562, 0.9092181617299763, 0.9196836026740838], [0.5718452222629703, 0.6583451513873824, 0.556741155657702, 0.583570843165066, 0.5104570853808321, 0.6360167602951334, 0.6512768325827929, 0.5214192895053769, 0.6275751203453768, 0.564905893846642], [0.5027844119329963, 0.4933257161288198, 0.4496685398864789, 0.4746077863315795, 0.4522656764387484, 0.5368917178074404, 0.4755783852096349, 0.4087673131892968, 0.4898747418380873, 0.4562544542743766]], 'MSE': [[1.4292554648676139, 1.3974051235158393, 1.29440666612722, 1.3217147142340593, 1.3208653575825622, 1.2551131044832673, 1.3757415666406905, 1.3065565812238904, 1.2042610271487089, 1.353798372612641], [1.3515803752693407, 1.3733054586267974, 1.3605784424251741, 1.5082085923523942, 1.412474232111794, 1.3422121840192229, 1.3633847814127587, 1.3403919024877198, 1.4268521219705763, 1.3289609470877093], [1.5502007005526373, 1.4662981005339264, 1.4619454920602812, 1.4335526755575416, 1.4595506807654832, 1.4625057118999791, 1.5535336837966451, 1.4382786571200279, 1.5083283919668102, 1.3930085927285758], [1.5541487972104295, 1.5713266193529145, 1.5946890731711545, 1.6056428426898903, 1.6251711444313219, 1.6215805013925217, 1.6220695413856037, 1.5378342018350912, 1.5531413220895049, 1.5350785451061721], [1.8117382277125307, 1.8477089630749928, 1.8897308174736871, 1.8201218699708099, 1.7956362330203772, 1.752797709484893, 1.7216079538498541, 1.6453618999158146, 1.8054631354026731, 1.8195334536523358], [2.184303640722197, 2.1949240106826875, 2.2056897515984528, 2.2641485953679252, 2.3428786178800967, 2.2597863299291139, 2.302011581068792, 2.1774461811293935, 2.3360642336198585, 2.1121378157470256], [3.9794794510337508, 3.2397568599609925, 3.3357028761301137, 3.7144139551688489, 3.4156036936427556, 3.3906177543890812, 3.3771166204052192, 3.386053503948375, 3.4216546182019933, 3.2108561252818357], [16.679921188539794, 13.650105558808882, 16.988458368541757, 16.29013292645822, 18.769667736252153, 14.529014512907999, 14.194886291079053, 18.888984430976617, 14.368616642611762, 17.500043934952473], [19.728859852733237, 20.0357738274881, 21.614472803471031, 20.376215739188623, 21.481467397245979, 18.315206156715181, 20.793134858429365, 23.458756395361693, 20.374177558979476, 21.495922836713685]], 'Rp': [[0.98137357044894324, 0.98356969304565223, 0.98307183949334243, 0.986023974645173, 0.983791401261639, 0.98567445089057881, 0.98024941158262702, 0.98645450391382405, 0.98319465746836576, 0.98020000016184972], [0.98313446665444237, 0.98232877010194075, 0.98304226090514368, 0.98118639812951347, 0.98065246443942522, 0.98185897615701179, 0.98377658992615691, 0.98333144836210784, 0.98199493342705979, 0.98412744103150163], [0.97975501823888478, 0.98088479147381558, 0.98045650434671505, 0.98057262460682237, 0.97902209539002805, 0.98118645391138437, 0.98053707911525445, 0.9816498220269525, 0.98084506735664256, 0.98174740424723672], [0.97890361614299271, 0.97939109918387257, 0.9795531120627371, 0.97932255725184125, 0.9793042901481851, 0.97914786008990751, 0.98025799335713648, 0.98055794984324751, 0.98029105475801981, 0.9792854032132573], [0.97613493661568473, 0.97641827119444946, 0.97556467703224747, 0.97687271912817053, 0.97817876610563415, 0.97683425927468293, 0.97701341756789306, 0.97808502827763166, 0.97723236000443159, 0.97738278258968225], [0.97203460912583317, 0.97183443904940936, 0.97053747482518804, 0.97151838581568295, 0.97096119919381663, 0.97090027611260332, 0.97050254907300826, 0.97086349701148777, 0.97066332933436827, 0.97297703058961549], [0.94884176188711122, 0.95871692564457744, 0.9574286431553255, 0.95245998639735729, 0.95482371817969269, 0.95665745045296158, 0.95521411307579607, 0.95532060353134696, 0.95377749055837036, 0.95903245723711927], [0.77169610839500669, 0.81194990763251429, 0.77315400488399622, 0.77421630884784298, 0.75639479857647018, 0.80636943929628646, 0.80820079878518392, 0.74909538974484358, 0.80153421908357991, 0.76058696280751781], [0.73902171116167437, 0.7298352820200974, 0.73032526666911179, 0.73544281542769874, 0.73313362065671095, 0.75912748936719998, 0.73653668038292519, 0.69850055406951517, 0.73406943170778083, 0.73171766157704843]]} 
average_performances = {'R^2': [0.9668328841634795, 0.9653563780592667, 0.9616094795480554, 0.9595729725788713, 0.9543630117008268, 0.9432928628231467, 0.9122632055517437, 0.5882153354429274, 0.4740018743037459], 'MSE': [1.3259117978436494, 1.3807949037763489, 1.4727202686981908, 1.5820682588664607, 1.7909700263557968, 2.2379390757745541, 3.4471255458162964, 16.185983159112869, 20.767398742632636], 'Rp': [0.9833603502911995, 0.98254337491343047, 0.98066568607137372, 0.97960149360511983, 0.97697172177905078, 0.97127927901310118, 0.95522731501196601, 0.78131979380532424, 0.73277105130397613]}

repeats=10 
fractions_unknown = [0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95] 
all_performances = {'R^2': [[0.9713589349246919, 0.9613653056828934, 0.9578459394828349, 0.9695090586821206, 0.974670647338806, 0.9661349858322029, 0.9600936184646388, 0.9633704324461373, 0.9737122601556497, 0.9717431881480445], [0.9636798722085953, 0.97135537554884, 0.9660213915797089, 0.962658616403802, 0.9651549570032799, 0.963956989696327, 0.9636075202791187, 0.9667223946359815, 0.9625122170491301, 0.9646179966903984], [0.9631681612672657, 0.963581772202902, 0.9667238211581988, 0.9668039584771945, 0.9674038725039209, 0.9645805149058847, 0.9648104650092288, 0.9616935393190678, 0.9626685313481125, 0.9697202627193672], [0.9671166046555666, 0.9628341828882709, 0.9640158575346893, 0.9623508936358526, 0.9659872966916291, 0.9654029011491398, 0.965872800499762, 0.9657943432312635, 0.9650116518556658, 0.9658644455289328], [0.9644851508579957, 0.9601224476511965, 0.9643609599375405, 0.9642784255104482, 0.964677615606015, 0.961131739490249, 0.9629087019847005, 0.9651886910576233, 0.9654204003053286, 0.9633760524687857], [0.9623314700856768, 0.9616822303300745, 0.9659837899155818, 0.9604879597515781, 0.9619071854679841, 0.9635218158906672, 0.9649744842100604, 0.961962513776393, 0.9629186905520082, 0.9599513049827448], [0.9612576270571351, 0.9619398655987964, 0.959041987887408, 0.9625742339291395, 0.9600486785866935, 0.9602283663399814, 0.9603668292526074, 0.9631444414963682, 0.9595706409987232, 0.9625800423510145], [0.960913699284826, 0.9614263418846921, 0.9589156886534647, 0.9579184707193593, 0.9594025708805531, 0.9617102362198126, 0.9600787257333216, 0.9599811804785796, 0.9563585029920976, 0.9585612475532661], [0.9548292126000331, 0.9566978652840079, 0.9588999561180335, 0.9583250432302336, 0.9558489169256413, 0.955232406842699, 0.9570192368406675, 0.9562225906844626, 0.9537347696486741, 0.955159603503791], [0.954596381822336, 0.9532049971721274, 0.951292005914273, 0.9533452063656485, 0.9526323008848665, 0.9546575448804012, 0.9519517929087362, 0.953310246448709, 0.955420636330911, 0.9556176303726336], [0.9490518291611395, 0.952966821398839, 0.9459918952684331, 0.953993698118477, 0.9489294200636649, 0.9505020032172347, 0.9461592371515639, 0.9463056187328195, 0.9500945402948587, 0.949867212982645], [0.9447508499446656, 0.9369011128772314, 0.9416853892447595, 0.9440380962727131, 0.9421796228759396, 0.945259776883033, 0.9418066778687182, 0.9376704527538923, 0.9432597955726773, 0.9458203908359556], [0.9343641388448143, 0.9295257257157101, 0.9305326701701697, 0.9299840211130274, 0.9329627500122584, 0.9320319562092831, 0.9300686214971303, 0.935057754847032, 0.9301712824853379, 0.9263833325309817], [0.9119584811644569, 0.902746781686113, 0.9060856974479864, 0.9121485563904951, 0.912187647777133, 0.9213757261418238, 0.909734339847664, 0.9128096693034096, 0.8981755637060735, 0.9131673314224751], [0.7321141078876212, 0.7095403595249552, 0.753534642734358, 0.815981950465259, 0.851057362097303, 0.7994545657659315, 0.755341261477482, 0.8307025070230891, 0.8415425598499783, 0.8569854244415853], [0.6355682975476671, 0.7132235922533652, 0.6347015190450611, 0.6021796211481596, 0.6551333901246257, 0.6044143819130556, 0.6017566587926781, 0.7109559223307017, 0.6687174756435141, 0.561748011846501], [0.5697266450676727, 0.5435662492183205, 0.572085730372485, 0.5275580939033262, 0.5790898824688919, 0.5508874661391778, 0.5940182584666973, 0.4629211088331898, 0.5779401153771142, 0.5750962316606895], [0.4799035799068715, 0.4434362812948748, 0.41042093645597677, 0.4640938757303553, 0.43240182637463576, 0.44695231255755263, 0.46151924737204775, 0.5094719052592487, 0.4409507746888591, 0.474853153012351], [-1989.1302053590314, -2017.534303892534, -2029.687563047177, -2014.6237301607932, -1999.9876502103364, -2003.1266006663122, -2019.2171720762249, -2039.5850761787626, -1995.0222599936974, -2046.2012340183178]], 'MSE': [[1.248306016424114, 1.3639637042351636, 1.4615061821851159, 1.270220834173261, 1.3285420088126207, 1.1115612700335202, 1.2621059060951434, 1.441149932049032, 1.0995771190145662, 1.2715740577226682], [1.3606720062233268, 1.1930686411959273, 1.4432712928156797, 1.3625510365287716, 1.4779905818824255, 1.3720270655597424, 1.4370423262600216, 1.3592648784809098, 1.3362291076053521, 1.2966520821163181], [1.3019746354986228, 1.375300879109884, 1.3353978694134283, 1.3713291559183753, 1.3846738697310765, 1.4319870661798664, 1.3953103539131375, 1.3806480867555377, 1.3717084832766493, 1.3197313167768396], [1.3613183211950894, 1.3800155951279354, 1.3934226104661389, 1.506273015204818, 1.3574322714287388, 1.3460337631899888, 1.3735199093575177, 1.3600477031654983, 1.3911697453557736, 1.3158261740635258], [1.42690979181699, 1.4348139667582591, 1.3774046570586123, 1.4228705324296926, 1.4282392124086625, 1.4706569591686032, 1.4532882025572651, 1.4557759507682893, 1.4123182727570736, 1.4478115993504692], [1.4733748800470998, 1.4850713837965233, 1.4001507336840686, 1.4976759649218743, 1.5804973305271042, 1.4267969836653205, 1.4169610739945677, 1.4950450874625369, 1.4373417200732512, 1.4757978675159358], [1.5525623416076484, 1.5532768024032446, 1.5985956419760496, 1.4908285461208506, 1.5181204044386574, 1.5452250085406725, 1.5401348826171193, 1.5085775214879411, 1.5778535983313136, 1.4960758448303126], [1.5921519766961223, 1.5211939936487318, 1.6152609851613104, 1.6040293755119763, 1.6181054634384393, 1.6040187154663175, 1.6471971772066494, 1.5273698262221223, 1.5768595602163771, 1.5870316713717796], [1.7415025035014071, 1.6626898981658662, 1.6223840721044611, 1.6567335180117055, 1.698788596844915, 1.7809190493967804, 1.697021993003516, 1.7325913489061617, 1.7634841496727116, 1.7133197692869881], [1.7829312666379749, 1.7971193247731543, 1.9498554597773075, 1.8035964093488321, 1.831085215148442, 1.8904227370485294, 1.8103526253249722, 1.9100941137115011, 1.7017486932754817, 1.7484119235254405], [2.0313506986519942, 1.8587563635952851, 2.1321806161656065, 1.9360345488784594, 1.9771847085154608, 1.99293128072348, 1.996361502262417, 2.0520245758745581, 2.0003563807312528, 1.9470063795085382], [2.2327330996122337, 2.4910703698533236, 2.2094616157278306, 2.2562281187949806, 2.2061165285630411, 2.12845925158918, 2.2260863179710868, 2.5079124195265319, 2.2100550757912627, 2.0597470777165738], [2.5786369120712682, 2.8685413163958815, 2.6630207085463051, 2.7757950373775055, 2.6628688045137858, 2.5735706292396801, 2.7540313249519182, 2.4783399941094113, 2.7982668604671348, 2.8824689855946595], [3.4916208302279692, 3.885697280998639, 3.7192975536786466, 3.443085925179028, 3.459986867660243, 3.1418645045787397, 3.6661622656385298, 3.4737064468057453, 4.0913162220527806, 3.349388234647984], [10.46687854324427, 11.422043470971676, 9.8518405311643704, 7.3050480075665041, 6.0354494551704008, 7.8653765651403305, 9.4466615063122799, 6.7351006993043461, 6.239211788325898, 5.5699318264077409], [14.000363723651681, 11.244076077206696, 14.364777128811573, 15.485877449630184, 13.308022524777178, 15.893117480876739, 15.548918984639361, 11.528225713588379, 13.215088035490574, 17.261978654126732], [16.914051488405892, 18.080680393943993, 16.868998539079605, 18.441020044134628, 16.276710402933141, 17.821022513366071, 15.827750989854616, 20.758199133277646, 16.80650010478616, 16.83741956643912], [20.319680508136759, 21.995204617907714, 23.173426617013448, 20.99867918726796, 22.291950893864488, 22.063894228568095, 21.073548140073839, 19.358218156216402, 22.155850698834183, 20.629071695361233], [79045.670014629955, 79983.788418772921, 80177.448825241634, 79169.478797008545, 78778.597792737433, 79805.399228529786, 79187.52155414423, 80477.357516681135, 78560.211874014494, 79305.423349242017]], 'Rp': [[0.98563868506659835, 0.98056012860060882, 0.97880263790093003, 0.98467993615313099, 0.98726650224875279, 0.98293086394454598, 0.97984463566517188, 0.98157453771910852, 0.98684609335279772, 0.98577040866584442], [0.98187220307897827, 0.98560781342835269, 0.98287962360330194, 0.98155853781840163, 0.98242975910011032, 0.98182693437610491, 0.98173011174569769, 0.98322407599653538, 0.98117715074285061, 0.98215915130152354], [0.9814581022214055, 0.98176300098095193, 0.9832551304497944, 0.98326729761209342, 0.98357238886775922, 0.98226537876624231, 0.98226639128713744, 0.98068177783201693, 0.98122417492239211, 0.98474494661009704], [0.98342392903890841, 0.98130546229235971, 0.98188774853654393, 0.98099519966937654, 0.98285854669185269, 0.98260101417415657, 0.98288421035585227, 0.9828371554860954, 0.98237897071357083, 0.98279287269754079], [0.98211998888356733, 0.97986465490742525, 0.98203437472924149, 0.98203588557901611, 0.9822441324207607, 0.98038605974725124, 0.98131548346342112, 0.98246392971232754, 0.98256669634616312, 0.98161289400497809], [0.98100499987139278, 0.98067253703981483, 0.98285945308456502, 0.9800483407599857, 0.98081049939083786, 0.98164668977623715, 0.9823599065675912, 0.98086746671278602, 0.98128854367651619, 0.97986161327888588], [0.98044058716529681, 0.98079837104939815, 0.97933323212200196, 0.98111013449699291, 0.97983789759432172, 0.97997132375257612, 0.98000089959612613, 0.98140901927533597, 0.97958657330670063, 0.98112096883800648], [0.98030346279322134, 0.98052377237857313, 0.97934408331994283, 0.97876696427722676, 0.97964775845597585, 0.98067263520866388, 0.97994520159034948, 0.97982099978442838, 0.9779657285510831, 0.97907200911413961], [0.97717252405613009, 0.97815072063021613, 0.97934842116690168, 0.97894314123805404, 0.97772815605099561, 0.97736920642334035, 0.9783390738562483, 0.97790570511222275, 0.97663680247657769, 0.97748522316162512], [0.97711992660509395, 0.97633424973114447, 0.97546075956081491, 0.97640999208485091, 0.9760848177281618, 0.9770690728555298, 0.97572235786829187, 0.97640568363207658, 0.97756522474543395, 0.97757046232520972], [0.97423012861039004, 0.97627205032411746, 0.97263747446758864, 0.97678798485983642, 0.97417983724229718, 0.97499143990263304, 0.97280591494362423, 0.97289009297203832, 0.97476320232225377, 0.97465301464423693], [0.97201230439845776, 0.96832023028167713, 0.97053043728477384, 0.97162432822620382, 0.97067490095952924, 0.97228385113681226, 0.97060793094420794, 0.96836211946584805, 0.97122672894594864, 0.97254317623142672], [0.96662884961191886, 0.9642183636022611, 0.96468869520493561, 0.96436624024254569, 0.96610924185993996, 0.96557743411901165, 0.96441599377912368, 0.96700362798217065, 0.96477712034989815, 0.96249285541534446], [0.95523749060178353, 0.95045609043489188, 0.95192385382007727, 0.95522036675374911, 0.95518560549750986, 0.96022363884082684, 0.95390329041645183, 0.95564704992309768, 0.94799666303703578, 0.95609518997350273], [0.86229033464672655, 0.84529019492980828, 0.87189712879979142, 0.90463284588723702, 0.92286027820214656, 0.89514871251494665, 0.87368687458810135, 0.91210837640577436, 0.91757899135156384, 0.92608878833755426], [0.80890924604900394, 0.84639822900961426, 0.79831596081883682, 0.78976270079796362, 0.81471582821700217, 0.78433497335980673, 0.78916391908995842, 0.8434583933849672, 0.81874089076734879, 0.76580354478191037], [0.76317960659181483, 0.74015536667393433, 0.7597001142387384, 0.73820541599343448, 0.76480514947240974, 0.74736586055023024, 0.77337965555622457, 0.71872109452842048, 0.76246806610976492, 0.75947771400393616], [0.73384253193646609, 0.70866500232433571, 0.69724575240287123, 0.72204999353520682, 0.71312041668735415, 0.70951208767898832, 0.72588346585145636, 0.74244687191704839, 0.71355126533933899, 0.72964201870648304], [-0.056349802928094467, 0.11042068385928523, -0.013485229804784732, 0.021755745176307125, 0.038005126018088309, 0.17507303882960071, -0.08720112410134212, 0.0021399334844361974, 0.13769771722837879, -0.038590338870275499]]} 
average_performances = {'R^2': [0.966980437115802, 0.9650287331095182, 0.9651154898911143, 0.9650250977670772, 0.9635950184869883, 0.9625721444962769, 0.9610752713497867, 0.9595266664399972, 0.9561969601678243, 0.9536028743100644, 0.9493862276389674, 0.9423372165129583, 0.9311082253425745, 0.9100389794887631, 0.7946254741267562, 0.638839887064533, 0.5552889781507565, 0.45640038926527726, -2015.4115795603186], 'MSE': [1.2858507030745203, 1.3638769018668473, 1.3668061716573416, 1.3785059108555022, 1.4330089145073919, 1.4688713025688283, 1.5381250592353808, 1.5893218744939825, 1.7069434898894513, 1.8225617768571634, 1.9924187054907052, 2.2527869875146047, 2.7035540573267549, 3.5722126131468306, 8.0937542393607806, 14.185044577279907, 17.463235317622086, 21.405952474324412, 79449.089737100207], 'Rp': [0.98339144293174896, 0.98244653611918564, 0.98244985895498904, 0.98239651096562564, 0.98166440997941518, 0.98114200501586113, 0.98036090071967563, 0.97960626154736041, 0.97790789741723128, 0.97657425471366077, 0.97442111402890141, 0.97081860078748861, 0.96502784221671511, 0.95418892392989263, 0.89315825256636483, 0.80596036862764131, 0.75274580437189087, 0.71959594063795485, 0.02894657488915995]}
'''


# Plot the MSE, R^2 and Rp
for metric in metrics:
    plt.figure()
    x = fractions_unknown
    y = average_performances[metric]
    plt.plot(x,y)
    plt.xlabel("Fraction missing")
    plt.ylabel(metric)