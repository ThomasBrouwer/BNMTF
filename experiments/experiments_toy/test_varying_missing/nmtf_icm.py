"""
Test the performance of ICM for recovering a toy dataset, where 
we vary the fraction of entries that are missing.

We use the correct number of latent factors and same priors as used to generate the data.

I, J, K, L = 100, 50, 10, 5
"""

import sys, os
project_location = os.path.dirname(__file__)+"/../../../../"
sys.path.append(project_location)

from BNMTF.code.models.nmtf_icm import nmtf_icm
from BNMTF.data_toy.bnmtf.generate_bnmtf import try_generate_M
from BNMTF.code.cross_validation.mask import calc_inverse_M

import numpy, matplotlib.pyplot as plt

##########

fractions_unknown = [0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95] #[ 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9 ]

input_folder = project_location+"BNMTF/data_toy/bnmtf/"

repeats = 10 # number of times we try each fraction
iterations = 1000
I,J,K,L = 100, 80, 5, 5

alpha, beta = 1., 1.
lambdaF = numpy.ones((I,K))/10.
lambdaS = numpy.ones((K,L))/10.
lambdaG = numpy.ones((J,L))/10.
priors = { 'alpha':alpha, 'beta':beta, 'lambdaF':lambdaF, 'lambdaS':lambdaS, 'lambdaG':lambdaG }

init_S = 'random'
init_FG = 'kmeans'

minimum_TN = 0.1

metrics = ['MSE', 'R^2', 'Rp']

# Load in data
R = numpy.loadtxt(input_folder+"R.txt")

# Seed all of the methods the same
numpy.random.seed(3)

# Generate matrices M - one list of M's for each fraction
M_attempts = 100
all_Ms = [ 
    [try_generate_M(I,J,fraction,M_attempts) for r in range(0,repeats)]
    for fraction in fractions_unknown
]
all_Ms_test = [ [calc_inverse_M(M) for M in Ms] for Ms in all_Ms ]

# Make sure each M has no empty rows or columns
def check_empty_rows_columns(M,fraction):
    sums_columns = M.sum(axis=0)
    sums_rows = M.sum(axis=1)
    for i,c in enumerate(sums_rows):
        assert c != 0, "Fully unobserved row in M, row %s. Fraction %s." % (i,fraction)
    for j,c in enumerate(sums_columns):
        assert c != 0, "Fully unobserved column in M, column %s. Fraction %s." % (j,fraction)
        
for Ms,fraction in zip(all_Ms,fractions_unknown):
    for M in Ms:
        check_empty_rows_columns(M,fraction)


# We now run the VB algorithm on each of the M's for each fraction.
all_performances = {metric:[] for metric in metrics} 
average_performances = {metric:[] for metric in metrics} # averaged over repeats
for (fraction,Ms,Ms_test) in zip(fractions_unknown,all_Ms,all_Ms_test):
    print "Trying fraction %s." % fraction
    
    # Run the algorithm <repeats> times and store all the performances
    for metric in metrics:
        all_performances[metric].append([])
    for (repeat,M,M_test) in zip(range(0,repeats),Ms,Ms_test):
        print "Repeat %s of fraction %s." % (repeat+1, fraction)
    
        # Run the VB algorithm
        NMTF = nmtf_icm(R,M,K,L,priors)
        NMTF.initialise(init_S,init_FG)
        NMTF.run(iterations,minimum_TN=minimum_TN)
    
        # Measure the performances
        performances = NMTF.predict(M_test)
        for metric in metrics:
            # Add this metric's performance to the list of <repeat> performances for this fraction
            all_performances[metric][-1].append(performances[metric])
    
    # Compute the average across attempts
    for metric in metrics:
        average_performances[metric].append(sum(all_performances[metric][-1])/repeats)
        

print "repeats=%s \nfractions_unknown = %s \nall_performances = %s \naverage_performances = %s" % \
    (repeats,fractions_unknown,all_performances,average_performances)


'''
repeats=10 
fractions_unknown = [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9] 
all_performances = {'R^2': [[0.9975927090292699, 0.9980081023219172, 0.9978155521077262, 0.9975554561095054, 0.997923878035404, 0.9982099616576611, 0.9981625860413992, 0.9978359736733243, 0.9978779504510271, 0.997515342709776], [0.9975890536153215, 0.9980292910066693, 0.9979194412541915, 0.9979658918924728, 0.9975677425995196, 0.9980789962725235, 0.9978807816742185, 0.9979738215496476, 0.9977169179356461, 0.9979390527530128], [0.9977695576055731, 0.9977719145111632, 0.9977470654043835, 0.9975949936294892, 0.9978477764618622, 0.9974169395818809, 0.997792227822902, 0.9978193213459388, 0.9975648828625464, 0.9975486588574607], [0.9976570706503591, 0.997912315499696, 0.9975888360031283, 0.9975517834065201, 0.997401303631934, 0.9976416958006299, 0.9975701396700851, 0.9977735347994222, 0.9977381352638842, 0.9978347279701963], [0.9972048400356697, 0.9974121335180816, 0.9972725006709184, 0.9973945651110651, 0.9975860214597151, 0.9977031023255696, 0.9973354940256396, 0.9973366323745044, 0.9975166443424057, 0.9973194422122789], [0.9968876942549296, 0.9974666638945257, 0.9971232162590854, 0.9965339728630452, 0.9975274512294184, 0.9970835492426965, 0.9968105183626977, 0.9973085027696141, 0.9970350876802735, 0.9971047649757829], [0.9956004866700275, 0.9960425084997317, 0.9956908333301903, 0.9963534897720362, 0.9962563685498766, 0.996272429736938, 0.9963548678337069, 0.9958440798191359, 0.9957456641450465, 0.9958371822889462], [0.966490466863117, 0.9504011247182779, 0.9876873238870871, 0.9837743100507569, 0.9934731765762597, 0.9628010730795674, 0.9929675264889107, 0.9852611319618546, 0.980928068556346, 0.9846092579536968], [0.7448940841360358, 0.5644707788072548, 0.7317341967977111, 0.6268865264832666, 0.6904933275719349, 0.6529445005908574, 0.5883958546834347, 0.5221206128238185, 0.8335961861162272, 0.721881132667106]], 'MSE': [[1.2359111050754783, 1.3042928410580119, 1.2376394595262963, 1.2275988732827634, 1.2382569585089236, 1.1418971298061806, 1.1441518803914916, 1.2223920892944424, 1.2247789351682155, 1.2417987434632936], [1.2792307137209402, 1.2095820439287437, 1.204666514137299, 1.2176876197524185, 1.2450080035692148, 1.2369182353181538, 1.2530229409862728, 1.1919084524073353, 1.2828978056725004, 1.2545687977643687], [1.306426127698413, 1.2906457456653304, 1.3398826196253992, 1.3881057063319009, 1.2359863502075081, 1.3861514029887203, 1.2824578439380021, 1.368772494293425, 1.2942788237192839, 1.2678432597883094], [1.3495310437055388, 1.3641408699751489, 1.3558539963324807, 1.37733755299835, 1.3842753912555095, 1.3138440184813585, 1.4012705880437191, 1.2997572216472284, 1.3232244381774516, 1.3412297465782208], [1.4845439502286777, 1.4236733167015867, 1.4829075685316131, 1.5204074140569728, 1.4671178593650924, 1.296597105766925, 1.4165389674196776, 1.5220963946036925, 1.4511389025847241, 1.5223750280398956], [1.7278422464010317, 1.4371317131299706, 1.664199220301334, 1.8513490228163638, 1.4211713429603694, 1.6371637612297056, 1.7683467037268072, 1.5486671570896307, 1.7350633312338388, 1.6605389189725468], [2.6195785679210499, 2.3095470903110709, 2.4722099129359854, 2.1205864798805969, 2.1261213726651982, 2.1416350443412218, 2.1391932810654732, 2.3567048373783179, 2.4427368406574317, 2.3864977291757903], [19.054484310140925, 28.26033451828971, 7.1455382084831127, 9.5589530429614076, 3.744672733276559, 22.104946580343103, 3.930619863957872, 8.4495494068552048, 11.058583546825346, 8.8319755926652324], [144.22416058491476, 249.60357823247341, 153.54572226357712, 211.09141802208796, 176.71761117002131, 194.69471829847672, 237.88233262720109, 275.26569225321771, 95.593068425483409, 162.0412584829115]], 'Rp': [[0.99880420951544502, 0.99900395021136434, 0.99890857558075508, 0.99878035694496503, 0.99896500446856951, 0.99910731663444752, 0.99908550333940471, 0.9989248480995444, 0.99893876976564466, 0.99876195708329107], [0.99879681787297547, 0.99901489703340884, 0.99895955595351549, 0.99898584690408676, 0.99878738899022479, 0.99904044836434747, 0.99894016179002976, 0.99898821843986496, 0.99885993625712199, 0.99897197416089323], [0.99888436491207322, 0.99888592938366239, 0.99887397749315432, 0.9987985413547712, 0.99892389506668577, 0.99870798064138, 0.99889670828874466, 0.99890921170628233, 0.99878353194075076, 0.99877442025883056], [0.99882953400638341, 0.99895874015184949, 0.99879652488340387, 0.99877596405665137, 0.99869999080131067, 0.99882300349094955, 0.99878850333901692, 0.99888736849994753, 0.99887119732067753, 0.99891742914772053], [0.99860239521475547, 0.99870576989184867, 0.99863740745075846, 0.99869652065113557, 0.99880231392030572, 0.99885117938926438, 0.99867060989233092, 0.99867208619182257, 0.99875800884615606, 0.99865894212951556], [0.99844309014561028, 0.99873292732912911, 0.99856256752744232, 0.99826775109421695, 0.99876308359431631, 0.99854175878031926, 0.99840826616033396, 0.99865428180438387, 0.99852227404052185, 0.99855668698014199], [0.99780564121926174, 0.99802260055713676, 0.99786671812837191, 0.99819140855105448, 0.99813263124688767, 0.99813520389691202, 0.99817671233486327, 0.99793440286027668, 0.99787319646144834, 0.99791773308442666], [0.98362796692557153, 0.97694437268254153, 0.993825075948362, 0.991854258729025, 0.99673194445485813, 0.98223469976977984, 0.99649303700878877, 0.99265967783514075, 0.99053006207596628, 0.99229389145788727], [0.89031297236990137, 0.83497912445121836, 0.87060834703560308, 0.83604847675271821, 0.87662483639964928, 0.85831295806558006, 0.83403806731021446, 0.81720594968054239, 0.92663402534958672, 0.88144323801393565]]} 
average_performances = {'R^2': [0.9978497512137011, 0.9978660990553223, 0.9976873338083202, 0.9976669542695855, 0.9974081376075847, 0.9970881421532068, 0.9959997910645635, 0.9788393460135871, 0.6677417200677647], 'MSE': [1.2218718015575099, 1.2375491127257248, 1.3160550374256292, 1.3510464867195005, 1.4587396507298858, 1.64514734178616, 2.3114811156332133, 12.213965780379848, 190.06595603603648], 'Rp': [0.99892804916434308, 0.99893452457664689, 0.99884385610463355, 0.99883482556979108, 0.9987055233577895, 0.99854526874564153, 0.99800562483406396, 0.98971949868879217, 0.86262079954289494]}

repeats=10 
fractions_unknown = [0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95] 
all_performances = {'R^2': [[0.9977960716139789, 0.9973834994890584, 0.9983016043107281, 0.9975472592906569, 0.9978136425496568, 0.9982280201387091, 0.9981965828582579, 0.9982640230093016, 0.9983963415199908, 0.9986477681687802], [0.9980111539591642, 0.9975445304412317, 0.9978931295438996, 0.9974807190762393, 0.99757835772839, 0.9983210217988878, 0.9978340730406277, 0.9967995704214855, 0.9978108885059572, 0.9979979938512343], [0.9973146791772716, 0.9980396394604358, 0.9977687638443559, 0.997904081502049, 0.9975161817834871, 0.998121638140143, 0.9976928630836424, 0.9978737988025677, 0.9977120376906787, 0.9972076792556375], [0.9978259391246938, 0.9977884822776646, 0.9980475595309849, 0.9976484374258442, 0.9976216503705784, 0.99789535037804, 0.9978651088505368, 0.9979826727856517, 0.997544456824371, 0.9975883619808774], [0.9975896865555836, 0.9976926057034096, 0.9976484871022528, 0.9978103442988308, 0.9978474789857447, 0.9972883842908079, 0.997677596006807, 0.9977181786238531, 0.9977999285296558, 0.9977976626898056], [0.9975737461445836, 0.9975423188792942, 0.9977169797502722, 0.9979126318421085, 0.9975225209643708, 0.997757794048769, 0.9975233529826689, 0.9978989446831908, 0.9979259356750545, 0.9978514364388203], [0.9978665622537566, 0.9977476716261016, 0.9975760561841783, 0.99790900009907, 0.9977387640460015, 0.9976825507814665, 0.9977414083572004, 0.997848613997625, 0.9977360605400215, 0.9975028818526086], [0.9975234749065116, 0.9974798654620204, 0.9974761474309704, 0.9973728835895923, 0.9976878829209026, 0.9976997532110653, 0.9974807774566232, 0.9975172657032069, 0.9976588312092749, 0.9977835395758824], [0.9976916099058944, 0.9973953438727917, 0.997230212317283, 0.9973304698418283, 0.9977560222676292, 0.9976886347066465, 0.997663466707994, 0.997508865564486, 0.997724741393137, 0.9976413063374209], [0.9972797546513117, 0.9973940868507666, 0.9972898855173566, 0.9974036286735548, 0.9974003668260464, 0.9974139449622138, 0.9975140464267697, 0.9975152871072698, 0.997777046292111, 0.9975378762795625], [0.9971501213232983, 0.9971977857080206, 0.9975558498142384, 0.9974912047361075, 0.9972945765279337, 0.997352246105013, 0.9973115052336812, 0.9974688120116599, 0.9974422419135635, 0.9974107073837184], [0.9970995270455087, 0.9973392783898744, 0.9972834182452326, 0.9972311347022608, 0.9972923039059131, 0.997197545842884, 0.9970868777460126, 0.9973734774086613, 0.9974327173642094, 0.9971003899531427], [0.9971298838288146, 0.9967578636383226, 0.9966776909374893, 0.9970304781422635, 0.9960345037762506, 0.9968291959653174, 0.9967697623614128, 0.9968179355654329, 0.9967998002156155, 0.9968017819420039], [0.9910039919105932, 0.9960555506964023, 0.9962509552455636, 0.9938998176987858, 0.9966791511827771, 0.9966366624720836, 0.9967903317782414, 0.9942109857060469, 0.9962207623480237, 0.9960353282783987], [0.995842543538116, 0.9955620025360832, 0.995907521770374, 0.8829053844080554, 0.9959229055620908, 0.9904842012728244, 0.9949252711617799, 0.9958227145540727, 0.9960905531238834, 0.995899366309018], [0.9934617025608774, 0.7371740107582515, 0.9922826081721235, 0.9934648038262894, 0.9838012678489808, 0.9896178071196157, 0.9814919718710041, 0.9812151164783904, 0.9837925411381649, 0.982883296991726], [0.8675910902715176, 0.9719095961333374, 0.8932930234717759, 0.9164207092822406, 0.8919421316904165, 0.9005238308496155, 0.9441155496017423, 0.9774620451163136, 0.9355822571031298, 0.9798571574602224], [0.5891624711472134, 0.7648666894351978, 0.7844874522667273, 0.6699633816459498, 0.5912874125814198, 0.7938940480533925, 0.7654709776302533, 0.372397391797735, 0.5689501208164378, 0.5707875297302283], [0.5356820022435773, 0.6425334772832034, 0.5279011792193716, 0.25505905517157423, 0.45448485610879363, 0.471030154278161, 0.48683253473635146, 0.6287791547754051, 0.6517576137524674, 0.49949659259123036]], 'MSE': [[1.1450246392114909, 1.2986670590230718, 1.262895968808295, 1.29825964658808, 1.4138665350704542, 1.0724022212929925, 1.2002489707376693, 1.2501162558286667, 1.1617217382766478, 1.2223468964174509], [1.1885623802538827, 1.2545136796398837, 1.4094536329111025, 1.329634618943272, 1.2521469466946074, 1.2387188840155623, 1.2177932802807248, 1.1976076890097385, 1.2328860687036776, 1.3004538688910794], [1.3091331188036246, 1.1699102110675565, 1.3689684255984995, 1.2638748078391044, 1.2833228665268406, 1.1564118609700051, 1.3209733440027862, 1.2762883138271994, 1.3163661787371224, 1.3859241245280605], [1.3419589522616153, 1.2464529617661497, 1.2874660589480103, 1.3935502398437702, 1.3637977502174352, 1.2224412621837066, 1.2211385805166233, 1.2027964656159795, 1.3864034937354353, 1.2795360946164827], [1.2856684807702792, 1.3319642545033934, 1.322338998508074, 1.2888487786435445, 1.3173376617480976, 1.4271941583652452, 1.3081757099208153, 1.4142075696016867, 1.291599600542312, 1.2296601238294209], [1.4561542408876869, 1.3548394884532, 1.2474253593911397, 1.2695165954654954, 1.3880053786827933, 1.3203555463773231, 1.3175642196349024, 1.2377602302549882, 1.2305351176261241, 1.2983851052958166], [1.2550550812445838, 1.2485573168105362, 1.3860457578407819, 1.272664109751503, 1.2067096392920351, 1.3227053456436386, 1.3503037860031089, 1.2710761506507637, 1.3608981059913599, 1.3585545973728475], [1.3565973014319042, 1.4078421372954384, 1.3681682904899881, 1.3815523823850144, 1.3430060224882041, 1.3671747729303292, 1.3566905483801273, 1.4243779991670056, 1.4010205397342466, 1.3502767881290783], [1.4450708655967792, 1.4169715322519969, 1.6678115220273113, 1.4225154528631265, 1.4015539722892949, 1.3414530355518277, 1.364043459535724, 1.3814473757333345, 1.3480544195167985, 1.3751031783066732], [1.4427006547855894, 1.494580879551638, 1.5942235427118878, 1.3599595844761085, 1.4943169638141514, 1.4702564716750393, 1.4855692701548133, 1.4435876091692579, 1.2815842421261499, 1.4210031425646643], [1.5772181401336689, 1.5654595031984846, 1.4069078858228075, 1.4777761152040079, 1.5552847083515597, 1.4840830577653927, 1.4825277592310759, 1.4862587456687619, 1.5207591062057491, 1.469974108855759], [1.6546548113350283, 1.4618935014338796, 1.6169883281110622, 1.5151526511788675, 1.5664548144455308, 1.6764140454342262, 1.6725771428458265, 1.4631902851047409, 1.5554480716787247, 1.6370529724262626], [1.6367548364088857, 1.8550847285144507, 1.9690461104081762, 1.6625927306332324, 2.2229930695515598, 1.8537641144518238, 1.7738650420783093, 1.782531880977406, 1.875946833165107, 1.8138575293636237], [5.1868853495123961, 2.2725482800187429, 2.2197745665901354, 3.5328223673119004, 1.8576404284898198, 1.9223835554790278, 1.7757916530539961, 3.3120375395504573, 2.1814882442868133, 2.3003375517405131], [2.3607550410019691, 2.5527398367559089, 2.3819341566204906, 66.333478408471791, 2.4509302605799901, 5.5157660021332902, 2.916088083254964, 2.3888283872327198, 2.2343597198439613, 2.2393921157266408], [3.8051959107529325, 156.05426900405925, 4.5022766451240486, 3.7695914924360454, 9.2785189900528913, 6.0528134400167906, 10.770496666154495, 10.867618932373919, 9.2052455851677433, 9.8885589088119588], [77.810189469115016, 16.224653856134744, 61.59555950659238, 46.618829263148868, 60.578534656481047, 56.644269349693523, 33.140001594590785, 12.840300085843067, 37.187807127884774, 11.728983634417434], [236.7423844286273, 130.38743451940667, 123.03203486810101, 190.50870291106733, 231.82376771486133, 121.05394140124487, 134.42958943368492, 360.28596416203214, 244.40634070142011, 247.17188547620017], [270.0540370588659, 205.53242824756143, 267.84105795700276, 426.9337636314288, 315.32642727762124, 301.20774639438889, 291.25795132420939, 213.66670393856165, 198.75373213764905, 287.60860431144732]], 'Rp': [[0.99890935256924096, 0.99869185280726025, 0.99916276320407815, 0.99877676385742276, 0.99891310989709747, 0.99911797993527129, 0.99910187286913665, 0.99913797417060035, 0.99920288198206242, 0.999330249353373], [0.99900615287740258, 0.99877516828671953, 0.99896692788050023, 0.99874957459175939, 0.99878974075166183, 0.99916734184053047, 0.99891746995248221, 0.99840579799538876, 0.99891356947634524, 0.99900600476308365], [0.99866262837407427, 0.99902441774235584, 0.99888640359126069, 0.99895339611985856, 0.99876404317948186, 0.99906197807601993, 0.9988470436151502, 0.99893773743809144, 0.99886585638400172, 0.9986071721895754], [0.99892628533831729, 0.99889735003056468, 0.99902385095087365, 0.99882411479595268, 0.9988113114169318, 0.99894900047793445, 0.99893444048330937, 0.99899212367256651, 0.99877418661514783, 0.99879851371599571], [0.9987953766991271, 0.99884814006291944, 0.99882534167464987, 0.99890576518535468, 0.9989259470544104, 0.99865174291269776, 0.99883983190854908, 0.99886078239354525, 0.99889955170821354, 0.99889933271644105], [0.99879254271427154, 0.9987752750031017, 0.99885837198547611, 0.99895647699378343, 0.99876106272044007, 0.99887904382598092, 0.99876613627728883, 0.99894958822151481, 0.9989647243004387, 0.99892730066312319], [0.99894393852846219, 0.99887633512073926, 0.99879137255226835, 0.99895511888467603, 0.99886879198767853, 0.99884571172590897, 0.99887216862001826, 0.99892833150295557, 0.9988695322819654, 0.99875289107495691], [0.99876347416434419, 0.99874326175445161, 0.99874014046974335, 0.99868807892266076, 0.99884534157992444, 0.99885015965869572, 0.99874240642417889, 0.99876339961357352, 0.99882908830951045, 0.99889219125682949], [0.99884824688476104, 0.99869920655871125, 0.99861826203745563, 0.99867253197609851, 0.99888351349247551, 0.99884688875393157, 0.99883458545343429, 0.99875585601283423, 0.99886183194494327, 0.99882304720438408], [0.99864178242640111, 0.99870277918222594, 0.99865088053712014, 0.99870795220847663, 0.99870201114927393, 0.99871454181743746, 0.99875772047994216, 0.99875864683112903, 0.99888892324977241, 0.99877267666535341], [0.99857409963631272, 0.99860632623390699, 0.99877785214981529, 0.99874512485309175, 0.99865193974519373, 0.99868546619008902, 0.99865788495019348, 0.99873892626542049, 0.99872403401333754, 0.99870997987681687], [0.99855017065490947, 0.9986687622542203, 0.99864981832292632, 0.99861499275635679, 0.99864617085512219, 0.99860256927794799, 0.99854596594405087, 0.99869167154587724, 0.99872024010358373, 0.99855537373748726], [0.99856643106380216, 0.9983792922799114, 0.99835264964525361, 0.9985144270164984, 0.99803345855867265, 0.99842495141746068, 0.99838607906859389, 0.99840865279579272, 0.99841544942711424, 0.99840045147289369], [0.99551286695583363, 0.99803265155046572, 0.99812538967031328, 0.99694844039148545, 0.99833861008987512, 0.99831785625680958, 0.99839705249686583, 0.99710229637235048, 0.99811734952734865, 0.99801657217517592], [0.99792672579435393, 0.99778161866028414, 0.9979557395283718, 0.94540538085365777, 0.99796123624828348, 0.99523276726597965, 0.9974610328108009, 0.99791127988803696, 0.99804820787585291, 0.99795351389476661], [0.9967621481196125, 0.88463345249420922, 0.99615828401900974, 0.99672915103861981, 0.99197321428477458, 0.99482651130955702, 0.99080231904391824, 0.9907108255405126, 0.99192096418767595, 0.99145986525720042], [0.93278003598471049, 0.98635120492483941, 0.95379991091096294, 0.95832139107447212, 0.94976056779666818, 0.95109755380423389, 0.97315830799096914, 0.98869008271397618, 0.96837229130465574, 0.99002572508503617], [0.82899672390352575, 0.88897660021746838, 0.89733927334601338, 0.84756014823296355, 0.82447297652678064, 0.90705198593095693, 0.90587327909949378, 0.79879661536924096, 0.84499517565171556, 0.84721926048568019], [0.78411640788953207, 0.8306266710716893, 0.78598556365468686, 0.70230820340856248, 0.75017038856772689, 0.76068119503423637, 0.82938455655594701, 0.82229042998374346, 0.84833032220204641, 0.77084465228349131]]} 
average_performances = {'R^2': [0.9980574812949119, 0.9977271438367117, 0.9977151362740269, 0.9977808019549244, 0.9976870352786751, 0.9977225661409133, 0.9977349569738028, 0.997568042146605, 0.9975630672915111, 0.9974525923586963, 0.9973675050757235, 0.9972436670603699, 0.9967648896372923, 0.9953783537316918, 0.9839362464236299, 0.9619185126765425, 0.927869739098031, 0.6471267475104554, 0.5153556620160135], 'MSE': [1.2325549931254818, 1.2621771049343531, 1.28511732519008, 1.294554185970521, 1.3216995336432869, 1.3120541282069469, 1.303256989060116, 1.3756706782431336, 1.4164024813672866, 1.44877823610293, 1.5026249130437268, 1.5819826623994149, 1.8446436875552574, 2.6561709536033797, 9.1374272011621738, 22.419458557495005, 41.436912854390165, 201.9842045616646, 277.81824522787366], 'Rp': [0.99903448006455431, 0.99886977484158757, 0.99886106767098704, 0.99889311774975942, 0.99884518123159083, 0.99886305227054195, 0.99887041922796294, 0.99878575421539106, 0.9987843970319028, 0.99872979145471308, 0.99868716339141772, 0.99862457354524836, 0.99838818427459919, 0.99769090854865239, 0.99236375028203871, 0.982597673529509, 0.96523570715905238, 0.859128203876384, 0.78847383906516622]}
'''


# Plot the MSE, R^2 and Rp
for metric in metrics:
    plt.figure()
    x = fractions_unknown
    y = average_performances[metric]
    plt.plot(x,y)
    plt.xlabel("Fraction missing")
    plt.ylabel(metric)