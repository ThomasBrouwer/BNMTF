"""
Test the performance of Gibbs sampling for recovering a toy dataset, where we 
vary the fraction of entries that are missing.
We repeat this 10 times per fraction and average that.

We use the correct number of latent factors and same priors as used to generate the data.

I, J, K = 100, 80, 10
"""

project_location = "/Users/thomasbrouwer/Documents/Projects/libraries/"
import sys
sys.path.append(project_location)

from BNMTF.code.models.bnmf_gibbs_optimised import bnmf_gibbs_optimised
from BNMTF.data_toy.bnmf.generate_bnmf import try_generate_M
from BNMTF.code.cross_validation.mask import calc_inverse_M

import numpy, matplotlib.pyplot as plt

##########

fractions_unknown = [0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95] #[ 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9 ]

input_folder = project_location+"BNMTF/data_toy/bnmf/"

repeats = 10 # number of times we try each fraction
iterations = 1000
burn_in = 800
thinning = 5

init_UV = 'random'
I,J,K = 100, 80, 10

alpha, beta = 1., 1.
lambdaU = numpy.ones((I,K))/10.
lambdaV = numpy.ones((J,K))/10.    
priors = { 'alpha':alpha, 'beta':beta, 'lambdaU':lambdaU, 'lambdaV':lambdaV }

metrics = ['MSE', 'R^2', 'Rp']

#'''
# Load in data
R = numpy.loadtxt(input_folder+"R.txt")

# Seed all of the methods the same
numpy.random.seed(3)

# Generate matrices M - one list of M's for each fraction
M_attempts = 100
all_Ms = [ 
    [try_generate_M(I,J,fraction,M_attempts) for r in range(0,repeats)]
    for fraction in fractions_unknown
]
all_Ms_test = [ [calc_inverse_M(M) for M in Ms] for Ms in all_Ms ]

# Make sure each M has no empty rows or columns
def check_empty_rows_columns(M,fraction):
    sums_columns = M.sum(axis=0)
    sums_rows = M.sum(axis=1)
    for i,c in enumerate(sums_rows):
        assert c != 0, "Fully unobserved row in M, row %s. Fraction %s." % (i,fraction)
    for j,c in enumerate(sums_columns):
        assert c != 0, "Fully unobserved column in M, column %s. Fraction %s." % (j,fraction)
        
for Ms,fraction in zip(all_Ms,fractions_unknown):
    for M in Ms:
        check_empty_rows_columns(M,fraction)


# We now run the Gibbs sampler on each of the M's for each fraction.
all_performances = {metric:[] for metric in metrics} 
average_performances = {metric:[] for metric in metrics} # averaged over repeats
for (fraction,Ms,Ms_test) in zip(fractions_unknown,all_Ms,all_Ms_test):
    print "Trying fraction %s." % fraction
    
    # Run the algorithm <repeats> times and store all the performances
    for metric in metrics:
        all_performances[metric].append([])
    for (repeat,M,M_test) in zip(range(0,repeats),Ms,Ms_test):
        print "Repeat %s of fraction %s." % (repeat+1, fraction)
    
        BNMF = bnmf_gibbs_optimised(R,M,K,priors)
        BNMF.initialise(init_UV)
        BNMF.run(iterations)
    
        # Measure the performances
        performances = BNMF.predict(M_test,burn_in,thinning)
        for metric in metrics:
            # Add this metric's performance to the list of <repeat> performances for this fraction
            all_performances[metric][-1].append(performances[metric])
            
    # Compute the average across attempts
    for metric in metrics:
        average_performances[metric].append(sum(all_performances[metric][-1])/repeats)
    
 
    
print "repeats=%s \nfractions_unknown = %s \nall_performances = %s \naverage_performances = %s" % \
    (repeats,fractions_unknown,all_performances,average_performances)


'''
repeats=10 
fractions_unknown = [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9] 
all_performances = {'R^2': [[0.9619059001208281, 0.9640827667211137, 0.9694512746263138, 0.9701886721742091, 0.9657569043522852, 0.9645199588372723, 0.9634705713931656, 0.9676267917708213, 0.9675622254798245, 0.9684506981142136], [0.9661983256111081, 0.9616205514088321, 0.964782466321369, 0.9642198246274559, 0.9609647615999493, 0.9645080846532873, 0.9628567568565517, 0.9625100016209683, 0.9647052208065231, 0.9617419670924906], [0.9643234840870709, 0.9617430678118996, 0.961338418396636, 0.9621685540717345, 0.9590790976588984, 0.9630979205180834, 0.9648309654552717, 0.9610122836488321, 0.961987672033106, 0.9612220362972822], [0.9595101862277302, 0.9594776094947263, 0.957823871926474, 0.9570380281896163, 0.9565386172828394, 0.9598820325488254, 0.9578290274243525, 0.9568794205531495, 0.9614822869442783, 0.9590428076940245], [0.9522941300113166, 0.9592824357136986, 0.9523343094760195, 0.9530924121407341, 0.9545449371032484, 0.9552885193209901, 0.9535007755625815, 0.9533325771726907, 0.9538848182936318, 0.9526588158499125], [0.9431535719627517, 0.9430805152703715, 0.9438988157247572, 0.939609300028728, 0.9419858916360788, 0.9414720533278618, 0.9431853506983003, 0.9450629953350186, 0.9420390340603483, 0.940740567078019], [0.907184519966465, 0.8893815616999061, 0.8947153607127359, 0.9210263887880934, 0.9165479957564602, 0.9011617012566961, 0.914193937886436, 0.9096273664291488, 0.8954458717355149, 0.9141336520293362], [0.7156007465858046, 0.6608549871190714, 0.5081403620663952, 0.5878899388839927, 0.569112134184095, 0.5922612076738332, 0.6788791286000178, 0.6756450333289706, 0.6368380147278165, 0.6412391457100886], [-0.03883065769894101, 0.39937236004066956, 0.28768810475157225, 0.09263549338150567, 0.3168058803008834, -0.09290240474776601, 0.35323399570551717, 0.3214323519141459, 0.4174905865373635, 0.33869715838260983]], 'MSE': [[1.3435161026525739, 1.422961444249444, 1.3631881946753663, 1.2758401195570195, 1.3723055080209405, 1.3591839088535866, 1.3073380616795633, 1.2759250524622099, 1.3171618674650449, 1.3008268160586309], [1.4052993493654045, 1.4061825751225325, 1.4145324544645925, 1.416226609062057, 1.3686757539628065, 1.3963021810316414, 1.3295080392294472, 1.413876209948091, 1.3895909892824541, 1.419473598871462], [1.4527645268465443, 1.4826447252288502, 1.4254506857209015, 1.4201453258828076, 1.5561327664672613, 1.3896139933122358, 1.4093211449035519, 1.496694920695091, 1.5080125674525022, 1.4776551431702634], [1.6273693364025781, 1.5613122281634206, 1.6454573438972488, 1.5741174307843806, 1.6605585104955143, 1.5484879861149485, 1.5673643158482429, 1.602940012847651, 1.583455906458755, 1.6025335487371899], [1.8894807573583676, 1.7080057208270207, 1.8633500585485623, 1.7974722582784888, 1.8347187228173907, 1.7174347001477308, 1.8581357148871396, 1.929932788496548, 1.8084403552739736, 1.913959453942534], [2.2776321156547823, 2.1936042177364317, 2.2241365566054401, 2.3483636322993302, 2.3154926960962983, 2.2067045058831347, 2.2426850409475771, 2.1446587159580708, 2.2992147876063465, 2.2943319870938215], [3.7685336471769131, 4.3642248206791576, 4.1420738260722327, 3.1913847733566691, 3.16274898450681, 3.8163163270379021, 3.4308795689453064, 3.5367105688459781, 3.969659603845769, 3.4073620151958273], [11.059472488515201, 13.473029553247274, 19.291326753948525, 15.885738351988971, 16.899217668762873, 15.993607044250318, 12.602174595100042, 12.64226363202151, 14.496466797700567, 14.251389800630605], [40.67778578143124, 23.597337597218569, 27.599872865640666, 35.191150325252806, 27.086630055043276, 43.222847307391774, 25.432423502446227, 26.565062181981109, 22.777538269386849, 26.061386510100139]], 'Rp': [[0.9808300176523761, 0.98191012955331602, 0.9846447380668788, 0.98502372410143113, 0.98295436323656427, 0.98218222196692218, 0.98158559788405897, 0.98384206390239581, 0.98365853961110095, 0.98422252322658887], [0.98305770886688504, 0.98070818786031999, 0.98237072800530101, 0.98206139647059831, 0.98049188373631291, 0.98216731690336034, 0.9814417415253478, 0.98131137814915259, 0.98232864345704773, 0.98082516803012287], [0.9820606197511198, 0.9807351745160261, 0.98051949001280969, 0.98101659543957065, 0.97957670034473365, 0.98148427289695284, 0.98237543663511029, 0.98054936315594643, 0.98081102068623438, 0.98044887461040298], [0.97969381119965981, 0.97981830085026567, 0.97887161359914421, 0.97844051123524944, 0.97818134826056602, 0.97981148323928802, 0.97895143393769946, 0.97837373509892023, 0.98068194861727975, 0.97933890222115283], [0.97596914606319907, 0.97948998779897789, 0.97608484457282485, 0.97631491477655108, 0.97722559468427406, 0.97745619114463023, 0.97664134200129493, 0.97653440518293821, 0.97676845964285663, 0.9760570600875722], [0.97156149840243344, 0.97130590105423775, 0.97183373860842126, 0.96992716504553211, 0.97100065017491433, 0.97049381180634986, 0.97126367292558591, 0.97259156409279002, 0.97088110253196591, 0.97014609337518065], [0.95278667585694221, 0.94408340080594666, 0.94637016462172452, 0.96041168374829489, 0.95772863817233489, 0.95008710901536975, 0.95697256258891428, 0.95486074666490039, 0.94714480274787571, 0.95637229731612861], [0.85582341403166551, 0.83015757498009135, 0.76494459314321051, 0.80433937728497462, 0.79221780577170087, 0.79481080120454572, 0.84458468684503507, 0.83521337317818112, 0.82050034724166165, 0.81678073214726177], [0.67367981676225963, 0.7433971381896638, 0.70087233632151957, 0.68318666823004459, 0.69454459159521076, 0.66938293877487642, 0.73835592140083472, 0.71422274278175091, 0.74078332437265537, 0.73012959685238132]]} 
average_performances = {'R^2': [0.9663015763590048, 0.9634107960598536, 0.9620803499978814, 0.9585503888286014, 0.9540213730644822, 0.9424228095122235, 0.9063418356260794, 0.6266460698880085, 0.23956228685675604], 'MSE': [1.3338247075674379, 1.3959667760340486, 1.461843579968001, 1.5973596619749928, 1.8320930530577755, 2.2546824255881233, 3.6789894135662573, 14.659468668616592, 29.821203439589265], 'Rp': [0.9830853919201632, 0.98167641530044492, 0.98095775480489067, 0.97921630882592259, 0.97685419459551182, 0.97110051980174106, 0.95268180815384329, 0.81593727058283272, 0.70885550752811977]}

repeats=10 
fractions_unknown = [0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95] 
all_performances = {'R^2': [[0.9607798929114855, 0.9710272629142306, 0.9750606939641251, 0.9672150629247449, 0.965529590194902, 0.9641499516462126, 0.9632815412204784, 0.9708360780579849, 0.9698006738901898, 0.9684055872227426], [0.958783020353138, 0.9600937018201786, 0.9711834403123623, 0.9646057288699935, 0.9658883218986087, 0.9646170890032887, 0.9646037868340434, 0.9680218095641087, 0.9621463784607518, 0.966234030714299], [0.968220907778332, 0.963382424925033, 0.9675733709969558, 0.9638559578736655, 0.963471120594757, 0.9641918044362111, 0.9656355289841441, 0.9666580675473812, 0.9636819283324142, 0.9677779963243166], [0.96432045175121, 0.9633443743390868, 0.9619259384705858, 0.9614971727884671, 0.964528820649247, 0.9634693185935134, 0.9652524108655722, 0.9622239456226049, 0.9659040872785305, 0.9668480303403203], [0.9647041366166297, 0.9668953847011753, 0.9662440295906, 0.9673312217811363, 0.9627950232313067, 0.9624941576277093, 0.9655012231746964, 0.9663883488282061, 0.9671079372208565, 0.9620711327340062], [0.9669801146721941, 0.9605349942424394, 0.9633473546252095, 0.9604757775545533, 0.9606155774156504, 0.9633595014904399, 0.9621695532846865, 0.9634645901438151, 0.9624394185485761, 0.9605289183049577], [0.9608327877951591, 0.9594547997567079, 0.9583594659448513, 0.9615726121305787, 0.9616016015845456, 0.9600440306226663, 0.9617317731399933, 0.9599983974373109, 0.962257869451462, 0.9611810957867228], [0.9564144539704932, 0.9595308515885782, 0.958957133122521, 0.9582533540027679, 0.9581616921473787, 0.9588321908268644, 0.9593878521800903, 0.9590852260068806, 0.9574007813560488, 0.9593998663109279], [0.9567117071744511, 0.9563999156667284, 0.9551903282324833, 0.9555694779978903, 0.9565889919487213, 0.9559841591620458, 0.9572562712554429, 0.956051684117678, 0.9548308274355927, 0.9554840299491005], [0.9555719456091492, 0.9562565028187119, 0.9546247227762248, 0.9518694304019937, 0.9543604732125919, 0.9530417932124018, 0.9529946368706319, 0.9502398694871862, 0.9532551222347229, 0.9540070721314693], [0.9497182447692392, 0.9476294233671535, 0.9474571088688516, 0.9473156766713224, 0.9452039213422637, 0.9513290905060965, 0.9543599945890949, 0.9523191347425972, 0.9494928218577068, 0.9492799527218023], [0.9399959986808165, 0.9444398182395941, 0.9431316612802955, 0.9405073887465492, 0.9438968819291124, 0.9450876736014285, 0.9394374574558161, 0.9451960529071889, 0.9422560857474985, 0.9401280167641233], [0.9287249220459928, 0.9314507416329076, 0.9340618219281188, 0.9315396518691099, 0.9362969077757889, 0.9328864996829905, 0.9263505369676939, 0.9324569173536664, 0.9300960608093917, 0.9290000864913832], [0.9181537731183478, 0.9186640787529018, 0.9099141823338749, 0.9088622073409541, 0.9122256599092969, 0.9210754425703919, 0.9115904559494141, 0.9181114058908746, 0.9097023251820305, 0.9110740634874674], [0.8104133515636324, 0.8672236218036454, 0.858517312493944, 0.8117413197235543, 0.8604966017602202, 0.826928170055675, 0.7695828636001907, 0.8332203356953722, 0.8380762208335375, 0.8705942814755447], [0.6426762685886962, 0.6208739529913971, 0.6239918909767616, 0.6250215207381622, 0.7258254468047323, 0.5355763592541853, 0.655168943739147, 0.6736704012544106, 0.637964716354918, 0.7181238791161657], [0.43133889124167024, 0.45452840674560935, 0.4795852486469693, 0.5176213815788429, 0.5461386790344832, 0.46295223222354354, 0.5232155927431766, 0.5371515518942449, 0.4909807412911521, 0.37997903484056306], [0.3764939754057922, 0.35904471953490524, 0.26370223547256066, 0.013703651845309528, 0.2674811872253342, 0.220513016113406, 0.3237872491510495, 0.2866741540656138, 0.40531998885182885, 0.2711600238985731], [-1474.4391503338761, -1605.436715365241, -1529.1494451947392, -1535.6185056145814, -1532.2459246073408, -1655.6453978078657, -1586.4680356523002, -1451.8218156379273, -1465.8944705429644, -1505.763112758571]], 'MSE': [[1.4265218151159913, 1.1169104857429066, 1.2299914545050663, 1.2215984837111211, 1.0827960485121455, 1.4030625795543161, 1.2948758596814849, 1.2185063697914134, 1.2094372159714846, 1.2066613741914842], [1.3532913369654509, 1.3767451192516642, 1.2159299412967695, 1.3395149469839536, 1.3373456607495484, 1.3479583158037332, 1.4476464910538573, 1.307207709801653, 1.5434223707765653, 1.238181144444076], [1.3129058791080943, 1.3777445055047692, 1.2969347605401593, 1.4146850704595126, 1.3399063394497632, 1.4244593189954367, 1.3948795353882708, 1.317092623972355, 1.4646213504771111, 1.3536571115480875], [1.4014052604547234, 1.3637353672506221, 1.4738258610985695, 1.3775485810731458, 1.4223712496274949, 1.4014603109717978, 1.2809712776366984, 1.3617889815704118, 1.4015574155791841, 1.385801960582308], [1.3946533978672526, 1.4396574799511013, 1.3731205743145984, 1.3421064061444721, 1.4626710246060286, 1.4453565470808027, 1.4586922134369515, 1.3958644432259273, 1.4501492258134403, 1.4381394028977419], [1.3791414025606923, 1.5282873252267251, 1.4656681493862389, 1.4913535513941942, 1.5375502609509026, 1.4923293045156587, 1.4800363530063427, 1.4687222028615801, 1.5146642177015128, 1.5212463682335486], [1.5212153792562539, 1.5467850911434078, 1.6105275460407744, 1.5460464246960959, 1.5839625375974249, 1.5944265802665121, 1.4966763697135286, 1.5361069618907577, 1.5212684478682055, 1.5339905331331352], [1.6251216903436463, 1.5449333459208798, 1.5714218282690056, 1.5891372807568833, 1.5746046830728642, 1.6309696121429602, 1.5461396531387437, 1.5688599181958427, 1.6147199733356299, 1.63011790943587], [1.7497683084275484, 1.6914956292599357, 1.6758963832907352, 1.6656213008298097, 1.7171651833637918, 1.6604015034906547, 1.7161338613509487, 1.6854499196207176, 1.7465820295948289, 1.7158902442179045], [1.7853348949657128, 1.7008567899341629, 1.7289405318146964, 1.9554009959262144, 1.8035444799892026, 1.8734777806146252, 1.8688770773487917, 1.9088551995838507, 1.8108802700447448, 1.8421284725411542], [1.9593391931419046, 2.0531676571219095, 2.0281192281263785, 1.9742399113307398, 2.14149405214093, 1.9083743034133873, 1.8610728454238608, 1.8837496930054634, 1.9963318128905476, 1.99810055635224], [2.3655609398243129, 2.1541065072038799, 2.1242376897984925, 2.3080877544715874, 2.2571465693629063, 2.2368911391292965, 2.3248668038036659, 2.1873752925036629, 2.2218184941823202, 2.2685772224958338], [2.8742275884612449, 2.7535649620221272, 2.5239329174059391, 2.6682973586998973, 2.5790790037962892, 2.6524227340705036, 3.0055276225779837, 2.7207273140998853, 2.7003363332658168, 2.8645794175370858], [3.3121156039227375, 3.2635734783792274, 3.4274337201212166, 3.6700211738856425, 3.3990372421250132, 3.0707965577540253, 3.5606322963208483, 3.1652274324816103, 3.6145851507035989, 3.5565887904851299], [7.6039021091476755, 5.2590515583348596, 5.5285460929183197, 7.2867151313709657, 5.3027388107316611, 6.9931290602916425, 9.044230982389184, 6.6406875560913177, 6.5016200314645838, 4.9906921677256326], [14.176568526167319, 14.700772063343193, 14.46959846271398, 14.677467597401193, 10.773391423303778, 18.321932920591259, 13.406746672441495, 13.100763547623405, 14.135554476976957, 10.918525356734516], [22.049461352086567, 21.024709634648083, 20.273079959083962, 18.959871011261654, 17.8133375950481, 21.086986825048751, 18.922448278219541, 17.889207827149946, 20.100888739729754, 24.539444413615282], [24.917386299268291, 25.365431767376592, 28.681102460709496, 38.214396096748693, 29.055468582813916, 31.18669137630981, 26.560906601069128, 27.972433274860496, 23.59834818984282, 28.244272446703096], [57379.536067098379, 62934.604411053842, 59631.300600612929, 60039.754750939937, 60259.875816399828, 65599.200157667947, 62828.979063864739, 57455.424774948115, 58025.283378618769, 58788.875565681439]], 'Rp': [[0.9803040551635479, 0.9855562469061756, 0.98751527872724376, 0.98361032178418961, 0.98269185410830273, 0.98209265265308587, 0.98167394421201504, 0.98532402498874017, 0.98479309800799952, 0.98411879466024876], [0.97936154819109189, 0.98000839071606127, 0.98555466852474027, 0.98219537799541401, 0.9828701381004008, 0.98216436654363137, 0.98216996007246815, 0.98390366083429093, 0.98092935797064995, 0.98331016803709215], [0.98401662148203206, 0.98160271501039231, 0.98365461273484533, 0.98183175602459338, 0.98157736847009458, 0.9819342101421209, 0.98269646306728597, 0.98328141140756464, 0.98179988175508659, 0.98388873560164081], [0.98203149617787011, 0.98163998630819593, 0.98082707354146137, 0.98065101952195755, 0.9821664116998402, 0.98189259369005577, 0.98251466872928017, 0.98095931331003661, 0.9828278387697349, 0.98329170117133402], [0.98240012738703553, 0.98339814021351413, 0.98308774723419856, 0.98356730102423195, 0.98137019276629667, 0.98108698510024483, 0.9827554325915564, 0.98306538360636064, 0.98343149985350609, 0.98105806951583985], [0.9834380188498083, 0.98013176527728574, 0.98170274981451633, 0.98027630007593147, 0.98021134467922111, 0.98163751864523507, 0.9809477452923584, 0.98171340707770116, 0.98110728336036379, 0.98013061564321791], [0.98033845106761752, 0.97957053908562253, 0.97899054444960931, 0.98065938385565499, 0.98071681525529031, 0.97993165089260681, 0.98070613485605529, 0.97989456069858849, 0.98120331176248576, 0.9804831937072146], [0.97803384097502466, 0.97964649916120161, 0.97948214432945524, 0.97913048821707649, 0.97888168035124845, 0.97923373149738058, 0.97952202437417857, 0.97934247744467351, 0.97855919579273931, 0.97953328523752781], [0.97815822291428189, 0.97821751641086596, 0.97741916597145795, 0.97763492668407903, 0.97817223043780432, 0.97778546567547375, 0.97855527700141964, 0.97782192238881516, 0.97727453305078038, 0.9776335519873105], [0.97755128253912971, 0.97797659944817772, 0.97706370306864798, 0.9758431098075353, 0.97694245879944397, 0.97643398982131369, 0.97666363098379472, 0.9749760041488863, 0.97673918926302739, 0.97701058242388683], [0.97462621954757045, 0.97355890628793751, 0.97384619739672817, 0.97339214757880654, 0.97232109547010248, 0.97541838925701552, 0.97699736681312499, 0.9759087285544904, 0.97460197173813556, 0.9748680659792609], [0.96986011110916537, 0.97196940819550748, 0.97136712033730077, 0.96986773639783053, 0.97178441714324604, 0.97237498117818288, 0.96956190357570138, 0.97230007098769733, 0.97092334539405623, 0.96988177815918575], [0.96401167775138186, 0.96536635546788097, 0.96689777343126448, 0.9661327840558771, 0.96786777182683026, 0.9664105153714635, 0.96268641873051186, 0.96623814685988874, 0.96466718846616173, 0.96440517740077025], [0.95858738660856868, 0.95938603131250189, 0.95474020030676254, 0.95443469228997324, 0.95564824622086297, 0.96014670693381321, 0.95502635440456574, 0.95841174703814758, 0.95429814664553969, 0.95573136783293755], [0.90301942834367144, 0.93361473809222117, 0.93014908872659019, 0.90592629625834931, 0.92936740388450367, 0.91089609182958908, 0.88300391157171165, 0.91377740052404111, 0.91838341788498723, 0.9345848079077822], [0.82871796437788103, 0.80611983906883733, 0.81670759380710711, 0.811717889548212, 0.8621711545696521, 0.78610268609953249, 0.82872531588108045, 0.8339124467544019, 0.81785952866175304, 0.85469446659460013], [0.73315232971191358, 0.74956801813911678, 0.75927164499298005, 0.76882640571707583, 0.7743506975822273, 0.7606753341276481, 0.76758905782322739, 0.77858011483255207, 0.75864230035222946, 0.72392387479854758], [0.71930871207524516, 0.73608033976843845, 0.72434534585018517, 0.67195509532640385, 0.69514659247078403, 0.66425677781148462, 0.71622822481126081, 0.72560571066655899, 0.74530208198515702, 0.71357777738918571], [-0.092889293377691584, -0.044925867814768775, 0.038164496416365629, 0.015311988053378524, -0.012530071632152986, -0.0098182201600854804, 0.097551084339485478, 0.099165408145080985, 0.03373752248686477, -0.032157990434524421]]} 
average_performances = {'R^2': [0.9676086334947096, 0.9646177307830772, 0.965444910779321, 0.9639314550699138, 0.9651532595506322, 0.9623915800282521, 0.9607034433649997, 0.9585423401512552, 0.9560067392940136, 0.9536221568755083, 0.9494105369436129, 0.9424077035352425, 0.9312864146557043, 0.9139373594535553, 0.8346794079005317, 0.6458893379818577, 0.48234917602402555, 0.2787880201564373, -1534.2482573515408], 'MSE': [1.2410361686777414, 1.350724303712727, 1.3696886495443561, 1.3870466265844954, 1.4200410715338314, 1.4878999135837396, 1.5491005871606096, 1.5896025894612325, 1.7024404363446877, 1.8278296492763157, 1.9803989252947365, 2.2448668412775961, 2.7342695251936773, 3.4040011446179053, 6.5151313500465831, 13.86813210472971, 20.265943563589165, 28.379643709570235, 60294.283458688602], 'Rp': [0.98376802712115496, 0.9822467636985841, 0.98262837756956567, 0.9818802102919767, 0.98252208792927842, 0.98112967487156388, 0.98024945856307466, 0.97913653673805057, 0.97786728125222877, 0.97672005503038439, 0.97455390886231696, 0.97098908724778732, 0.96546838093620302, 0.95664108795936742, 0.91627225850234473, 0.82467288853630583, 0.7574579778077517, 0.71118066581547035, 0.009160905602195216]}
'''


# Plot the MSE, R^2 and Rp
for metric in metrics:
    plt.figure()
    x = fractions_unknown
    y = average_performances[metric]
    plt.plot(x,y)
    plt.xlabel("Fraction missing")
    plt.ylabel(metric)