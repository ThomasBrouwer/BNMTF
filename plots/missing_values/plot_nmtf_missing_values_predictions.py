"""
Plot the performances of the many different NMTF algorithms in a single graph,
as we vary the fraction of missing values

We plot the average performance across all 10 attempts for different fractions:
[0.1, 0.2, ..., 0.9].

We use a dataset of I=100, J=80, K=10, with unit mean priors and zero mean unit
variance noise.

We have the following methods:
- VB NMTF
- Gibbs NMTF
- ICM NMTF
- Non-probabilistic NMTF

"""

import matplotlib.pyplot as plt, numpy
metrics = ['R^2']#['MSE','R^2','Rp']

MSE_max = 95

fractions_unknown = [0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95] #[ 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9 ]

# VB NMF
#vb_all_performances = {'R^2': [[0.9950277311670301, 0.9950362540064918, 0.9977338762826371, 0.9946418108005373, 0.9984314418887056, 0.9979171620315069, 0.9982375822670195, 0.9981472503628788, 0.9976181499418831, 0.9982023621563685], [0.994796648525581, 0.9977153753127386, 0.998095838501728, 0.9978227916289657, 0.9982815606110297, 0.9983027985302119, 0.9955787303766429, 0.9949469934228514, 0.9978972809253873, 0.9952479717554424], [0.9977480926165051, 0.9980685063734909, 0.9957328274572746, 0.9977347232024003, 0.9950283364083812, 0.9954314156259906, 0.9951030139929761, 0.9978582793458053, 0.9954916017454035, 0.9953709637017584], [0.9977319322135799, 0.997687088737984, 0.994946942179349, 0.9949536855384639, 0.9950621464173323, 0.9978791402297771, 0.9979310192347216, 0.9978046639030107, 0.9978505415336579, 0.995849608377376], [0.9977155944222503, 0.9952479671434111, 0.9689641168223063, 0.995260359919225, 0.995250983933575, 0.9744961487049554, 0.9953063281467225, 0.9950617811119985, 0.9707114581654543, 0.9732861326889626], [0.9735061002342034, 0.9728466153373351, 0.9947599190009041, 0.9948960324500463, 0.9949461228865316, 0.994865632554931, 0.9948504782894455, 0.974797101037195, 0.9717573278727932, 0.9696867239821485], [0.9663439526247147, 0.9685369361042374, 0.9712678819552871, 0.9940464888515127, 0.9699058477359624, 0.9712432932901175, 0.9687191998424838, 0.9713571770401356, 0.9944948321180072, 0.9709790071625185], [0.9680331784831949, 0.9638252691829845, 0.9567874670120828, 0.9603646899881294, 0.9666936166921205, 0.9460833406184549, 0.9554628031118125, 0.9649361961029994, 0.9577191791733791, 0.9616833474402544], [0.8978838535283761, 0.9133593258182544, 0.9032214670066678, 0.9081531157581764, 0.9318886911810746, 0.9052656310769353, 0.9083605976522274, 0.9083860602114315, 0.9019612406798678, 0.8508822932819876]], 'MSE': [[2.5690679020125105, 2.6230751690901486, 1.1875172610544722, 2.5589152559511326, 1.1180264569052294, 1.1806693736737592, 1.1501341539616372, 1.1304715320116827, 1.1606818630980338, 1.0423986988231237], [2.7028553044362815, 1.2952389738583379, 1.1922107904845272, 1.1928545946117648, 1.2338003167777349, 1.1162418385839967, 2.6283360550034076, 2.8090357462404563, 1.1929282632957234, 2.4819678904821041], [1.206773931576069, 1.2576820539879119, 2.4560848649633007, 1.2431073549114398, 2.6836572952414479, 2.6421439967270337, 2.8157250241168597, 1.2085902656108276, 2.4297302861812717, 2.7345722356687618], [1.1750966372504097, 1.326909891614934, 2.6671327349641132, 2.8137891351688298, 2.7504832018970609, 1.267010892794691, 1.2050482263152056, 1.2547299207237541, 1.2555319752255851, 2.45469211521015], [1.3125799670217229, 2.9280965338523437, 17.871096625690203, 2.7109506834144077, 2.6740406632748051, 14.088530610418518, 2.6397519531013556, 2.8787168876784084, 15.889736336652422, 15.525039507066241], [15.935804011504203, 15.397322216717646, 3.0700822539145065, 3.0354431163934068, 2.8612933732674413, 3.1151683931513632, 2.9274513615773663, 14.295230867400248, 15.725075146373452, 16.571422575544709], [19.267423426482345, 17.311021683613312, 16.452431105066676, 3.4970347264040083, 16.982186660187228, 16.65709177072673, 17.941515232117851, 16.24443402638974, 3.264741151910485, 16.457635760568635], [18.38319881379693, 21.672455898217198, 25.241619174400661, 22.191529441855756, 19.394644897563001, 30.274956985107384, 25.210283046297203, 19.997192203359688, 23.967108976951032, 22.521792474824839], [57.999642364109533, 49.628370346413817, 56.184034523132212, 52.810738994732148, 38.67731867855111, 53.485198888748151, 52.351827681455454, 52.375659920923709, 55.638334994140322, 83.975284945245662]], 'Rp': [[0.99761749026084123, 0.99752261197260328, 0.99886918284591508, 0.99731846172815442, 0.99921631217022377, 0.99895817837649048, 0.9991290606699833, 0.99907838488622802, 0.99880910010583546, 0.99910190856425674], [0.99740076464038108, 0.99885777618563687, 0.99904945305637205, 0.9989115074913697, 0.99914133141295558, 0.99915189712806773, 0.99778776511168032, 0.99748310011231534, 0.99895203564433788, 0.99762370046939242], [0.99887362711069705, 0.99903791776253348, 0.99786523089933277, 0.99886851169004043, 0.99751301048096686, 0.9977163912005319, 0.99755257373710504, 0.99892869048730681, 0.997743390561459, 0.99768380336783768], [0.99886775014717044, 0.99884537089121361, 0.99748405742546542, 0.99747618721438225, 0.997531595757987, 0.99894240887195651, 0.99896561848911569, 0.99890260985772705, 0.99892548487710497, 0.99793131046923778], [0.99885992882656371, 0.99762822599135359, 0.98440474644165676, 0.99763552999821836, 0.99762266628386953, 0.98722742295368149, 0.99765154026069192, 0.99754002649692564, 0.98535720622923084, 0.98656132967826082], [0.98666423349660159, 0.98636925524194763, 0.99737819562566143, 0.99744602635934176, 0.99746994031682679, 0.9974463063612653, 0.99742526574047186, 0.98732219723463632, 0.98578189587658605, 0.98474359185872384], [0.9831967783043416, 0.98414690970813468, 0.98570406525321341, 0.99701903782135781, 0.98486074552004454, 0.98553177985683516, 0.98425224576241144, 0.9857552545952557, 0.99726941096560517, 0.98545250822422581], [0.9838949235668043, 0.98175632611174024, 0.97820289675532945, 0.98029398758884145, 0.98323405786295071, 0.9741814795324456, 0.9780612374039469, 0.98232229041777752, 0.97901377075938256, 0.98067533893216707], [0.94957860676727501, 0.9570512150575875, 0.95055391393911348, 0.95374057059794737, 0.96863208622115105, 0.95386511302885924, 0.95359173477112102, 0.95337309590377739, 0.95201684470361014, 0.93503054821936826]]} 
#vb_average_performances = {'R^2': [0.9970993620905059, 0.9968685989590579, 0.9963567760469985, 0.9967696768365254, 0.986130087105886, 0.9836912053645535, 0.9746894616724978, 0.9601589087805413, 0.9029362276194999], 'MSE': [1.572095766658173, 1.7845469773774334, 2.0678067308984924, 1.8170424731164734, 7.8518539768170426, 9.2934293315844343, 14.407551554346702, 22.885478191237368, 55.312641133745217], 'Rp': [0.99856206915805301, 0.99843593312525081, 0.99817831472978114, 0.99838723940013607, 0.99304886231604539, 0.99180469081120626, 0.98731887360114268, 0.98016363089313852, 0.9527433729209811]}
vb_all_performances = {'R^2': [[0.9977006683930278, 0.9966943703073206, 0.9986120987495751, 0.9964720411691669, 0.9919355448723148, 0.9947525704423978, 0.9954892869737146, 0.997628681823473, 0.9976724250222543, 0.9981235779093628], [0.9678988210348753, 0.9980151930230418, 0.9980433300439043, 0.9981844931322473, 0.997883550316856, 0.9983325978037331, 0.9969740666994525, 0.9980464205361672, 0.9982280613574255, 0.9964186133053866], [0.9959777672580927, 0.9956158994785365, 0.9954332522729695, 0.9980231065868871, 0.9953488235934648, 0.9958865332603605, 0.9954995365952796, 0.982722306514392, 0.9979051941780704, 0.9979022824551776], [0.997680773027442, 0.9976796132635622, 0.9950305463181409, 0.9978660425979449, 0.9955241250332677, 0.9954015088476484, 0.9980232191368472, 0.9963687642268484, 0.995373906350267, 0.9975841092222684], [0.9957437281070717, 0.9762964000313374, 0.9949631425482995, 0.9949897007399612, 0.9960650283071762, 0.9955559119159711, 0.9961419906221786, 0.995665341601579, 0.9754646796994492, 0.9948015916285938], [0.9953353367565079, 0.997891868326322, 0.9958646504973667, 0.9978672682167422, 0.9977478919982001, 0.9725179074461503, 0.9978329942720663, 0.995327172423397, 0.995642796919082, 0.9956866057669127], [0.9958363160624261, 0.9951028837167735, 0.997715972611882, 0.9961531471381281, 0.9978894484634087, 0.9955333912584289, 0.9949011713531943, 0.9956039900086885, 0.995326288579562, 0.9955070135265345], [0.9976657209459519, 0.9743490128519192, 0.9977488999776981, 0.9949435573688411, 0.9976847457449154, 0.9977244762965239, 0.9959289127963934, 0.9740793423906937, 0.9955403875888291, 0.994960902125144], [0.9953280810500336, 0.9976725509311054, 0.9765434379423625, 0.9953695417384406, 0.9954964154632383, 0.9977763074400111, 0.9744681019214216, 0.9950397307282717, 0.9977551856253037, 0.9950214152300616], [0.9744906634087062, 0.9952824515645314, 0.9754335901211766, 0.9951632944261242, 0.9942078065665281, 0.9733497758553119, 0.9716489286920924, 0.9951191517134539, 0.9712746132098727, 0.9952481590209418], [0.9742263145920499, 0.9953258544796155, 0.997454141217115, 0.9700870764916829, 0.9720988867296809, 0.9949783816861746, 0.9975600116856875, 0.974399292513021, 0.9946465895842856, 0.9711141463036762], [0.9954311256335348, 0.9949784827122841, 0.9706835058985607, 0.9950223391760827, 0.9951800396400141, 0.9974235196178383, 0.9717458446633533, 0.9929951620939532, 0.9719793832764467, 0.9751005367492004], [0.9731955289473813, 0.9722453455145845, 0.9943428559102748, 0.9698829352074525, 0.994000406194376, 0.9697960574362029, 0.9741961905697181, 0.9713348939403086, 0.9711896099812724, 0.9696133108718682], [0.9617146420936931, 0.9671576779360624, 0.9943392886655344, 0.9616966752134279, 0.9940166488997917, 0.969349368254668, 0.9716616103158128, 0.9730878574553301, 0.969988942559874, 0.9701542139097535], [0.9934821279570089, 0.9483232569402642, 0.9632233005025453, 0.9696926201374039, 0.9938688110802893, 0.967174769117133, 0.9688053800543105, 0.8041395099390125, 0.9625465573854802, 0.9685747595825607], [0.958756628803076, 0.9561173941497608, 0.9613323944333442, 0.9625183416557881, 0.9648318300553911, 0.9633022601666763, 0.9557170893687541, 0.9460018889000406, 0.9611745144274751, 0.9575706442268681], [0.9496467607543836, 0.9386653871912044, 0.9569365538418357, 0.9524568959454887, 0.9134046969869835, 0.9540801402506179, 0.9609263587705696, 0.955023083136412, 0.956678865884998, 0.9543328512672947], [0.8829412304720841, 0.8999653094189439, 0.9081633265973288, 0.9248214804994964, 0.8928759011566261, 0.9003352525367259, 0.8995973913603058, 0.901589095117178, 0.8971558112551657, 0.8969989216533258], [0.8395426030135819, 0.8470369796922508, 0.8513427202237499, 0.8532117889321122, 0.8549143222464521, 0.8778127260754379, 0.8299020508178856, 0.8394295432374045, 0.8544393780812345, 0.8483426108637303]], 'MSE': [[1.1735182635852033, 2.2563347799001892, 1.1970670794057774, 2.5015650982131641, 3.9683843989492544, 3.8032203029899536, 2.0861617362458129, 1.1961720705264758, 1.1441385560143613, 1.1512018060845512], [17.434551811176007, 1.0938951100733878, 1.1364574669119132, 1.1430419176305993, 1.2035038064220023, 1.1083807979758751, 2.2044812190527607, 1.1915513618146385, 1.1081693088745197, 2.1423911955787185], [2.2010522037884743, 2.6299690170587882, 2.5330376793699143, 1.1392606172833291, 2.4603930992872756, 2.3202503687819664, 2.225414089150819, 11.014627055447201, 1.1542249287706896, 1.1108140186609705], [1.196722009869192, 1.2411570544873998, 2.4719208479310093, 1.2438160020538758, 3.0022692325648284, 2.7658096549173581, 1.2000652369133975, 2.2144053951432259, 2.3495894800343873, 1.197843436977164], [2.3547966352658531, 14.013338254218249, 2.4841196306270348, 2.6662769699964861, 2.4730853850784063, 2.5381364521727079, 2.318841700295585, 2.3354915255979329, 14.287286387917103, 2.9976402433343359], [2.7164774317485905, 1.2040854793636369, 2.4147700597269468, 1.2625345530205163, 1.1946735149492684, 15.952051508666885, 1.2240568350067476, 2.5696365479709335, 2.600229928596939, 2.5040991576505198], [2.4042840925426563, 2.5853208740838536, 1.2896718348532761, 2.207090772269392, 1.1795104395844012, 2.8947757737186897, 2.6741514501579831, 2.4347234782391549, 2.6670479714448043, 2.5206058317437807], [1.2877207644795374, 13.952474093967346, 1.2617666562057273, 2.6247824841301997, 1.3085445130583688, 1.2497321242779882, 2.5141210494214148, 14.454758804894205, 2.6054285305073575, 2.8993452024834716], [2.653666710959008, 1.2874651565240423, 14.550217360437356, 2.5508806633921868, 2.601987523411001, 1.3149249379436172, 13.740352782808595, 2.6244845885817467, 1.4073423101206286, 2.7969604955508065], [15.157213141707794, 2.6779072759448956, 15.108471576612713, 2.7907862413345761, 3.0476835047965132, 14.737345124853315, 15.980711078235402, 2.8161610605123677, 16.517728466667418, 2.8930170834001352], [14.298340602700584, 2.8552006862612482, 1.4438510665526174, 16.248810525013347, 15.728363520892536, 2.8644073220241819, 1.3711300561108495, 15.047530606826539, 3.1340891610732156, 16.68404713537868], [2.6995216666171693, 2.8300268269348581, 17.043319241461827, 2.9389827547492406, 2.8248143863322071, 1.3960528971068411, 15.647412216328137, 4.0350306203704118, 15.79103695111111, 15.100423744493337], [14.873123157027218, 16.435834992314035, 3.1238602494863574, 16.649042310584456, 3.3738940996839251, 16.347618631109953, 14.893979385743153, 16.676032247960372, 16.735166679023362, 17.988558453364199], [21.776289220623479, 19.124540271154569, 3.2403401792036166, 22.114946856905998, 3.4305181499738553, 17.383747162274997, 16.323073955677195, 15.081694896082922, 17.53850419512732, 17.203228546648774], [3.6668884271994413, 28.639933775692551, 20.898964820133827, 17.007142503923667, 3.4019337128868883, 19.523891605865177, 17.891140259203585, 116.09730415817856, 22.003315008779289, 17.820591285540008], [23.553483082325059, 24.889940618928858, 21.96707656977425, 21.306003352468839, 19.875032373308251, 21.015445390761688, 25.338436510126122, 31.729706070198617, 22.12762636080198, 23.758918405090569], [28.577005631009857, 35.755268290714248, 25.011676394868914, 27.159210465035805, 51.91277456006511, 25.894063256029995, 22.756570721042191, 25.77096289326709, 24.579637158435865, 25.800553849525116], [68.142163461996873, 57.547054718428519, 52.817858787854583, 43.196888253896518, 61.458008814491755, 57.325913166683655, 56.32872017328674, 57.001080278185775, 58.67974535404386, 59.126240160133158], [92.658729365414217, 85.989136098740701, 86.029536233511465, 84.582682982565146, 83.02127151815057, 70.614950977240042, 95.536777236140978, 91.375286589088176, 83.535222409316248, 87.891396480432348]], 'Rp': [[0.99886096927738621, 0.99835259870232396, 0.99930689870811928, 0.99823563351338895, 0.99611180382415898, 0.99739395375724049, 0.99774342050345577, 0.99881893413272804, 0.99883590091058316, 0.99907047510516467], [0.9839531372106447, 0.99900933269451475, 0.99902137700712224, 0.9990939794874828, 0.99894248287360554, 0.99916920869826165, 0.99849690613952913, 0.99903090681614781, 0.99912572611112094, 0.99820949843086293], [0.99799099392294432, 0.99780559989688677, 0.99773541751250172, 0.99901350374410736, 0.99767727826743524, 0.9979444352319996, 0.99774920854932014, 0.99133556616625917, 0.99895245297805779, 0.99895092672195052], [0.99884118694781576, 0.99884295051533745, 0.99751267047810677, 0.99893535922424581, 0.99776619119586751, 0.99770108223120224, 0.99901278293111528, 0.99818569478893138, 0.99769884761211813, 0.99879389877604052], [0.99787360211566156, 0.98810353552480867, 0.99748662707443803, 0.99749633785573566, 0.99803183756014235, 0.99777622318656833, 0.99807831294692972, 0.99783040444988358, 0.98765797117035803, 0.997411604063692], [0.9976662026348222, 0.99894614378638269, 0.99793174632174297, 0.99893361155157523, 0.99887397900652453, 0.98616461271402867, 0.99891646723926353, 0.99766561191825309, 0.99782751299907446, 0.99784510815782457], [0.99791653963701199, 0.9975579888087277, 0.99885849500687329, 0.99807555287008687, 0.9989457867403233, 0.99777253153810164, 0.99744952319745506, 0.99780212509436783, 0.99766606994952589, 0.99775261441240637], [0.99883329915833174, 0.98709596190553928, 0.99887382741594644, 0.99747108422194541, 0.99884897626475355, 0.99886228235521368, 0.99796252132967045, 0.98698667944765373, 0.99777193565548561, 0.99748017770552999], [0.99766178258915672, 0.9988380992860032, 0.98830756654964413, 0.99768509429284269, 0.99774708597531536, 0.99888770672389049, 0.98715872362634538, 0.99753197460298271, 0.99887838600412748, 0.99751683219579501], [0.98718593616341255, 0.997639845217966, 0.98764243239489147, 0.99758203923085365, 0.99709982723123258, 0.98662789418725294, 0.98573005969881988, 0.99755947805812595, 0.98555803586049584, 0.99762529174661096], [0.98703520328757788, 0.99766397518297323, 0.99873248164701423, 0.98498258541277894, 0.98596795148173089, 0.9974877665710119, 0.99878023644186664, 0.98713035865113008, 0.99732784455437751, 0.98583984532004931], [0.99771312449054794, 0.99748817519223631, 0.98537397468451349, 0.99750899768536838, 0.9975905435461534, 0.99871182882024467, 0.98586017878238885, 0.99649413799148456, 0.98589908999400278, 0.98749401940240189], [0.98650852739070982, 0.98607677729498922, 0.99716920284738231, 0.98486709068660228, 0.9970051201300153, 0.9848000963721546, 0.98701627877996823, 0.98556769752232587, 0.98559962642354704, 0.98471337517663649], [0.98080685600153772, 0.98369247199056964, 0.99717899485784478, 0.98086151554887369, 0.99700971531301785, 0.98463389969017101, 0.98576334235480689, 0.9864630885332899, 0.98493901833732966, 0.98503853547679465], [0.99674403009248247, 0.97460407298331775, 0.98162915420550301, 0.9847517253400675, 0.99693267056609292, 0.98351231279228202, 0.98432580846816919, 0.89957541194629764, 0.98112431499067843, 0.98434159408777766], [0.97921071955610139, 0.97836645300842284, 0.98071754126854671, 0.98116664259940956, 0.98234759882382905, 0.98156584882759956, 0.9779357780201503, 0.97310375719719089, 0.98057595238481765, 0.97882071187835118], [0.97470556943777642, 0.97042935906765104, 0.97830608367331895, 0.97598712257060471, 0.9559193515475215, 0.97747472977143002, 0.98029801804972927, 0.97741234529254295, 0.97814556246059192, 0.97703389415252007], [0.93981558771652596, 0.94899845868304988, 0.95325235369331474, 0.96282367536427493, 0.9456907833678021, 0.94946080402623267, 0.94941988030989488, 0.94984093019206162, 0.94821033813496236, 0.94740621179088313], [0.91778205124195633, 0.9250343362281539, 0.92318251211918134, 0.9282329239703111, 0.93330460058342091, 0.93811117216560425, 0.91796551018354067, 0.92236857144276485, 0.92659494096600292, 0.92155547674588711]]} 
vb_average_performances = {'R^2': [0.9965081265662608, 0.9948025147253091, 0.995031470219323, 0.9966532608024238, 0.9915687515201619, 0.9941714492622747, 0.9959569622719027, 0.9920625958086908, 0.9920470768070251, 0.984121843457874, 0.984189069528299, 0.9860539939461267, 0.9759797134573438, 0.9733166925303948, 0.9539831092696007, 0.9587322986187173, 0.9492151594029787, 0.9004443720067179, 0.8495974723183839], 'MSE': [2.0477764091914743, 2.976642399551042, 2.8789043077599428, 1.8883598350891837, 4.84690131845037, 3.3642615016700987, 2.2857182518637993, 4.4158674223425622, 4.5528282529728985, 9.1727024554065135, 8.9675770682833793, 8.0306621305505139, 13.709711020629703, 15.321688343367274, 26.695110555740296, 23.556166873378423, 29.321772321999418, 57.162367316900145, 86.123498989059982], 'Rp': [0.99827305884345496, 0.99740525554692927, 0.99751553829914597, 0.99832906647007813, 0.99577464559482176, 0.99707709963294922, 0.99797972272548796, 0.9960186745460069, 0.99602132518461028, 0.99202508397896616, 0.99209482485505107, 0.99301340705893415, 0.98793237926243305, 0.98663874381042349, 0.97675410954726671, 0.97938110035644177, 0.9745712036023686, 0.94949190232790026, 0.92541320956468243]}

# Gibbs NMF
#gibbs_all_performances = {'R^2': [[0.9980265537770171, 0.9980148846868151, 0.9979423798713575, 0.9979373981717664, 0.9982096738709807, 0.9978774239249413, 0.9977133599497527, 0.9977521642156745, 0.9980558651387604, 0.9983298715163728], [0.9977483682792698, 0.9976555013899399, 0.9980322320380159, 0.9981103180464137, 0.9980197107436324, 0.9973853555522758, 0.9977645728204921, 0.9983965636152167, 0.9979060281735868, 0.998036765235189], [0.9978276360078263, 0.9976333911726203, 0.9979730339006768, 0.9975854211943138, 0.9979282747815224, 0.9981180717149507, 0.9980300385199864, 0.9978229229717182, 0.997975959446187, 0.997839596335278], [0.9979251759407977, 0.9978809560634602, 0.9978361389981409, 0.9977949529914594, 0.9979445703908161, 0.9976585316548542, 0.997838425619466, 0.9978969870383029, 0.9978578805673619, 0.9980273357440586], [0.9978382046344352, 0.9977568477355244, 0.9976596486344239, 0.9977514281862052, 0.9975346605507922, 0.997639622687077, 0.9977375901718548, 0.9975977668490495, 0.9974872188278787, 0.9976117398822806], [0.9974738769995448, 0.9974864151391206, 0.9974510340021282, 0.9973845984234755, 0.9975726611036115, 0.9973986175514632, 0.997203172762798, 0.9975699048386895, 0.9975487227231692, 0.9976515151240554], [0.9970349243842102, 0.9970611328023047, 0.9970065037181833, 0.9969446914859835, 0.9832214485762876, 0.9969582612108989, 0.9967332128857133, 0.9970011574759813, 0.9970176027097376, 0.997053693316746], [0.9857597330418775, 0.9954518068345874, 0.9954132720355684, 0.9957322195055438, 0.9954949985661633, 0.9957682655503756, 0.9954780616220206, 0.9956293741291482, 0.9940018713989031, 0.9932218730979444], [0.9770071892765756, 0.9148787376226705, 0.9537886212222555, 0.9723788657818548, 0.9640066607462843, 0.9349768213114001, 0.978819132739358, 0.9573119797070576, 0.9793353421809781, 0.9592845395399638]], 'MSE': [[1.1524378666513504, 1.18927023184235, 1.1313268051893266, 1.1573648965093317, 1.3039252295712016, 1.1177815148859978, 1.2353098392602744, 1.2086043403252438, 1.0617161578890018, 1.0707315082842961], [1.2686868930941149, 1.2714358519884974, 1.2082195366876793, 1.2079142521175448, 1.2336724546248976, 1.1968630571551704, 1.3109965753012667, 1.1193874329456672, 1.1269428520454894, 1.1364905946565353], [1.2282521107762503, 1.2451939541913188, 1.2101984056528943, 1.229305514753694, 1.1688543351974383, 1.1984996963293773, 1.1707526144143898, 1.2670125830519754, 1.2116939905747837, 1.2527507018590658], [1.2420887009745973, 1.2723115182581266, 1.289580821594827, 1.2827917427314079, 1.272319149727805, 1.2319986164934158, 1.2319316780483456, 1.2595579967557722, 1.2596445738096771, 1.2359831600586733], [1.2977203579650238, 1.3055573318363849, 1.3363550372569668, 1.338665657177029, 1.3295718304331339, 1.3607514052004632, 1.3396787380932444, 1.3178314209722926, 1.3328354786594898, 1.3153882433503055], [1.4526450864346947, 1.4647320881828383, 1.4883283575162773, 1.4638165825409077, 1.4357788557705791, 1.4710085415663618, 1.4650609659729221, 1.4956147259092536, 1.5032578708076763, 1.3977807923960186], [1.7740954283009094, 1.7329207266692876, 1.7220832251611, 1.643965769231807, 9.6534128380510484, 1.7412834520216971, 1.933283796962397, 1.6198509744130531, 1.6683699208923892, 1.674626162728118], [8.1191787535525854, 2.5354030649001391, 2.6184268305486529, 2.4442387143471418, 2.5205194333692402, 2.4555759320360457, 2.6370491852353597, 2.5274586518524105, 3.3914616441386602, 3.9711234464481286], [12.999857016211829, 47.177759853738195, 26.694809157679362, 15.602478919141165, 20.615554175324821, 37.524487630008743, 12.031029996398489, 24.882439472246986, 11.852775710279857, 23.733190667372575]], 'Rp': [[0.99901680410628968, 0.99900824597575166, 0.99897404252340416, 0.99896869533857924, 0.99910831931159838, 0.99894379491293706, 0.99886740485573966, 0.99887818528300765, 0.99903071285124867, 0.99916600483199114], [0.99887398648674497, 0.99882738299274376, 0.99901931908812192, 0.99905564261893121, 0.99900948800666045, 0.99869222001418301, 0.99888443722092701, 0.99919830192410508, 0.99895930375940489, 0.99901876243346399], [0.99891520399399814, 0.99881820481371764, 0.99898676244419227, 0.9987931024239578, 0.99896483051972618, 0.99905865135929883, 0.99901464447284838, 0.99891138627182419, 0.99899203930524028, 0.998922733245445], [0.99896390369982102, 0.99894234828156292, 0.99891807066052141, 0.99889715121069877, 0.99897223642930744, 0.99883123643027816, 0.99892100920354998, 0.99894810209230378, 0.99893074016810657, 0.99901319660941335], [0.9989193813573185, 0.99887823805101583, 0.99882961388145863, 0.9988759518844903, 0.99876942641220423, 0.99882007179128696, 0.99886907345448905, 0.99879877070269885, 0.99874371145877516, 0.99880665135639712], [0.99873995820150296, 0.99874320501910263, 0.9987257000935037, 0.99869167757184907, 0.99878631338077895, 0.998700078850285, 0.99860066368461398, 0.99878740269635591, 0.99877448993037188, 0.99882508512692392], [0.99851773726275306, 0.99853061580821401, 0.99850431297236364, 0.99847502916745234, 0.99191155215720883, 0.99848062557894024, 0.99836637388761995, 0.99850058753499471, 0.99850855867517185, 0.99852666341704699], [0.99293876560780359, 0.99773921632219975, 0.99770783726198931, 0.99788524453170591, 0.99774519224547586, 0.99788570838860102, 0.99773744884763171, 0.9978147976809465, 0.99700114534353057, 0.99662716422468223], [0.98865481922677867, 0.95835477076345377, 0.97803061322443652, 0.9861381561361704, 0.9818678769876733, 0.96923459129913947, 0.989666942137992, 0.97904407215314204, 0.98971155149249013, 0.97973171560508532]]} 
#gibbs_average_performances = {'R^2': [0.9979859575123438, 0.9979055415894033, 0.997873434604508, 0.9978660955008717, 0.9976614728159523, 0.9974740518668055, 0.9956032628566047, 0.9941951475782131, 0.9591787890128398], 'MSE': [1.1628468390408375, 1.2080609500616863, 1.2182513906801189, 1.2578207958452645, 1.3274355500944335, 1.4638023867097529, 2.5163892294431807, 3.3220435656428364, 23.311438259840202], 'Rp': [0.99899622099905483, 0.99895388445452871, 0.99893775588502487, 0.99893379947855632, 0.99883108903501339, 0.998737457455529, 0.9978322056461767, 0.99710825204545661, 0.98004351090263619]}
gibbs_all_performances = {'R^2': [[0.9977304165364558, 0.9958484337632015, 0.9946991016733259, 0.9984600739509231, 0.9987108787043687, 0.996918438442937, 0.9948947326980404, 0.9965477614437267, 0.9973521482525584, 0.9962344815335836], [0.9980538990931249, 0.9928462779556669, 0.9979315128565555, 0.9964088417402559, 0.9978681516926907, 0.997851062731593, 0.9978759873895352, 0.9984341365572093, 0.9981768331751985, 0.9977355874876593], [0.9979372115606541, 0.9979564006205363, 0.997607370815898, 0.9981244572138728, 0.997943406603862, 0.9980147312842443, 0.997698448099084, 0.9973346164189013, 0.9946206357137068, 0.9960210703758193], [0.9979192849747648, 0.997875686232387, 0.9954254684143276, 0.9960777066575863, 0.9977538800289228, 0.9950654155796524, 0.9975941079546732, 0.9978209146167978, 0.9959879080678158, 0.9980606226324391], [0.9978631539344189, 0.9968971611684223, 0.9979163383832613, 0.9970255282842687, 0.9975297939828608, 0.9975890628673468, 0.9979592472996135, 0.9953038274366172, 0.9946044992763476, 0.997983657882271], [0.9980061989678627, 0.9978309203206511, 0.9960003804822812, 0.997731132462974, 0.9955441583020259, 0.9979322189560865, 0.9954272774806003, 0.9978409791549313, 0.9978356182616736, 0.9977561243686403], [0.9978252190764109, 0.995744293399712, 0.9956179546015647, 0.9977825028495262, 0.9978391158972572, 0.9976395620825507, 0.9979872893188194, 0.9976854992430177, 0.9950414979175285, 0.9980448774039337], [0.9952238578462257, 0.9979680379835076, 0.9976040206927023, 0.9975997087894845, 0.9963816900624036, 0.9977648921751733, 0.9978366527544721, 0.997802338360167, 0.9977982539923363, 0.9978584594775837], [0.9976237067126693, 0.9977117613166041, 0.9949296918384868, 0.9951114165984976, 0.9951770856192504, 0.9954427959890109, 0.9978314653181303, 0.9977853782959724, 0.9977420714019365, 0.9978177091175003], [0.9977083941295597, 0.9976228126025786, 0.997654897078054, 0.9977085881025979, 0.9949896410877794, 0.9974815415080514, 0.9949751208076849, 0.9977608283878059, 0.997556248956862, 0.9976322746711433], [0.9957009786671515, 0.9956539545901317, 0.9975842356345869, 0.9977503247384579, 0.9974858105198536, 0.9975752413262848, 0.9975736007229752, 0.9950953702091059, 0.99766257041422, 0.9973899945326758], [0.9970442018601582, 0.9976247828095824, 0.9949035494677398, 0.9975591063704334, 0.9974854118932346, 0.9975776876275864, 0.997289132264497, 0.9974530372888757, 0.9946404069298848, 0.9974764131696962], [0.9969754175746416, 0.9939918966459342, 0.9974484905937855, 0.997347449525218, 0.9970998847678205, 0.9973947898180123, 0.997154826214691, 0.9972984924795981, 0.9973768839481293, 0.9966568609787594], [0.9936107074071697, 0.9972190435801113, 0.9969188708847818, 0.9968944647921016, 0.9969701172449037, 0.9968688433844136, 0.9970095089744409, 0.9972244442686635, 0.9969616128769491, 0.9935512469348506], [0.9957694164840568, 0.9966817665698352, 0.9964889866122081, 0.9963220982964596, 0.9942473237474563, 0.9963712066265045, 0.9965521408016388, 0.9965206204573674, 0.9941395701342747, 0.9962691245209846], [0.9956429696524687, 0.9925720422461043, 0.9923862213753434, 0.9800294091232294, 0.9944171902306017, 0.9956514078810652, 0.9942821793687842, 0.9934481874328244, 0.9909567184971732, 0.9934276568284861], [0.9284840463670238, 0.9841006014517468, 0.9859174422297259, 0.9877755198689593, 0.9874925388349071, 0.988815307608537, 0.9889044182039436, 0.9880012131722612, 0.9828373990992629, 0.9656637780949258], [0.877071356940868, 0.9286596827164708, 0.958341938650275, 0.9162842138097168, 0.8588077078987749, 0.9100375647128197, 0.8978820872621931, 0.922918161117212, 0.9424646030474616, 0.8979264645170958], [0.7222324451651807, 0.8708184244358632, 0.665323596322362, 0.7233247555599016, 0.7552643235075459, 0.6450585159311075, 0.8287125342544006, 0.8553790737977089, 0.8057501684345134, 0.7922859863574737]], 'MSE': [[1.1764781531117299, 2.2275267674425798, 3.0008788176762722, 1.0639343340632765, 1.1392254341337529, 1.1875563783066223, 2.892553784925521, 2.1339559335571807, 1.2247585831930456, 2.2967294364415536], [1.1803215262907516, 3.1059682683281493, 1.153275511421664, 2.3179314857194093, 1.2838584845914454, 1.240168934762079, 1.2578026389128505, 1.1238460304079094, 1.3004741417558332, 1.1947565294902596], [1.2337280450057084, 1.0670773988282041, 1.2469462387313637, 1.1656196215235559, 1.140297530025616, 1.1860713534706495, 1.1472861462583426, 1.1802521728911124, 2.8631901993078483, 2.456931605434002], [1.1520538262655575, 1.2011201215774403, 2.660359827132297, 2.262296770641834, 1.2401820571594289, 2.8402413746499171, 1.1747837483098442, 1.2341097057140873, 2.2680139560281973, 1.1958060798926251], [1.3126768480036195, 1.6678581173075409, 1.2464267675030476, 1.6582535439212407, 1.2405664537642731, 1.2799233460800901, 1.1504638902909821, 2.525480052360046, 2.8019452621614764, 1.1523968139924883], [1.1636160336539527, 1.1580139066269926, 2.4554229232127529, 1.2254300694321481, 2.6920393970882777, 1.2282702031861594, 2.5991006580092622, 1.1835171919965726, 1.2467398653818922, 1.2785127730698094], [1.1994087891429377, 2.6279296184877015, 2.6113469811628405, 1.218802873814155, 1.2553153931171701, 1.3468169231593705, 1.1794255333025006, 1.3110730640435284, 2.6067560442611928, 1.2318244850215094], [2.5588185200468128, 1.2899601201023896, 1.3105371516573641, 1.3274033010474411, 1.9068054395473326, 1.2234479351143532, 1.2189996214231322, 1.3322041576845336, 1.2584199778951619, 1.2342248450130042], [1.285888611280585, 1.3614857285631687, 2.6258003829505649, 2.7895632744672088, 2.6192514367075241, 2.7522118830721376, 1.3169063003962225, 1.2926458801770926, 1.3104472168488477, 1.3566619502360693], [1.3195154321636966, 1.3278570702140824, 1.3080960704059392, 1.2644817265375026, 2.832768947903928, 1.3558555904253387, 3.0105499727886116, 1.2675577345437978, 1.3276610982244237, 1.3819080487654307], [2.626593170193356, 2.373156604497793, 1.3988342270760086, 1.2966570017110333, 1.3968875195785748, 1.39657370460328, 1.4026288702843954, 2.7987935129102994, 1.3463790757842173, 1.409414662594535], [1.738970057658604, 1.3982789906654829, 2.9734517363468287, 1.4195411741123394, 1.4323766372494673, 1.4378570708761791, 1.4908805845158193, 1.4491336987441736, 3.0794107159520352, 1.4595244188402428], [1.7196998043574991, 3.2792724966986979, 1.4257403109494302, 1.5745483650618026, 1.7399394025536181, 1.5499407780839021, 1.5736742288496135, 1.5588950118473246, 1.5499680440207659, 1.9395369924172021], [3.8351315866346574, 1.6409483741360269, 1.7421067320155894, 1.7168250070872448, 1.7440359184134477, 1.7725827063391923, 1.7635646492243144, 1.6327018790008012, 1.7795082979576189, 3.692859445615976], [2.3635685338693491, 1.9388580929788004, 2.0327703213822947, 2.0963067743668486, 3.3926983981491414, 2.1303089819107734, 1.8977976220850989, 2.0275177577218249, 3.4049450702135653, 2.1200353727774393], [2.5010206593364201, 4.3832137267840023, 4.1653661304123641, 11.712182665661985, 3.2269644084958906, 2.553673699017013, 3.4168242050315256, 3.8494172527655803, 5.1459810423263708, 3.7558274843814434], [40.192124911138158, 9.3678106616751915, 8.1396809324352351, 7.0302210414553068, 7.2514938545056298, 6.311214300028106, 6.3817466252832826, 6.9012545395731983, 9.6268825906850548, 18.900030438202464], [70.426523646657557, 41.016554485200288, 23.810101911622631, 48.222969262549064, 81.941121699778208, 50.980350054607946, 58.411863950644786, 44.65380776459606, 32.65388627783161, 57.385325905147006], [159.73498747447229, 74.739066062873007, 193.80481627602379, 157.50512178291694, 140.20450214609838, 204.53990476002966, 98.457613867779301, 82.670359094909983, 111.14616452473722, 118.66610721031037]], 'Rp': [[0.9988664028033124, 0.9979419322352554, 0.99735088221433044, 0.99923042837419118, 0.99935902425521062, 0.99846304494818339, 0.9974441821437382, 0.99830792210140418, 0.9986872774683101, 0.99811829291181753], [0.99903060725383863, 0.99646237008423866, 0.99896559748208813, 0.99821172297128269, 0.99894446632996625, 0.99892864312559104, 0.99893760939875575, 0.99921690700531551, 0.99909018723536014, 0.99887949163852929], [0.99897081547119149, 0.99897949331737235, 0.99880335393416542, 0.99906635056065274, 0.99897165267322585, 0.99900744942121467, 0.9988488942620517, 0.99867127453838911, 0.99730809792921915, 0.99800936804549689], [0.99895910615773564, 0.99893808080172464, 0.99771178787382808, 0.99803734781345466, 0.99887969192466897, 0.99754492867336364, 0.99879759936041146, 0.99891054199954632, 0.99800476140487293, 0.99903157866230374], [0.9989318488819926, 0.99844966769490484, 0.99896086125592742, 0.99851288162213314, 0.99876697403460568, 0.99879567088920951, 0.99898168731432335, 0.99765956847022508, 0.9973087294250329, 0.99899205326650975], [0.9990032619191388, 0.9989187086636736, 0.99799823510018359, 0.99886605211542678, 0.99777362618386212, 0.99896603192708389, 0.99771182640077172, 0.99892033826379212, 0.99891877609614643, 0.99887767717525777], [0.99891214252607508, 0.99787121009084412, 0.99781015795367911, 0.99889352336837156, 0.99892196828044477, 0.99882005870415935, 0.99899657806967401, 0.99884210368785165, 0.99752022541174701, 0.99902547786136686], [0.9976122832805242, 0.99898841950810402, 0.99880410175538781, 0.99880607225040063, 0.99818928488999892, 0.99888454204569921, 0.99891878741005902, 0.99890083509046079, 0.99890214616724537, 0.99892910898479947], [0.99881140888417719, 0.99885608988628061, 0.99747738994065893, 0.99755707166497365, 0.99758579207313913, 0.99772931671322462, 0.99891548243027461, 0.99889216976106576, 0.99887463493268325, 0.99890886768249065], [0.99885365200687526, 0.99881260188628229, 0.99882761053670344, 0.99885532512567932, 0.99749361225587363, 0.99874015909443925, 0.9974937329880571, 0.9988801279435302, 0.99878186186373219, 0.99881835093407856], [0.99784829109829476, 0.99782729909663959, 0.99879383447501913, 0.99887513496588753, 0.99874977321910174, 0.99879193382063747, 0.99878803014433815, 0.99754621369726526, 0.99883153592109475, 0.99869641528079722], [0.99852257422424306, 0.9988117555909205, 0.99747959174142076, 0.99878042251638643, 0.99874621772452743, 0.99878820679202696, 0.99864442568684841, 0.99872911379759943, 0.99732256515265527, 0.99873762912129482], [0.99848727554465766, 0.99699979348434098, 0.99872583842906837, 0.99867437267994164, 0.99854906695260881, 0.99869786898223567, 0.99857988392404295, 0.9986485530360163, 0.99868879620721074, 0.99832869999350915], [0.99680256308799131, 0.99860889803210817, 0.99845889004856847, 0.9984462527681528, 0.99848521316747108, 0.99843439888885099, 0.99850531428715483, 0.99861185420023002, 0.99848086244765388, 0.99677157377272962], [0.99789193543621613, 0.99834052781750726, 0.99824568406675962, 0.99816592055606435, 0.99714627961696289, 0.99818423274421164, 0.99827519338624104, 0.99826208699033914, 0.99707933814311833, 0.99813309695788277], [0.99782091199974199, 0.99630577280155519, 0.99623452374566734, 0.99014358038785444, 0.99720579030256118, 0.99782474148921185, 0.99715687519500751, 0.9967201783455174, 0.9954681710462302, 0.99670919475922704], [0.96695613696128979, 0.99207217395155045, 0.99301461839459038, 0.99393285159056477, 0.99373344960994792, 0.99441728623683134, 0.99447297804009793, 0.99402229679606413, 0.99170209618039229, 0.98290847371189616], [0.94318260822999733, 0.96500687689542797, 0.97953452633476068, 0.95736138467100629, 0.9340562192933326, 0.95639483923981206, 0.95293454168750036, 0.96400422235651617, 0.97162856531622932, 0.95281340409056725], [0.85997653964949738, 0.93520796435754228, 0.85182560181273481, 0.87140377802299651, 0.8875239151940425, 0.86176506842112843, 0.91277377460973708, 0.92937107857990342, 0.91459481837498291, 0.89854150575191216]]} 
gibbs_average_performances = {'R^2': [0.9967396466999121, 0.9973182290679489, 0.9973258348706577, 0.9969580995159367, 0.9970672270515427, 0.9971905008757727, 0.9971207811790321, 0.9973837912134055, 0.9967173082208058, 0.9971090347332117, 0.9969472081355445, 0.9969053729681688, 0.996874499254659, 0.9963228860348388, 0.9959362254250788, 0.9922813982636081, 0.9787992264931292, 0.9110393780672886, 0.7664149823766058], 'MSE': [1.8343597622851533, 1.5158403551680351, 1.4687400311476402, 1.7228967467371228, 1.6035991095384801, 1.6230663021657818, 1.6588699705512906, 1.4660821069531527, 1.8710862664699419, 1.639625169197275, 1.7445918349233493, 1.7879425084961174, 1.7911215434839858, 2.1320264596424869, 2.3404806925455137, 4.4710471274212598, 12.010245989498163, 50.950250495863514, 134.14686432001514], 'Rp': [0.99837693894557522, 0.99866676025249679, 0.99866367501529785, 0.99848154246719112, 0.99853599428548634, 0.9985954533845337, 0.99856134459542134, 0.99869355813826799, 0.99836082239689694, 0.99855570346352507, 0.99847484617190752, 0.99845625023479234, 0.99843801492336315, 0.99816058207009117, 0.99797242957153043, 0.99615897400725739, 0.98972323614732249, 0.95769171881151516, 0.89229840447744768]}

# ICM NMF
#icm_all_performances = {'R^2': [[0.9975927090292699, 0.9980081023219172, 0.9978155521077262, 0.9975554561095054, 0.997923878035404, 0.9982099616576611, 0.9981625860413992, 0.9978359736733243, 0.9978779504510271, 0.997515342709776], [0.9975890536153215, 0.9980292910066693, 0.9979194412541915, 0.9979658918924728, 0.9975677425995196, 0.9980789962725235, 0.9978807816742185, 0.9979738215496476, 0.9977169179356461, 0.9979390527530128], [0.9977695576055731, 0.9977719145111632, 0.9977470654043835, 0.9975949936294892, 0.9978477764618622, 0.9974169395818809, 0.997792227822902, 0.9978193213459388, 0.9975648828625464, 0.9975486588574607], [0.9976570706503591, 0.997912315499696, 0.9975888360031283, 0.9975517834065201, 0.997401303631934, 0.9976416958006299, 0.9975701396700851, 0.9977735347994222, 0.9977381352638842, 0.9978347279701963], [0.9972048400356697, 0.9974121335180816, 0.9972725006709184, 0.9973945651110651, 0.9975860214597151, 0.9977031023255696, 0.9973354940256396, 0.9973366323745044, 0.9975166443424057, 0.9973194422122789], [0.9968876942549296, 0.9974666638945257, 0.9971232162590854, 0.9965339728630452, 0.9975274512294184, 0.9970835492426965, 0.9968105183626977, 0.9973085027696141, 0.9970350876802735, 0.9971047649757829], [0.9956004866700275, 0.9960425084997317, 0.9956908333301903, 0.9963534897720362, 0.9962563685498766, 0.996272429736938, 0.9963548678337069, 0.9958440798191359, 0.9957456641450465, 0.9958371822889462], [0.966490466863117, 0.9504011247182779, 0.9876873238870871, 0.9837743100507569, 0.9934731765762597, 0.9628010730795674, 0.9929675264889107, 0.9852611319618546, 0.980928068556346, 0.9846092579536968], [0.7448940841360358, 0.5644707788072548, 0.7317341967977111, 0.6268865264832666, 0.6904933275719349, 0.6529445005908574, 0.5883958546834347, 0.5221206128238185, 0.8335961861162272, 0.721881132667106]], 'MSE': [[1.2359111050754783, 1.3042928410580119, 1.2376394595262963, 1.2275988732827634, 1.2382569585089236, 1.1418971298061806, 1.1441518803914916, 1.2223920892944424, 1.2247789351682155, 1.2417987434632936], [1.2792307137209402, 1.2095820439287437, 1.204666514137299, 1.2176876197524185, 1.2450080035692148, 1.2369182353181538, 1.2530229409862728, 1.1919084524073353, 1.2828978056725004, 1.2545687977643687], [1.306426127698413, 1.2906457456653304, 1.3398826196253992, 1.3881057063319009, 1.2359863502075081, 1.3861514029887203, 1.2824578439380021, 1.368772494293425, 1.2942788237192839, 1.2678432597883094], [1.3495310437055388, 1.3641408699751489, 1.3558539963324807, 1.37733755299835, 1.3842753912555095, 1.3138440184813585, 1.4012705880437191, 1.2997572216472284, 1.3232244381774516, 1.3412297465782208], [1.4845439502286777, 1.4236733167015867, 1.4829075685316131, 1.5204074140569728, 1.4671178593650924, 1.296597105766925, 1.4165389674196776, 1.5220963946036925, 1.4511389025847241, 1.5223750280398956], [1.7278422464010317, 1.4371317131299706, 1.664199220301334, 1.8513490228163638, 1.4211713429603694, 1.6371637612297056, 1.7683467037268072, 1.5486671570896307, 1.7350633312338388, 1.6605389189725468], [2.6195785679210499, 2.3095470903110709, 2.4722099129359854, 2.1205864798805969, 2.1261213726651982, 2.1416350443412218, 2.1391932810654732, 2.3567048373783179, 2.4427368406574317, 2.3864977291757903], [19.054484310140925, 28.26033451828971, 7.1455382084831127, 9.5589530429614076, 3.744672733276559, 22.104946580343103, 3.930619863957872, 8.4495494068552048, 11.058583546825346, 8.8319755926652324], [144.22416058491476, 249.60357823247341, 153.54572226357712, 211.09141802208796, 176.71761117002131, 194.69471829847672, 237.88233262720109, 275.26569225321771, 95.593068425483409, 162.0412584829115]], 'Rp': [[0.99880420951544502, 0.99900395021136434, 0.99890857558075508, 0.99878035694496503, 0.99896500446856951, 0.99910731663444752, 0.99908550333940471, 0.9989248480995444, 0.99893876976564466, 0.99876195708329107], [0.99879681787297547, 0.99901489703340884, 0.99895955595351549, 0.99898584690408676, 0.99878738899022479, 0.99904044836434747, 0.99894016179002976, 0.99898821843986496, 0.99885993625712199, 0.99897197416089323], [0.99888436491207322, 0.99888592938366239, 0.99887397749315432, 0.9987985413547712, 0.99892389506668577, 0.99870798064138, 0.99889670828874466, 0.99890921170628233, 0.99878353194075076, 0.99877442025883056], [0.99882953400638341, 0.99895874015184949, 0.99879652488340387, 0.99877596405665137, 0.99869999080131067, 0.99882300349094955, 0.99878850333901692, 0.99888736849994753, 0.99887119732067753, 0.99891742914772053], [0.99860239521475547, 0.99870576989184867, 0.99863740745075846, 0.99869652065113557, 0.99880231392030572, 0.99885117938926438, 0.99867060989233092, 0.99867208619182257, 0.99875800884615606, 0.99865894212951556], [0.99844309014561028, 0.99873292732912911, 0.99856256752744232, 0.99826775109421695, 0.99876308359431631, 0.99854175878031926, 0.99840826616033396, 0.99865428180438387, 0.99852227404052185, 0.99855668698014199], [0.99780564121926174, 0.99802260055713676, 0.99786671812837191, 0.99819140855105448, 0.99813263124688767, 0.99813520389691202, 0.99817671233486327, 0.99793440286027668, 0.99787319646144834, 0.99791773308442666], [0.98362796692557153, 0.97694437268254153, 0.993825075948362, 0.991854258729025, 0.99673194445485813, 0.98223469976977984, 0.99649303700878877, 0.99265967783514075, 0.99053006207596628, 0.99229389145788727], [0.89031297236990137, 0.83497912445121836, 0.87060834703560308, 0.83604847675271821, 0.87662483639964928, 0.85831295806558006, 0.83403806731021446, 0.81720594968054239, 0.92663402534958672, 0.88144323801393565]]} 
#icm_average_performances = {'R^2': [0.9978497512137011, 0.9978660990553223, 0.9976873338083202, 0.9976669542695855, 0.9974081376075847, 0.9970881421532068, 0.9959997910645635, 0.9788393460135871, 0.6677417200677647], 'MSE': [1.2218718015575099, 1.2375491127257248, 1.3160550374256292, 1.3510464867195005, 1.4587396507298858, 1.64514734178616, 2.3114811156332133, 12.213965780379848, 190.06595603603648], 'Rp': [0.99892804916434308, 0.99893452457664689, 0.99884385610463355, 0.99883482556979108, 0.9987055233577895, 0.99854526874564153, 0.99800562483406396, 0.98971949868879217, 0.86262079954289494]}
icm_all_performances = {'R^2': [[0.9977960716139789, 0.9973834994890584, 0.9983016043107281, 0.9975472592906569, 0.9978136425496568, 0.9982280201387091, 0.9981965828582579, 0.9982640230093016, 0.9983963415199908, 0.9986477681687802], [0.9980111539591642, 0.9975445304412317, 0.9978931295438996, 0.9974807190762393, 0.99757835772839, 0.9983210217988878, 0.9978340730406277, 0.9967995704214855, 0.9978108885059572, 0.9979979938512343], [0.9973146791772716, 0.9980396394604358, 0.9977687638443559, 0.997904081502049, 0.9975161817834871, 0.998121638140143, 0.9976928630836424, 0.9978737988025677, 0.9977120376906787, 0.9972076792556375], [0.9978259391246938, 0.9977884822776646, 0.9980475595309849, 0.9976484374258442, 0.9976216503705784, 0.99789535037804, 0.9978651088505368, 0.9979826727856517, 0.997544456824371, 0.9975883619808774], [0.9975896865555836, 0.9976926057034096, 0.9976484871022528, 0.9978103442988308, 0.9978474789857447, 0.9972883842908079, 0.997677596006807, 0.9977181786238531, 0.9977999285296558, 0.9977976626898056], [0.9975737461445836, 0.9975423188792942, 0.9977169797502722, 0.9979126318421085, 0.9975225209643708, 0.997757794048769, 0.9975233529826689, 0.9978989446831908, 0.9979259356750545, 0.9978514364388203], [0.9978665622537566, 0.9977476716261016, 0.9975760561841783, 0.99790900009907, 0.9977387640460015, 0.9976825507814665, 0.9977414083572004, 0.997848613997625, 0.9977360605400215, 0.9975028818526086], [0.9975234749065116, 0.9974798654620204, 0.9974761474309704, 0.9973728835895923, 0.9976878829209026, 0.9976997532110653, 0.9974807774566232, 0.9975172657032069, 0.9976588312092749, 0.9977835395758824], [0.9976916099058944, 0.9973953438727917, 0.997230212317283, 0.9973304698418283, 0.9977560222676292, 0.9976886347066465, 0.997663466707994, 0.997508865564486, 0.997724741393137, 0.9976413063374209], [0.9972797546513117, 0.9973940868507666, 0.9972898855173566, 0.9974036286735548, 0.9974003668260464, 0.9974139449622138, 0.9975140464267697, 0.9975152871072698, 0.997777046292111, 0.9975378762795625], [0.9971501213232983, 0.9971977857080206, 0.9975558498142384, 0.9974912047361075, 0.9972945765279337, 0.997352246105013, 0.9973115052336812, 0.9974688120116599, 0.9974422419135635, 0.9974107073837184], [0.9970995270455087, 0.9973392783898744, 0.9972834182452326, 0.9972311347022608, 0.9972923039059131, 0.997197545842884, 0.9970868777460126, 0.9973734774086613, 0.9974327173642094, 0.9971003899531427], [0.9971298838288146, 0.9967578636383226, 0.9966776909374893, 0.9970304781422635, 0.9960345037762506, 0.9968291959653174, 0.9967697623614128, 0.9968179355654329, 0.9967998002156155, 0.9968017819420039], [0.9910039919105932, 0.9960555506964023, 0.9962509552455636, 0.9938998176987858, 0.9966791511827771, 0.9966366624720836, 0.9967903317782414, 0.9942109857060469, 0.9962207623480237, 0.9960353282783987], [0.995842543538116, 0.9955620025360832, 0.995907521770374, 0.8829053844080554, 0.9959229055620908, 0.9904842012728244, 0.9949252711617799, 0.9958227145540727, 0.9960905531238834, 0.995899366309018], [0.9934617025608774, 0.7371740107582515, 0.9922826081721235, 0.9934648038262894, 0.9838012678489808, 0.9896178071196157, 0.9814919718710041, 0.9812151164783904, 0.9837925411381649, 0.982883296991726], [0.8675910902715176, 0.9719095961333374, 0.8932930234717759, 0.9164207092822406, 0.8919421316904165, 0.9005238308496155, 0.9441155496017423, 0.9774620451163136, 0.9355822571031298, 0.9798571574602224], [0.5891624711472134, 0.7648666894351978, 0.7844874522667273, 0.6699633816459498, 0.5912874125814198, 0.7938940480533925, 0.7654709776302533, 0.372397391797735, 0.5689501208164378, 0.5707875297302283], [0.5356820022435773, 0.6425334772832034, 0.5279011792193716, 0.25505905517157423, 0.45448485610879363, 0.471030154278161, 0.48683253473635146, 0.6287791547754051, 0.6517576137524674, 0.49949659259123036]], 'MSE': [[1.1450246392114909, 1.2986670590230718, 1.262895968808295, 1.29825964658808, 1.4138665350704542, 1.0724022212929925, 1.2002489707376693, 1.2501162558286667, 1.1617217382766478, 1.2223468964174509], [1.1885623802538827, 1.2545136796398837, 1.4094536329111025, 1.329634618943272, 1.2521469466946074, 1.2387188840155623, 1.2177932802807248, 1.1976076890097385, 1.2328860687036776, 1.3004538688910794], [1.3091331188036246, 1.1699102110675565, 1.3689684255984995, 1.2638748078391044, 1.2833228665268406, 1.1564118609700051, 1.3209733440027862, 1.2762883138271994, 1.3163661787371224, 1.3859241245280605], [1.3419589522616153, 1.2464529617661497, 1.2874660589480103, 1.3935502398437702, 1.3637977502174352, 1.2224412621837066, 1.2211385805166233, 1.2027964656159795, 1.3864034937354353, 1.2795360946164827], [1.2856684807702792, 1.3319642545033934, 1.322338998508074, 1.2888487786435445, 1.3173376617480976, 1.4271941583652452, 1.3081757099208153, 1.4142075696016867, 1.291599600542312, 1.2296601238294209], [1.4561542408876869, 1.3548394884532, 1.2474253593911397, 1.2695165954654954, 1.3880053786827933, 1.3203555463773231, 1.3175642196349024, 1.2377602302549882, 1.2305351176261241, 1.2983851052958166], [1.2550550812445838, 1.2485573168105362, 1.3860457578407819, 1.272664109751503, 1.2067096392920351, 1.3227053456436386, 1.3503037860031089, 1.2710761506507637, 1.3608981059913599, 1.3585545973728475], [1.3565973014319042, 1.4078421372954384, 1.3681682904899881, 1.3815523823850144, 1.3430060224882041, 1.3671747729303292, 1.3566905483801273, 1.4243779991670056, 1.4010205397342466, 1.3502767881290783], [1.4450708655967792, 1.4169715322519969, 1.6678115220273113, 1.4225154528631265, 1.4015539722892949, 1.3414530355518277, 1.364043459535724, 1.3814473757333345, 1.3480544195167985, 1.3751031783066732], [1.4427006547855894, 1.494580879551638, 1.5942235427118878, 1.3599595844761085, 1.4943169638141514, 1.4702564716750393, 1.4855692701548133, 1.4435876091692579, 1.2815842421261499, 1.4210031425646643], [1.5772181401336689, 1.5654595031984846, 1.4069078858228075, 1.4777761152040079, 1.5552847083515597, 1.4840830577653927, 1.4825277592310759, 1.4862587456687619, 1.5207591062057491, 1.469974108855759], [1.6546548113350283, 1.4618935014338796, 1.6169883281110622, 1.5151526511788675, 1.5664548144455308, 1.6764140454342262, 1.6725771428458265, 1.4631902851047409, 1.5554480716787247, 1.6370529724262626], [1.6367548364088857, 1.8550847285144507, 1.9690461104081762, 1.6625927306332324, 2.2229930695515598, 1.8537641144518238, 1.7738650420783093, 1.782531880977406, 1.875946833165107, 1.8138575293636237], [5.1868853495123961, 2.2725482800187429, 2.2197745665901354, 3.5328223673119004, 1.8576404284898198, 1.9223835554790278, 1.7757916530539961, 3.3120375395504573, 2.1814882442868133, 2.3003375517405131], [2.3607550410019691, 2.5527398367559089, 2.3819341566204906, 66.333478408471791, 2.4509302605799901, 5.5157660021332902, 2.916088083254964, 2.3888283872327198, 2.2343597198439613, 2.2393921157266408], [3.8051959107529325, 156.05426900405925, 4.5022766451240486, 3.7695914924360454, 9.2785189900528913, 6.0528134400167906, 10.770496666154495, 10.867618932373919, 9.2052455851677433, 9.8885589088119588], [77.810189469115016, 16.224653856134744, 61.59555950659238, 46.618829263148868, 60.578534656481047, 56.644269349693523, 33.140001594590785, 12.840300085843067, 37.187807127884774, 11.728983634417434], [236.7423844286273, 130.38743451940667, 123.03203486810101, 190.50870291106733, 231.82376771486133, 121.05394140124487, 134.42958943368492, 360.28596416203214, 244.40634070142011, 247.17188547620017], [270.0540370588659, 205.53242824756143, 267.84105795700276, 426.9337636314288, 315.32642727762124, 301.20774639438889, 291.25795132420939, 213.66670393856165, 198.75373213764905, 287.60860431144732]], 'Rp': [[0.99890935256924096, 0.99869185280726025, 0.99916276320407815, 0.99877676385742276, 0.99891310989709747, 0.99911797993527129, 0.99910187286913665, 0.99913797417060035, 0.99920288198206242, 0.999330249353373], [0.99900615287740258, 0.99877516828671953, 0.99896692788050023, 0.99874957459175939, 0.99878974075166183, 0.99916734184053047, 0.99891746995248221, 0.99840579799538876, 0.99891356947634524, 0.99900600476308365], [0.99866262837407427, 0.99902441774235584, 0.99888640359126069, 0.99895339611985856, 0.99876404317948186, 0.99906197807601993, 0.9988470436151502, 0.99893773743809144, 0.99886585638400172, 0.9986071721895754], [0.99892628533831729, 0.99889735003056468, 0.99902385095087365, 0.99882411479595268, 0.9988113114169318, 0.99894900047793445, 0.99893444048330937, 0.99899212367256651, 0.99877418661514783, 0.99879851371599571], [0.9987953766991271, 0.99884814006291944, 0.99882534167464987, 0.99890576518535468, 0.9989259470544104, 0.99865174291269776, 0.99883983190854908, 0.99886078239354525, 0.99889955170821354, 0.99889933271644105], [0.99879254271427154, 0.9987752750031017, 0.99885837198547611, 0.99895647699378343, 0.99876106272044007, 0.99887904382598092, 0.99876613627728883, 0.99894958822151481, 0.9989647243004387, 0.99892730066312319], [0.99894393852846219, 0.99887633512073926, 0.99879137255226835, 0.99895511888467603, 0.99886879198767853, 0.99884571172590897, 0.99887216862001826, 0.99892833150295557, 0.9988695322819654, 0.99875289107495691], [0.99876347416434419, 0.99874326175445161, 0.99874014046974335, 0.99868807892266076, 0.99884534157992444, 0.99885015965869572, 0.99874240642417889, 0.99876339961357352, 0.99882908830951045, 0.99889219125682949], [0.99884824688476104, 0.99869920655871125, 0.99861826203745563, 0.99867253197609851, 0.99888351349247551, 0.99884688875393157, 0.99883458545343429, 0.99875585601283423, 0.99886183194494327, 0.99882304720438408], [0.99864178242640111, 0.99870277918222594, 0.99865088053712014, 0.99870795220847663, 0.99870201114927393, 0.99871454181743746, 0.99875772047994216, 0.99875864683112903, 0.99888892324977241, 0.99877267666535341], [0.99857409963631272, 0.99860632623390699, 0.99877785214981529, 0.99874512485309175, 0.99865193974519373, 0.99868546619008902, 0.99865788495019348, 0.99873892626542049, 0.99872403401333754, 0.99870997987681687], [0.99855017065490947, 0.9986687622542203, 0.99864981832292632, 0.99861499275635679, 0.99864617085512219, 0.99860256927794799, 0.99854596594405087, 0.99869167154587724, 0.99872024010358373, 0.99855537373748726], [0.99856643106380216, 0.9983792922799114, 0.99835264964525361, 0.9985144270164984, 0.99803345855867265, 0.99842495141746068, 0.99838607906859389, 0.99840865279579272, 0.99841544942711424, 0.99840045147289369], [0.99551286695583363, 0.99803265155046572, 0.99812538967031328, 0.99694844039148545, 0.99833861008987512, 0.99831785625680958, 0.99839705249686583, 0.99710229637235048, 0.99811734952734865, 0.99801657217517592], [0.99792672579435393, 0.99778161866028414, 0.9979557395283718, 0.94540538085365777, 0.99796123624828348, 0.99523276726597965, 0.9974610328108009, 0.99791127988803696, 0.99804820787585291, 0.99795351389476661], [0.9967621481196125, 0.88463345249420922, 0.99615828401900974, 0.99672915103861981, 0.99197321428477458, 0.99482651130955702, 0.99080231904391824, 0.9907108255405126, 0.99192096418767595, 0.99145986525720042], [0.93278003598471049, 0.98635120492483941, 0.95379991091096294, 0.95832139107447212, 0.94976056779666818, 0.95109755380423389, 0.97315830799096914, 0.98869008271397618, 0.96837229130465574, 0.99002572508503617], [0.82899672390352575, 0.88897660021746838, 0.89733927334601338, 0.84756014823296355, 0.82447297652678064, 0.90705198593095693, 0.90587327909949378, 0.79879661536924096, 0.84499517565171556, 0.84721926048568019], [0.78411640788953207, 0.8306266710716893, 0.78598556365468686, 0.70230820340856248, 0.75017038856772689, 0.76068119503423637, 0.82938455655594701, 0.82229042998374346, 0.84833032220204641, 0.77084465228349131]]} 
icm_average_performances = {'R^2': [0.9980574812949119, 0.9977271438367117, 0.9977151362740269, 0.9977808019549244, 0.9976870352786751, 0.9977225661409133, 0.9977349569738028, 0.997568042146605, 0.9975630672915111, 0.9974525923586963, 0.9973675050757235, 0.9972436670603699, 0.9967648896372923, 0.9953783537316918, 0.9839362464236299, 0.9619185126765425, 0.927869739098031, 0.6471267475104554, 0.5153556620160135], 'MSE': [1.2325549931254818, 1.2621771049343531, 1.28511732519008, 1.294554185970521, 1.3216995336432869, 1.3120541282069469, 1.303256989060116, 1.3756706782431336, 1.4164024813672866, 1.44877823610293, 1.5026249130437268, 1.5819826623994149, 1.8446436875552574, 2.6561709536033797, 9.1374272011621738, 22.419458557495005, 41.436912854390165, 201.9842045616646, 277.81824522787366], 'Rp': [0.99903448006455431, 0.99886977484158757, 0.99886106767098704, 0.99889311774975942, 0.99884518123159083, 0.99886305227054195, 0.99887041922796294, 0.99878575421539106, 0.9987843970319028, 0.99872979145471308, 0.99868716339141772, 0.99862457354524836, 0.99838818427459919, 0.99769090854865239, 0.99236375028203871, 0.982597673529509, 0.96523570715905238, 0.859128203876384, 0.78847383906516622]}

# Non-probabilistic NMF
#np_all_performances = {'R^2': [[0.9980343429144349, 0.995609618431885, 0.9949348087065104, 0.9982636881051925, 0.9980652353035467, 0.9975858464757429, 0.9982870148398022, 0.9979401506447826, 0.9984285716597046, 0.9981641744293244], [0.9978711565756241, 0.9951287961499744, 0.9955681745487412, 0.9977816392170151, 0.9976521250865921, 0.9980295403896086, 0.997967923476359, 0.998133275350781, 0.9977997887661408, 0.9976685147823149], [0.9974878783068148, 0.9977227798620565, 0.9964085132001691, 0.9979066461073346, 0.9976156756353801, 0.9977450435816912, 0.9979100744486454, 0.9978245838548117, 0.9978511881366197, 0.9978482327011712], [0.9977014482955708, 0.9977308797494522, 0.9979366179315533, 0.9974637696425553, 0.997567461760042, 0.997232480770134, 0.9978046385772357, 0.9958527869467003, 0.9976979457890558, 0.9976039928091303], [0.9972873791567107, 0.9974788313451, 0.9974874870493455, 0.9976407323409554, 0.9976075690681417, 0.9968273846950513, 0.9975191092280739, 0.9957221939684213, 0.9940014813239068, 0.9975382659486167], [0.9972760828563136, 0.9973243972377697, 0.9971832708219596, 0.9971215746756694, 0.9959736934524578, 0.9974774945714368, 0.996821475613117, 0.9969160552417984, 0.9974096115578959, 0.997158452666769], [0.9952929262598474, 0.9964297512630778, 0.9460503817431494, 0.9964772516678725, 0.9962207997347254, 0.9963726980531884, 0.9966501497043366, 0.9963737293018352, 0.9966902187552384, 0.9962939159188997], [0.9830150098355507, 0.9874911795421858, 0.8936347493707586, 0.9877260361953338, 0.9909088566617611, 0.9539134425722242, 0.9929213967933344, 0.9899306534387379, 0.9915779962418456, 0.9886991669119036], [0.5248515363916246, -7.024220602118414e+52, 0.7794147157383904, 0.5655423577728611, 0.7067000089738362, 0.36084588195959366, 0.6642642108143817, 0.7581320210169895, 0.7448099035778358, 0.7934430488340981]], 'MSE': [[1.1117273217378305, 2.3256773636075838, 2.9998561716900229, 1.1098033050993086, 1.0948085435040582, 1.2827467330013105, 1.1913980300490594, 1.3028129274095495, 1.1661385896617491, 1.2842719862649354], [1.2245273456719461, 2.3136521304393223, 2.4610859524398383, 1.2236548175424988, 1.2180003141282578, 1.1731739638750209, 1.2046935743663822, 1.2806399258355881, 1.2680535334083713, 1.389284693705213], [1.2588366636023249, 1.2841200803571773, 2.266613268725413, 1.1768216450733573, 1.2377841468514552, 1.2734553909153328, 1.249335830894494, 1.2854355430335669, 1.2189422766194737, 1.2666054721024202], [1.2908570246570437, 1.3556280072018361, 1.2710824575159441, 1.3213661147982978, 1.3277951257577973, 1.4858258783528859, 1.320584587958312, 2.496345993882279, 1.3198053691046701, 1.2930205186768902], [1.4757018569434037, 1.3833886749310353, 1.44261511794411, 1.4716594488218024, 1.374673050139454, 1.7637131189789428, 1.3490298959990301, 2.4682230761075292, 3.1875323257963935, 1.4526496250295395], [1.5802395951361314, 1.5169576690580031, 1.579972485028267, 1.6345701428905648, 2.1646134699942974, 1.5139838888367847, 1.6693633434318642, 1.627937462063324, 1.4939395117947363, 1.6318822480375663], [2.6462347938031714, 1.9774539650171108, 30.404288995593351, 2.0678630459146747, 2.2019393825194209, 2.0155135038322074, 1.8379413250731671, 2.1417047615223836, 1.8689874228503611, 2.1469989037293975], [10.00351199232586, 7.0374960093009928, 61.312164632958066, 7.2479063248142719, 5.1383066740763077, 25.786585434786456, 4.0860549464388924, 5.9186700417560267, 4.8378237060334861, 6.4192980730779574], [277.54525146528437, 4.0054170095568005e+55, 125.49911986794422, 248.68429881964471, 168.28248872197133, 366.69536847829045, 193.99197205474707, 138.75847806416536, 141.69537167011299, 118.56358302693702]], 'Rp': [[0.99901831033550148, 0.99780267323418492, 0.99746532993847858, 0.99913184513114062, 0.99903476674991853, 0.99880402516521027, 0.99914522989985854, 0.99897248918732606, 0.99921789276757178, 0.99908661815973598], [0.99893681373087895, 0.99758801048588652, 0.99778177276524527, 0.99889553637877282, 0.99882707580567365, 0.99901455166763853, 0.99898429732255611, 0.99906725758542458, 0.99890242410479768, 0.99883689243690521], [0.99874389090697591, 0.99886115746120463, 0.99820283070307547, 0.99895416759157307, 0.99881468578807919, 0.99887202005848885, 0.99895486890826601, 0.99891177416512533, 0.99892518952847609, 0.99892397729039517], [0.9988504461615394, 0.99886535314254665, 0.99896950233159876, 0.99873324352209936, 0.99878342543591769, 0.99861580778971792, 0.99890278482331929, 0.99792672022315521, 0.99885055131867329, 0.99880184616905998], [0.9986455214633525, 0.99874135118538232, 0.99874445271605405, 0.99882057829495607, 0.99880509920628302, 0.99841739036749755, 0.99876029963181223, 0.99787641705417718, 0.99700267143790289, 0.99877110190618346], [0.9986420737099263, 0.99866166298444703, 0.99859088348326819, 0.99856286714576636, 0.99798913092482722, 0.99873865443757215, 0.99841445921822869, 0.99845946526067653, 0.99870415634755061, 0.99857935368159356], [0.99765801147108923, 0.99821463763173846, 0.97369867754965167, 0.99823846555228446, 0.99810891026453552, 0.99818580924244882, 0.99832436981576389, 0.99820000427266786, 0.99835221365309634, 0.99814790541981058], [0.99163850472123882, 0.99374088005539329, 0.95099812872284506, 0.99386323564774937, 0.99544851212496843, 0.97746944649188028, 0.99646362300198033, 0.99498800160241041, 0.99578162502496104, 0.99442329673681795], [0.82217943237744207, 0.0086490164132459486, 0.89763285493411682, 0.79763928882156299, 0.87052056847973192, 0.81024677391454336, 0.84867623154677641, 0.89351663603146692, 0.88580704312138958, 0.90926055138610729]]} 
#np_average_performances = {'R^2': [0.9975313451510924, 0.9973600934343152, 0.9976320615834695, 0.997459202227143, 0.9969110434124323, 0.9970662108695187, 0.9912851822402171, 0.9759818487563635, -7.024220602118413e+51], 'MSE': [1.4869240972025408, 1.4756766251412441, 1.3517950318175014, 1.4482311077905954, 1.7369186190691241, 1.6413459816271536, 4.9308926099855253, 13.778781783556832, 4.0054170095568004e+54], 'Rp': [0.99876791805689291, 0.99868346322837787, 0.99881645624016591, 0.99872996809176284, 0.99845848832636008, 0.99853427071938561, 0.99571290048730854, 0.98848152541302436, 0.7744128397026383]}
np_all_performances = {'R^2': [[0.9962063945066817, 0.9952117860440499, 0.9954751339964156, 0.9960098290923545, 0.9963955556694212, 0.9978892486245532, 0.9928980680212569, 0.9970063645728976, 0.9960648669613977, 0.9946485164619207], [0.9981371973903026, 0.9967864075747161, 0.9961049591417127, 0.9979163030563502, 0.9972685687369583, 0.9958623365262758, 0.995462664836765, 0.9957846983440475, 0.9969554513882282, 0.9959799650009298], [0.9958338895174539, 0.9972157313221351, 0.9978899753236734, 0.9974220954889335, 0.9952318509517915, 0.9961471219924026, 0.9975367173888783, 0.9953352798433481, 0.9978626483303038, 0.9940083607657426], [0.995882980890237, 0.9950422974054679, 0.9976331866124758, 0.9953716523625389, 0.9970176559478298, 0.9971472250769187, 0.9972282381990349, 0.9954657122093548, 0.9940886324475817, 0.9949353089634675], [0.9956461754981152, 0.9960253762659874, 0.9956196891949282, 0.9953023471085498, 0.9948675813628644, 0.9957778952907087, 0.9978155274130537, 0.9962673381561962, 0.9960550011548281, 0.9955981822642457], [0.99592259909498, 0.997663756806484, 0.9962296790863876, 0.9956478565392816, 0.9958678701351467, 0.9964957219221171, 0.9967792305176417, 0.995089723428762, 0.9971694417396728, 0.9979325866167374], [0.9949737140760235, 0.9956983603137102, 0.9956630495680359, 0.9955841280156259, 0.9963849288081821, 0.9976620900297413, 0.9955765636811043, 0.9966893569405892, 0.9955927097128661, 0.9952997550121442], [0.9972382928845018, 0.9952714483490777, 0.9948628680038072, 0.996200078178459, 0.995852448919139, 0.9948276943608685, 0.994824490068884, 0.995413158441782, 0.9957727671223241, 0.9957730639190467], [0.9952465804489504, 0.9977358908950131, 0.9953391639661217, 0.9955246271653274, 0.9970071651516105, 0.9956761478121187, 0.9971833440944355, 0.9951203921701669, 0.995233601664906, 0.9972323956726123], [0.9968668098499075, 0.9969358362327682, 0.9965388696837818, 0.9946481850681989, 0.99750446152684, 0.9950606809652205, 0.9970341186597591, 0.9962884149201763, 0.9952550037240914, 0.9953887884888017], [0.9971495971377476, 0.9945765082628745, 0.9954586232484604, 0.995013165659572, 0.9971895051660294, 0.9974840063941564, 0.9946708916134598, 0.9954140813542034, 0.9945691478999277, 0.9969308767820141], [0.9951156883843166, 0.9945869140557536, 0.9972781531372162, 0.9969896440022914, 0.9970302907262817, 0.995166340740021, 0.9939736473020614, 0.9946055054251018, 0.9950262790978491, 0.9951896130621724], [0.9945074945811259, 0.9963313309835414, 0.9959624695553247, 0.9943848688128225, 0.9958373466550637, 0.9944367070366555, 0.9962567476646124, 0.9945805102815026, 0.9949503638665529, 0.9945522436748129], [0.9801500158464631, 0.99449884522877, 0.9942781096393166, 0.9956882904922659, 0.9955931180038949, 0.996004134688716, 0.9945382877181, 0.9938658068918859, 0.994293853841724, 0.9936604101959295], [0.9935678014517111, 0.9932574344125626, 0.9901623220963821, 0.9863843702589428, 0.9685747520243158, 0.9938368847987423, 0.9930368515140815, 0.9935793493135131, 0.9919734871251957, 0.9929998561715981], [0.9895491882192277, 0.9756234686817539, 0.9793998127934948, 0.9886046175655753, 0.9575717263436173, 0.9747675131695464, 0.9673757504696554, 0.982078324247234, 0.9744142272621655, 0.8954502610566232], [0.886570952388983, 0.9386961308748675, 0.8984517594794402, 0.9007111871319804, 0.9351693222009404, 0.9803574318940305, 0.9843660429618423, 0.8173488261470822, 0.9174641971253716, 0.8832784089401231], [0.770204017331025, 0.7210630452231155, 0.730403080569797, 0.7529502664361041, 0.7552947969076185, 0.8793520157680721, 0.8465459736316541, 0.8709576248612239, 0.8670556148322343, 0.8086582503614737], [0.6487950095334953, 0.6422692009132736, 0.5305531520437426, 0.6313225023671221, 0.6413529985994542, 0.6892896376461888, 0.6678619623174173, 0.7405230008470852, 0.4276942243413684, 0.7267407003838806]], 'MSE': [[2.1173723883692883, 3.193814808329372, 2.448282520157727, 2.6297125009937918, 2.0343284006701992, 1.2839455004694693, 3.3857797651730577, 1.3567688251004626, 1.8058277114902992, 2.3107589704934242], [1.2471859506206149, 2.185129612688681, 2.2197917557964435, 1.1811226752431248, 1.3273199593780669, 2.2522668267756756, 2.2391094929178736, 2.4904964222302555, 2.0367423951705446, 2.5251065275546365], [2.3850391038429102, 1.608332738838089, 1.2520832694995618, 1.3387311924283627, 2.5654617046736647, 2.3131660722593876, 1.4476853702316796, 2.3857413873584585, 1.2447511224206065, 3.0504806768194559], [2.5388842720556628, 2.6151972964295673, 1.2983850353050377, 2.5660309914137116, 1.7284602538015852, 1.5090468672231554, 1.6818074137622878, 2.3957198038034946, 2.5931619670684687, 2.5162165242806749], [2.3997913705706355, 2.4809781404937561, 2.5857856708207629, 2.6130439878538478, 2.7532964957562052, 2.3720336611567112, 1.3140707640987459, 2.2253948543183584, 2.74301363358849, 2.4864950356673057], [2.3507308183110811, 1.3079876448153482, 2.3970136318573272, 2.4099087273593827, 2.6605669003160752, 2.2613178693944915, 1.9816754604697322, 2.6490641111807887, 1.773839402304122, 1.2737033841024499], [2.7107740964264737, 2.4501682404434741, 2.5470310536566494, 2.419008010802504, 1.8942930041729593, 1.4665636007336595, 2.3151873475611109, 2.1782297674089461, 2.6011468108850013, 2.5476762660654395], [1.6550739848990221, 2.7297757863493963, 2.9326112742471899, 2.0909890543822507, 2.4395229115458323, 2.732220315058727, 2.853637078555487, 2.5140372233774153, 2.5550289073743011, 2.4870594529835439], [2.8059433667540588, 1.3131431959947197, 2.5621409549239096, 2.7510578749645314, 1.6451080711087924, 2.4121645906988225, 1.5856122030730515, 2.856784927931701, 2.8337275432278455, 1.6351790541430744], [1.8123275809937061, 1.8395419053965441, 2.0259623887907252, 2.8421768477089198, 1.391777409137934, 2.6636824106775259, 1.702260791985541, 2.174976479386221, 2.6340700250732305, 2.803232641330005], [1.5974054482430669, 2.9387027155927612, 2.6363823912314461, 2.8955332936589651, 1.5962231394966184, 1.4385160409888782, 2.8787698160216788, 2.6948051878902657, 3.0660212588955007, 1.7831162868805479], [2.9093961795176537, 3.1935115794981859, 1.5987895971831865, 1.6857837224109846, 1.7417441925024142, 2.8407720482578376, 3.5052132841924024, 3.0963737363643227, 2.9757877739113252, 2.9960071399840653], [3.0030813516560309, 2.1509894694192275, 2.2973446377874573, 3.3086711764771595, 2.3272315725825026, 3.2532357860075032, 2.0949265504753494, 3.0286290793794031, 2.9770981067374085, 3.1867936539589841], [11.40773455763537, 3.1031120008458442, 3.307037229497944, 2.3613328967169167, 2.5812072134147193, 2.3287235803959816, 3.101119042330565, 3.5729623502077428, 3.3143176922223323, 3.6740349513423665], [3.4767164594592637, 3.8756657265561527, 5.5688979763577482, 7.7971486167742281, 17.927830546091666, 3.5448240210926456, 4.0878861946887639, 3.6891269976335019, 4.7424405570560326, 3.9401806015099656], [6.0597086045913491, 13.61876296355222, 11.87828085352249, 6.6282237092920733, 24.953688218084938, 14.070022712752946, 18.646126889151681, 10.170059954171357, 14.830196003216651, 59.918776757578996], [64.251683006658965, 34.913144668199678, 57.786110138866363, 59.057010748959179, 35.563009167256993, 11.184688439410566, 8.9777121542854896, 101.36626749010232, 48.4078025309555, 66.450052701527056], [132.88190760313276, 163.18243788501226, 154.87754728195193, 142.21735914663051, 142.35972760057879, 69.096737303534951, 88.695195567448664, 74.007593443805547, 77.720121574047482, 110.94483947540073], [201.92213201634607, 207.45752965693751, 265.38342741342132, 209.31553963738176, 206.59915390578306, 173.57730442169114, 189.19916724529895, 145.98124085063219, 323.88844304737904, 157.64892698216559]], 'Rp': [[0.99810200238272762, 0.99761135611540253, 0.99774973391230803, 0.99800436487068755, 0.99821192856449481, 0.99894668830273503, 0.99654889357590482, 0.99850617085046722, 0.99804556534795097, 0.99732724641425941], [0.99906936292934112, 0.99840343524805619, 0.99805125242587711, 0.99895802435856007, 0.99863713178110358, 0.99795116968481534, 0.99773550169110681, 0.99789786006485015, 0.99848528872859166, 0.99799513993361533], [0.99791680344818179, 0.99861539185212767, 0.99894511272306308, 0.99871155064996286, 0.997630232654664, 0.99807763758578727, 0.99876865831200468, 0.99768182936748862, 0.99893089357934972, 0.99700256647963026], [0.99794900083218208, 0.99753064720788054, 0.99881637030886461, 0.9976836377119187, 0.99851042654273137, 0.99857550573124543, 0.99862994727409282, 0.99773931973575969, 0.99705536489399538, 0.99746633103505888], [0.99782313432175773, 0.99801575519353924, 0.99781164458134386, 0.99764936717332131, 0.99743098372607919, 0.99788982180496499, 0.99890790440123489, 0.99814024855201278, 0.99802937957561699, 0.99779777479935061], [0.99795996491450101, 0.99883185647221129, 0.99811548838022035, 0.99783549849715181, 0.99794241538180706, 0.99825785160466873, 0.99839558697020458, 0.99754317568762096, 0.99858399954705901, 0.99896651342421772], [0.99748389187577013, 0.9978471754243009, 0.99783006596343415, 0.99779081214235454, 0.99819121498066066, 0.99883049268767798, 0.99778656843659053, 0.99834427702806472, 0.99780479917557818, 0.99764771429102739], [0.99862259556841249, 0.99763731381805387, 0.99743588492631508, 0.99810309229881766, 0.99792483645384222, 0.99741985920171494, 0.99741644981457966, 0.99770480619671276, 0.99788439553728947, 0.99788625455284852], [0.99762149235995301, 0.99886781621688325, 0.99767269393710256, 0.99776077060451984, 0.99850496213725026, 0.99783589873654333, 0.99859198420215778, 0.99756384414085075, 0.99761544611101627, 0.99861630036959159], [0.99843303783713266, 0.99846908176434723, 0.99827945039381993, 0.99732623989524949, 0.99875147131127617, 0.99752976153223583, 0.9985182005594585, 0.9981471332798898, 0.99762819014456938, 0.99769514913226987], [0.99857425959737423, 0.99729143290855327, 0.9977272662859954, 0.99751110916918484, 0.99859473194949644, 0.99874174234411894, 0.99733473103465753, 0.99770817749847096, 0.99728387456758028, 0.99846594514346998], [0.99755895086361712, 0.99730035278931572, 0.99863845588394984, 0.99849482509257936, 0.99851566600091146, 0.99758599730716779, 0.99698228009244216, 0.99731616363742415, 0.99751092420822851, 0.99759216285709729], [0.99725708457334961, 0.99816398610349721, 0.99798285840639389, 0.99721078801533769, 0.99791818004433641, 0.99722009196335515, 0.99814473498784495, 0.99729296110935717, 0.99747671421559958, 0.99728165294550797], [0.99040480405222098, 0.99724661593629804, 0.99714037780173126, 0.99784594540720284, 0.99779534286293425, 0.99800091155751802, 0.99726990031710783, 0.9969479276246932, 0.99714824728911777, 0.99682602471623494], [0.99679760046678378, 0.99662850799937253, 0.99507210121142142, 0.99321514666298438, 0.98455928172238172, 0.99691406892798473, 0.99652989521316537, 0.99678718399226851, 0.99598910970521959, 0.99649651344396228], [0.99476138936053482, 0.98774794368627761, 0.98968339965245433, 0.99430334028126266, 0.97875763111257086, 0.98740987131287228, 0.98428597571263488, 0.99100494540804385, 0.98714719726364686, 0.95333824168682368], [0.94746885819437066, 0.97097786231867866, 0.94931237407951219, 0.95009504660308919, 0.96887852561255872, 0.99016901754617392, 0.99217617822752524, 0.91325898512923276, 0.95938084219284392, 0.94333606745047394], [0.90564585331309333, 0.86573146866485717, 0.8764413435787004, 0.88156927432077459, 0.87631502677332174, 0.94118904106620216, 0.92172601149193567, 0.93523410552270825, 0.9313050516274215, 0.91719490294270012], [0.83767825528794693, 0.84337794445225445, 0.79655012678040593, 0.82949191287563073, 0.81737894325544258, 0.86416766859217042, 0.84186252423579955, 0.89250011397106288, 0.80279940095954361, 0.86554645853794498]]} 
np_average_performances = {'R^2': [0.9957805763950949, 0.9966258551996285, 0.9964483670924664, 0.9959812890114907, 0.9958975113709478, 0.9964798465887211, 0.9959124656158023, 0.9956036310247889, 0.9961299309041263, 0.9961521169119545, 0.9958456403518445, 0.9954962075933065, 0.9951800083112013, 0.9932570872547066, 0.9897373109167045, 0.9684834889808892, 0.9142414259144662, 0.8002484685922319, 0.6346402388993029], 'MSE': [2.2566591391247091, 1.9704271618375919, 1.9591472638372174, 2.1442910425143649, 2.3973903614324819, 2.1065807950110802, 2.3130078198156219, 2.4989955988773165, 2.2400861782820503, 2.1890008480480354, 2.3525475578899728, 2.6543379253822379, 2.7628001384481022, 3.8751581514609783, 5.8650717697219967, 18.07738466659147, 48.795748104622213, 115.59834668815438, 208.09728651770371], 'Rp': [0.9979053950336938, 0.99831841668459165, 0.99822806766522587, 0.99799565512737287, 0.9979496014129221, 0.9982432350879662, 0.997955701200546, 0.99780354883685884, 0.99806512088158672, 0.99807777158502486, 0.99792332704989017, 0.99774957787327345, 0.997594905236458, 0.996662609756506, 0.99489894093455433, 0.98484399354771224, 0.95850537573544603, 0.90523520793017165, 0.83913533489482028]}



# Assemble the average performances and method names
methods = ['VB-NMTF','G-NMTF', 'ICM-NMTF', 'NP-NMTF']
avr_performances = [
    vb_average_performances,
    gibbs_average_performances,
    icm_average_performances,
    np_average_performances
]
colours = ['r','b','g','c']

# Also compute the median values
def compute_medians(all_performances):
    medians = {}
    for metric in ['MSE','R^2','Rp']:
        medians[metric] = []
        for performances in all_performances[metric]:
            medians[metric].append(numpy.median(performances))
    return medians
    
median_performances = [
    compute_medians(vb_all_performances),
    compute_medians(gibbs_all_performances),
    compute_medians(icm_all_performances),
    compute_medians(np_all_performances)
]

# What to plot - averages or medians
values_to_plot = avr_performances

# Plot 
for metric in metrics:
    fig = plt.figure(figsize=(1.9,1.5))
    fig.subplots_adjust(left=0.15, right=0.96, bottom=0.17, top=0.95)
    #plt.title("Performances (%s) for different fractions of missing values" % metric)
    plt.xlabel("Fraction missing", fontsize=8, labelpad=1)
    plt.ylabel(metric, fontsize=8, labelpad=-1)
    if metric == 'MSE':
        plt.yticks(range(0,MSE_max+1,10),fontsize=6)
    else:
        plt.yticks(fontsize=6)
    plt.xticks(fontsize=6)
    
    x = fractions_unknown
    for method,avr_performance,colour in zip(methods,values_to_plot,colours):
        y = avr_performance[metric]
        #plt.plot(x,y,label=method)
        plt.plot(x,y,linestyle='-', marker='o', label=method, c=colour, markersize=3)
    
    plt.xlim(0.0,1.)
    if metric == 'MSE':
        plt.ylim(0,MSE_max)
    else:
        plt.ylim(0.5,1.05)
        
    plt.savefig("../graphs_toy/mse_nmtf_missing_values_predictions.png", dpi=600)