"""
Plot the performances of the many different NMF algorithms in a single bar chart.

We plot the average performance across all 10 attempts for different noise levels.

We have the following methods:
- VB NMF
- Gibbs NMF
- ICM NMF
- Non-probabilistic NMF
"""

import matplotlib.pyplot as plt, numpy
metrics = ['MSE'] #['MSE','R^2','Rp']

noise_ratios = [ 0, 0.01, 0.02, 0.05, 0.1, 0.2, 0.5 ]
# Which noise ratios we put in the bar chart:
shown_noise_ratios = [ 0, 0.01, 0.02, 0.05, 0.1, 0.2, 0.5 ] #[ 0, 0.01, 0.02, 0.05, 0.1 ]
indices_selected = [noise_ratios.index(noise) for noise in shown_noise_ratios]

# Settings for the bar chart
N = len(shown_noise_ratios) # number of bars
ind = numpy.arange(N) # x locations groups
width = 0.2 # width of bars
MSE_max = 30


# VB NMF
vb_all_performances = {'R^2': [[0.9999999395630335, 0.9999999928906743, 0.9999999590004002, 0.9999999508479446, 0.999999757014438, 0.999999907100087, 0.999999880185556, 0.9999996244272937, 0.9999999083062547, 0.9999998513969608], [0.9872169490478419, 0.9863889683626499, 0.984817832426098, 0.9856278442440845, 0.9856146819323769, 0.9885028768571681, 0.9863304928425066, 0.9874271629662636, 0.9865671464804635, 0.9862961906091414], [0.9697375793091526, 0.9706149806411103, 0.9765149060695575, 0.9742094901393421, 0.9724695705717665, 0.974154684735378, 0.9756863281921537, 0.9735716905367409, 0.9752339993100132, 0.9765299504821537], [0.9436462328820918, 0.9418321588252829, 0.928480558835162, 0.9402193834247614, 0.9455690563574064, 0.9467958046490395, 0.9481264583664385, 0.9418281243263402, 0.9398641994123804, 0.9394248335121694], [0.8971280760098098, 0.8738589556835731, 0.8928053890517526, 0.8901772514332932, 0.8779718162408898, 0.8767806888153943, 0.8939614687921615, 0.8679336867553407, 0.8894750692961866, 0.8895953762973924], [0.7862264389098523, 0.808333790105953, 0.8018722245953505, 0.7924915702877224, 0.8096894655192034, 0.7939443544248859, 0.7785449765135044, 0.7999495003396758, 0.7833464611402563, 0.7900159186332261], [0.5441174435798213, 0.5744997926480562, 0.6210823683894424, 0.6172189083306171, 0.5845544354406276, 0.6288273464193093, 0.598701255109894, 0.558433232576194, 0.5297921983250002, 0.5737022583011011]], 'MSE': [[1.9693638736380783e-06, 2.7174616009545132e-07, 1.4594105214996862e-06, 1.8671672448818662e-06, 9.943582358726527e-06, 3.6091081245595755e-06, 4.3433443420178594e-06, 1.4910672550793262e-05, 3.2274080927908365e-06, 6.4098288515402509e-06], [0.50341084952466064, 0.52642151754624433, 0.53263405324428748, 0.53032447880142031, 0.50194344492662568, 0.50746170247941746, 0.47565361624712899, 0.49580205114912018, 0.51082204852072222, 0.51015258789365758], [1.0286843071098091, 0.95962976568666492, 0.96886468858352515, 0.88641024274327518, 0.98756952604002923, 1.0195242602577523, 0.99645319621727235, 1.0397154858507411, 0.98895284948953144, 1.0240748127560262], [2.2431168745332344, 2.3031955079077924, 2.5490739076922129, 2.457468600117394, 2.3672191581961197, 2.3575156000867095, 2.2983479139483936, 2.4521279932537352, 2.5704584997811417, 2.6150944964815004], [4.7760531055198534, 5.0627976697211219, 4.7301559942625859, 4.7235578620679846, 5.0550308496407395, 5.41569724064846, 4.6725189202048707, 5.0417994742742067, 4.7964843971647584, 4.994895500141145], [9.4474967747969725, 8.9162357741669442, 9.3103572038663618, 10.003080948139354, 9.1066300110990444, 9.0434488602115479, 9.5352446053290283, 8.814148782789875, 9.5278482648628984, 9.4687145493834688], [22.887479259858381, 23.610321780133322, 24.00098625811648, 22.343700646745077, 20.634715226159372, 22.346291687082822, 24.950096858714669, 26.243294837406971, 26.171428153896887, 23.058509248124547]], 'Rp': [[0.9999999698371228, 0.999999996465607, 0.99999997983992472, 0.99999997568461951, 0.99999987877197793, 0.99999995388555019, 0.99999994051777052, 0.99999981307098074, 0.99999995455221102, 0.99999992581729635], [0.99362269314220852, 0.99320254565319221, 0.99239983287065958, 0.99284359358618146, 0.9928041011983888, 0.99427469205420016, 0.99315586856888594, 0.99378887530875248, 0.99326464956735838, 0.99312598414184683], [0.98479343626741234, 0.98524235910335189, 0.98820770804009739, 0.9870449483622854, 0.98623165841727833, 0.98700298327266811, 0.98777207947864942, 0.9867107696279287, 0.98755844912779522, 0.98825330697318692], [0.97142481308293416, 0.97072403328409052, 0.96366248240092245, 0.96965672529959046, 0.97242541306311392, 0.97304069807796933, 0.97374528790183901, 0.97057769534391958, 0.96960095592612716, 0.96928861204769523], [0.94741662869102961, 0.93480890323994525, 0.94495619258091768, 0.94386272824902551, 0.93727205951169545, 0.93637832283640909, 0.94633520308779828, 0.93169754301856544, 0.94315895431429753, 0.94324145431382267], [0.88687096585023806, 0.899746758539265, 0.89555265438109299, 0.89042028704526333, 0.89986524383552746, 0.89161437720571468, 0.88241878191236578, 0.89503770353555989, 0.88553899473769238, 0.88898675017138507], [0.73920977744055438, 0.7579960628412149, 0.78822373823017455, 0.78633874863460351, 0.76496879344497626, 0.79331481149741034, 0.77453291439063565, 0.74834035938584753, 0.73010821074595289, 0.75894190732501632]]} 
vb_average_performances = {'R^2': [0.99999987707326432, 0.98647901457685949, 0.97387231799873697, 0.94157868105910736, 0.88496877783757932, 0.79444147004696308, 0.5830929239120064], 'MSE': [4.8011632120543395e-06, 0.50946263503332845, 0.98998791347346271, 2.4213618551998239, 4.9268991013645733, 9.3173205774645478, 23.624682395623854], 'Rp': [0.99999993884430594, 0.99324828360916739, 0.98688176986706522, 0.97041467164282014, 0.94091279898435065, 0.89160525172141047, 0.76419753239363852]}

# Gibbs NMF
gibbs_all_performances = {'R^2': [[0.9999993026299884, 0.9999989840310693, 0.9999998109374572, 0.9999998652773082, 0.9999996834189543, 0.9999995242262033, 0.9999995682421269, 0.9999997554928209, 0.9999997946854393, 0.9999996772861779], [0.9886330161469159, 0.98792754420215, 0.9888225706812016, 0.984396325873337, 0.9860153961308216, 0.9889164956369573, 0.9882431946392561, 0.9864193845872495, 0.9867383865715993, 0.9870565943174949], [0.9709405419641102, 0.976636052979077, 0.977598094177464, 0.9732397298710191, 0.9745477379650497, 0.9771834903716277, 0.9758413533991006, 0.976657270646303, 0.9704751816468112, 0.9717784376128534], [0.9306836220127879, 0.9337403223836616, 0.9411625947149024, 0.9394695855248162, 0.9370564476984411, 0.9223936761705369, 0.9454086265923771, 0.9282796809562954, 0.9362208872085099, 0.9440652019778629], [0.8832516433691882, 0.8914421288370697, 0.9021578751187782, 0.8788354549844375, 0.8628305366942006, 0.8852051899368039, 0.8742388433706014, 0.8926084577759251, 0.8670006370614451, 0.8941559258852527], [0.7976372150403626, 0.7970172465089869, 0.7849237501652369, 0.7839169097776685, 0.8340137076254337, 0.7980757252643228, 0.7853201937290858, 0.7746127845871951, 0.7649077416671866, 0.7392666356509956], [0.5461592941362791, 0.5620848932571676, 0.6057782220653862, 0.5553290478078607, 0.5675347902398482, 0.5493012847755652, 0.5915551743119472, 0.5787342048391806, 0.5939365729505568, 0.5657118912905065]], 'MSE': [[2.2285126813743725e-05, 3.5294357219257156e-05, 6.8831067276941949e-06, 5.6298456851883728e-06, 1.0796497103121288e-05, 1.8151250264764583e-05, 1.5547450683823681e-05, 1.0274332155675257e-05, 7.8116267813455652e-06, 1.194096631854005e-05], [0.5014534025771219, 0.50884431347677139, 0.43513181113626176, 0.54744679174950939, 0.52626586460163416, 0.46376844122589467, 0.47850293735484362, 0.54051904183082766, 0.50225995301092075, 0.48766372113022882], [1.0074591231195764, 0.98703881716138131, 0.99965968838444597, 1.0427956126827249, 1.0305517271572096, 0.99630499463806343, 1.0519925967309764, 0.96795803360541721, 0.99985183233681019, 1.0000192193888759], [2.4279257322124614, 2.5538207805448438, 2.4553817164425937, 2.6504689150258063, 2.553896038744115, 2.986071990825057, 2.3373514293186197, 2.6620524354311028, 2.4123679905291819, 2.3237882683459063], [4.6405637218018061, 5.0505418449004171, 4.6037354600469049, 4.7869548814846885, 5.4055261448773813, 4.9360478580325342, 5.0276178525010975, 4.5769536277519203, 5.1117866628768329, 5.1192952179981717], [8.9051171106783542, 9.2198096908586571, 9.9360330388911482, 10.160305528447072, 8.8877385792774106, 9.2071045506485447, 9.8746410708404699, 9.3325661502567652, 9.8465857807805985, 9.8358684889786883], [24.187211018836965, 23.254988717669672, 21.886909620319173, 25.530066516151393, 24.430836811313444, 23.073723859140326, 21.974098576935933, 24.540435040432268, 21.630645795699355, 23.499203293719887]], 'Rp': [[0.99999965409105795, 0.99999949282562162, 0.99999990571100683, 0.99999993266532183, 0.99999984184549551, 0.99999976401147472, 0.9999997853308441, 0.99999987844686122, 0.99999989745843432, 0.99999983987360086], [0.99432153214552277, 0.99397187090013217, 0.99440629564172356, 0.9921746937721585, 0.99298634036812095, 0.99451373480507621, 0.99411908770373325, 0.99318673537959767, 0.99346842839714433, 0.99354430850852404], [0.98542469341421701, 0.98840470362968158, 0.98882315664559561, 0.98655588268217442, 0.98731666685023989, 0.98855117807419601, 0.98799821442511937, 0.98827801487262035, 0.98515351926157613, 0.98584142935049579], [0.96506325588651776, 0.96689509299677845, 0.97029978884516677, 0.96950553085200708, 0.9685356851092044, 0.96120031616167101, 0.97262226312057276, 0.96352878228438321, 0.96759810278719594, 0.97192708107533399], [0.94001427755712696, 0.94424344852932263, 0.95011651397814234, 0.93811994157439937, 0.92989686780385428, 0.94107501108003244, 0.93604008831081864, 0.94531020146958933, 0.93323719122026161, 0.94589125731655754], [0.89430520535644331, 0.89289510078391054, 0.88696488997771483, 0.88589091358990957, 0.91358400481045243, 0.89598110733791458, 0.88744612887693985, 0.88111306347676521, 0.87582528433309315, 0.86776805371484467], [0.74343927823319389, 0.75459775833038745, 0.779529583942423, 0.74899929811540267, 0.75520460701246983, 0.74673514199249891, 0.76950368725751017, 0.76091702721827137, 0.77074893333633643, 0.75514654433187234]]} 
gibbs_average_performances = {'R^2': [0.99999959662275462, 0.98731689087869845, 0.9744897890633416, 0.93584806452401903, 0.88317266930337035, 0.7859691910016473, 0.5716125375674298], 'MSE': [1.4461455975315386e-05, 0.4991856278094014, 1.0083631645205482, 2.5363125297419691, 4.9259023272271758, 9.5205769989657725, 23.400811925021845], 'Rp': [0.99999979922597182, 0.99366930276217325, 0.98723474592059168, 0.96771758991188306, 0.94039447988401048, 0.88817737522579887, 0.75848218597703654]}

# ICM NMF
icm_all_performances = {'R^2': [[0.9994275174004048, 0.9994656403948952, 0.9996708221177796, 0.9995347288718752, 0.9993728412262468, 0.999619981753875, 0.9995697852224706, 0.9995508439367382, 0.9995124092128751, 0.9995556075776828], [0.9878832245755035, 0.9884637889922985, 0.9859048321405175, 0.9867771207376747, 0.9877654825259267, 0.9819716445808432, 0.9862989544423829, 0.9853170648242279, 0.9880720155073895, 0.9854688885414058], [0.9747229093869724, 0.9721046731311451, 0.9746043305021105, 0.9724548194664965, 0.968803504686089, 0.9714477793932085, 0.9763408925659203, 0.9751042973989507, 0.9709944217749016, 0.9708258089641953], [0.9268233240613288, 0.942153652981157, 0.9431726336567899, 0.9347929132509821, 0.9311673619339667, 0.9473541318512297, 0.9437485971400831, 0.9375259853569553, 0.934867883731487, 0.9391162187225124], [0.8942025568195693, 0.8902703520523046, 0.8702341360656927, 0.8792356739873265, 0.8873483331357861, 0.8653905410520002, 0.8867979597011612, 0.8927663674030155, 0.8797186484916076, 0.8790765136352358], [0.7990256074012729, 0.7728978707408007, 0.7686681480817688, 0.7959198079850562, 0.745233132727992, 0.790296141423561, 0.7891194390919503, 0.7882630246048945, 0.8054293086806115, 0.7960678022241063], [0.5818369238376604, 0.5619913446409395, 0.5225568235388031, 0.5049061484974569, 0.5285340571647257, 0.48974033404601147, 0.48693144720801695, 0.5505018855893371, 0.5129126696309582, 0.48720828233932445]], 'MSE': [[0.021961390244601007, 0.01783791515535086, 0.014004711613521202, 0.01743406378289614, 0.020559048298976229, 0.015565544744807081, 0.017329985391589701, 0.015950688895202805, 0.015616944038136118, 0.016922990008239151], [0.52280524517411453, 0.48735443687082003, 0.51131982585342517, 0.51433826889056133, 0.48726352256540784, 0.57060021330640498, 0.54788936163734214, 0.4982181087322779, 0.4672137445062966, 0.49528646224927569], [1.0383610354287984, 1.0431877093554609, 1.0276156813390882, 1.0683443240451367, 0.99537081038300812, 1.0095372992885241, 0.92353840755256045, 0.9566102185401687, 1.0644459355580631, 1.0416358364838905], [2.6318869427701026, 2.5363293162013663, 2.2960063099841679, 2.5883073027718519, 2.5199808152824055, 2.450177564962206, 2.314747001321555, 2.3377677749135857, 2.6528040313875461, 2.6635273421713364], [4.5709336917294712, 4.7648335305182465, 5.013238932376491, 4.5388352781435097, 5.1711359515106521, 5.0404242175258158, 5.1082230131022071, 4.5827142830733241, 4.9517558971267013, 5.426416504409417], [9.7864172390575739, 9.8011600069405809, 8.704516072297027, 10.05347108342515, 10.273858392693079, 11.290349630074372, 9.9032958700776401, 9.8714369645012301, 9.2505232507026456, 9.1374364042937302], [25.816680540836302, 26.836068339667023, 25.999883354034342, 29.082571286069534, 26.944719875812147, 27.520926395571404, 25.932036593701991, 26.004813903333066, 28.451955448585078, 25.957354341512559]], 'Rp': [[0.99971567619444301, 0.99973738747637664, 0.9998359945126879, 0.99977155566646414, 0.9996948394107974, 0.99981397220711854, 0.99978638572296563, 0.99977847924032703, 0.99976202022169058, 0.99978426607074489], [0.99392818274541639, 0.99422292434176096, 0.99301661805801733, 0.99337108063408797, 0.9938770263432849, 0.9909829261982479, 0.99313669798147808, 0.99263988594710773, 0.99407366983035406, 0.99275722558333301], [0.9872970797242876, 0.98608149391613575, 0.98727022692049993, 0.98619469316998065, 0.98448117996079731, 0.98563919679905199, 0.98817104337752926, 0.98748982132235952, 0.98548752516759797, 0.98541653526776729], [0.96277597238590051, 0.9706489794572376, 0.9714331620811073, 0.96691170887040767, 0.96519363688398918, 0.97340192077796528, 0.97153950532568345, 0.96878026924467231, 0.96696529053692781, 0.96923516069187232], [0.94617004403148186, 0.94419587331347543, 0.93311040290683611, 0.93776958154494627, 0.94203246403852148, 0.93063056655335197, 0.94213190950149583, 0.94512328685284863, 0.93852748424619059, 0.93771034366909189], [0.89520848268271691, 0.88185160458620482, 0.87766767327953044, 0.89357375644074388, 0.8645477593905081, 0.89028969511561584, 0.89086763113398071, 0.8893164622956774, 0.89810000668634926, 0.89390569945979326], [0.76594451825353271, 0.75827171066070964, 0.74227388558177121, 0.71976089851550162, 0.74230633673428348, 0.71434998045066289, 0.7084737877091225, 0.74865652572894115, 0.7273666878006444, 0.71844248076747952]]} 
icm_average_performances = {'R^2': [0.99952801777148426, 0.98639230168681702, 0.97274034372699902, 0.93807227026864926, 0.88250410823436987, 0.78509202829620151, 0.52271199164932336], 'MSE': [0.017318328217332028, 0.51022891897859257, 1.0168647257974701, 2.4991534401766122, 4.9168511299515831, 9.8072464914063033, 26.854701007912343], 'Rp': [0.99976805767236177, 0.99320062376630891, 0.98635287956260065, 0.96868856062557618, 0.93974019566582412, 0.88753287710711193, 0.73458468122026488]}

# Non-probabilistic NMF
np_all_performances = {'R^2': [[0.9995476448825061, 0.9996015719301165, 0.9977014834683336, 0.995333359990504, 0.9989171669218556, 0.9989023989710264, 0.9995815981752173, 0.9977542754218551, 0.9995589030416472, 0.9997875425214272], [0.9840083075273499, 0.9876403134638938, 0.9833233590310835, 0.9861499308284364, 0.9844822940046448, 0.9834857475585675, 0.9837756448742655, 0.9846713003157226, 0.9861673598204916, 0.9871470794503925], [0.97163376920039, 0.9692489386240508, 0.972088341044331, 0.9761647482340167, 0.9717181260881824, 0.9778586510304955, 0.966184554321682, 0.9744497879795551, 0.9735917151388707, 0.9737363197236218], [-4.4028161836888004e+32, -3.759088559712833e+38, -1.294424569221832e+28, -3192998662.7071505, 0.9264061063849559, 0.8209657002484525, -3.317052728860476e+30, 0.9259966177389088, 0.8638819977507671, -1.8530424186932566e+28], [-9.04979819635709e+24, -9.783087896122723e+68, -3.736819774299516e+66, -9.409288215082278e+45, -6.750238390004993e+45, -3.500043640759108e+43, -6.207036685437332e+36, -1.2172318304923406e+48, -1.0402515558651151e+27, -4.255321662988398e+18], [-5.322021762905144e+44, -1.9856764045031045e+38, -5.925436358768115e+44, -7.987356278301606e+28, -1.335543045766171e+75, -1.5826268610296532e+77, -9.54254797725046e+46, -8.014381066248156e+55, -5.340070522287999e+46, -6.36146895670925e+55], [-7.245161924177464e+49, -1.5463601857627408e+68, -1.775323988766755e+70, -7.999748148466896e+64, -6.413613197677375e+120, -2.5521149161538797e+74, -3.787110268749836e+70, -9.729831849434912e+38, -5.2167564956988923e+42, -3.8507539352937304e+52]], 'MSE': [[0.017579391110152848, 0.016209412144582734, 0.07979513381961699, 0.16691081480503253, 0.041816340955535332, 0.040723658062362403, 0.01434950136088101, 0.080922889083611671, 0.016077789206501727, 0.0080075315398314695], [0.556647535355145, 0.52920876979532194, 0.6645189579671188, 0.53456025270139673, 0.66919942521440101, 0.584795647797971, 0.57462950681059599, 0.58297133742187979, 0.55375943878567779, 0.55392496374309874], [1.1310102239849043, 1.0947414484766109, 1.1391949320210497, 1.035034344893238, 1.0764653661380836, 1.0326958594090681, 1.164610180709388, 1.0628607539314783, 1.040050098743059, 1.0071058599864846], [1.6793857062974631e+34, 1.6250255661503201e+40, 5.3388994035749167e+29, 118253579083.21465, 2.743625271983281, 7.2453660463483383, 1.4425753854773788e+32, 3.1174230463259618, 5.9480407071845125, 7.6853748444340342e+29], [4.0990355186149488e+26, 3.7821214619636125e+70, 1.4898715875812972e+68, 4.0418900628545628e+47, 2.5005186369469588e+47, 1.657683117342332e+45, 2.7169776260388621e+38, 4.9263478837449507e+49, 4.5830639010511826e+28, 1.9011576623210067e+20], [2.4872759011919353e+46, 8.8480443092101869e+39, 2.6744589827873387e+46, 3.9794158674804488e+30, 5.4537998087055478e+76, 7.6259861064724823e+78, 4.5871390123676107e+48, 3.8108476673176332e+57, 2.5963359535628107e+48, 3.3686621553075175e+57], [4.2583864652103243e+51, 9.3520673467790451e+69, 1.0411042574290839e+72, 4.3336691271956313e+66, 4.2992002381607381e+122, 1.4296131884986913e+76, 2.4500508628948341e+72, 5.0193966554079113e+40, 3.1451570800690035e+44, 1.9380092105757164e+54]], 'Rp': [[0.99977529880816907, 0.99980082124890457, 0.99885921328218641, 0.99766588048267624, 0.9994603542081647, 0.99945323503981032, 0.99979188604526203, 0.99888740252001373, 0.99977966389614426, 0.99989473414419439], [0.99197290223453038, 0.9938300992218867, 0.99166756834496372, 0.99309512773098996, 0.9922471412699817, 0.99181517504353978, 0.99186257355018614, 0.9923252115997373, 0.99312721784438296, 0.99357326587445549], [0.98572965487348108, 0.98451163806119935, 0.98602252897119691, 0.98805267765986327, 0.98578032201494115, 0.98897599935849467, 0.98299084122028357, 0.98722393066304515, 0.98686776145158495, 0.98681899486732272], [0.0050265140944558695, 0.088623442888634663, -0.011479275681817291, 0.00020868376171321576, 0.96261224289442959, 0.91266969574511125, 0.031621824933526665, 0.96230379072357941, 0.93235617145736904, 0.0028854091872550719], [-0.03264316071376152, -0.10334237706819703, -0.02266952757218425, 0.035782601454783201, 0.0028528614426870935, 0.02546949395618275, 0.015822821557324333, 0.05035265259249895, 0.050165277121261335, 0.038555092337905744], [0.036435858876184342, 0.022895574152277543, -0.032157063695105563, 0.013047324333588057, 0.018351543213773559, -0.10699733868630842, -0.026353783457276674, 0.029376785769269723, 0.033591873998306092, -0.004338170628755896], [-0.024072841814460476, -0.0021285471712846702, 0.034972133644170726, 0.044366035648386329, 0.0099709576329952265, 0.016765670312145434, -0.051118797157659296, -0.065178939061203547, 0.022641683782244279, -0.062332563935127976]]} 
np_average_performances = {'R^2': [0.99866859453244883, 0.98508513368748485, 0.97266749513851969, -3.7590929960142905e+37, -9.8204560938657164e+67, -1.5959822914873151e+76, -6.4136131976773748e+119], 'MSE': [0.048239246208810871, 0.58042158355926055, 1.0783769068293363, 1.6250272600920232e+39, 3.7970201778394254e+69, 7.6805241045595372e+77, 4.2992002381607378e+121], 'Rp': [0.99933684896755248, 0.99255162827146548, 0.98629743491414124, 0.38868285000042579, 0.0060345735108500642, -0.0016147396124047246, -0.007611520811979397]}



# Assemble the average performances and method names
methods = ['VB-NMF', 'G-NMF', 'ICM-NMF', 'NP-NMF']
avr_performances = [
    vb_average_performances,
    gibbs_average_performances,
    icm_average_performances,
    np_average_performances
]
colours = ['r','b','g','c']

for metric in metrics:
    plt.figure()
    #plt.title("Performances (%s) for different noise ratios" % metric)
    plt.xlabel("Noise to signal ratio", fontsize=16)
    plt.ylabel(metric, fontsize=16)
    
    x = noise_ratios 
    offset = 0
    for (method, avr_performance, colour) in zip(methods,avr_performances,colours):
        all_performances = avr_performance[metric]
        y = numpy.array([all_performances[i] for i in indices_selected])
        plt.bar(ind+offset, y, width, label=method, color=colour)
        offset += width
        
    plt.ylim(0,MSE_max)
    plt.xticks(numpy.arange(N) + 2*width, x)
    
    plt.legend(loc=0) 
    
    