"""
Plot the convergence of the many different NMF algorithms in a single graph.

We run our method on the entire random dataset, so no test set.

We use a dataset of I=100, J=80, K=10, with unit mean priors and zero mean unit
variance noise.

We have the following methods:
- VB NMF
- Gibbs NMF

"""

import matplotlib.pyplot as plt
metrics = ['MSE']#,'R^2','Rp']
MSE_max = 3
iterations = range(1,200+1)

folder = "../time_toy/"

# VB NMF
#vb_all_performances = {'R^2': [-568.0441214850692, -12.065852161733632, 0.6111142176390654, 0.6894727007761771, 0.6951151587124467, 0.7140397612742699, 0.741486061398124, 0.782495217302652, 0.8313128853081553, 0.8673627766103285, 0.897742949965608, 0.9180503048267509, 0.9283212088415719, 0.9359944056403732, 0.9417187787639725, 0.9457969724545253, 0.9491240552388082, 0.9521576020891553, 0.9549908845882131, 0.9574710738106214, 0.9594491066391847, 0.9610401416698016, 0.9624170042282227, 0.9637617489842852, 0.9651896707439098, 0.9667311961174231, 0.9682983494540904, 0.9697296489752586, 0.9709019074543284, 0.9718007051019989, 0.9724932868823896, 0.9730521945190864, 0.9735268346202028, 0.9739471883846382, 0.9743302321028442, 0.974685007173449, 0.9750153121522791, 0.9753227285189114, 0.975608529492046, 0.9758741447925515, 0.9761211356412153, 0.9763510346644863, 0.9765651770221175, 0.9767646493003674, 0.9769503317466575, 0.9771229598122498, 0.9772831769645078, 0.9774315727631061, 0.9775687101971214, 0.9776951592093992, 0.9778115382595417, 0.9779185400005043, 0.9780169193493262, 0.978107448860463, 0.9781908732982757, 0.9782678838544773, 0.9783391084045955, 0.9784051097945933, 0.9784663883928548, 0.9785233871923971, 0.9785764980721009, 0.978626068072364, 0.9786724049553961, 0.9787157817140666, 0.9787564400086535, 0.978794592823345, 0.9788304269371362, 0.9788641059198493, 0.9788957740686497, 0.978925561023805, 0.9789535861934707, 0.9789799620675763, 0.9790047960085886, 0.9790281907249236, 0.9790502439701448, 0.979071048008406, 0.9790906891991117, 0.9791092478452783, 0.9791267983036324, 0.9791434092833489, 0.979159144245169, 0.9791740618281334, 0.9791882162573484, 0.9792016577111419, 0.9792144326441383, 0.9792265840729626, 0.9792381518345805, 0.9792491728258934, 0.979259681229618, 0.9792697087277749, 0.9792792847016472, 0.9792884364162566, 0.9792971891879599, 0.9793055665350398, 0.979313590312493, 0.9793212808331668, 0.9793286569777933, 0.9793357362963564, 0.9793425351027568, 0.9793490685641063, 0.9793553507853534, 0.9793613948894441, 0.9793672130929062, 0.9793728167766124, 0.9793782165515034, 0.9793834223191643, 0.9793884433273122, 0.9793932882203925, 0.9793979650856104, 0.9794024814947888, 0.9794068445424802, 0.979411060880749, 0.979415136751018, 0.9794190780133274, 0.9794228901733059, 0.9794265784071138, 0.9794301475845706, 0.9794336022906496, 0.9794369468454968, 0.9794401853231138, 0.9794433215688333, 0.9794463592157026, 0.9794493016998961, 0.9794521522752522, 0.9794549140270244, 0.9794575898849128, 0.9794601826354147, 0.979462694933502, 0.9794651293136105, 0.9794674881999014, 0.979469773915751, 0.9794719886924238, 0.9794741346769037, 0.979476213938879, 0.9794782284769036, 0.9794801802237818, 0.9794820710512376, 0.9794839027739307, 0.9794856771528705, 0.9794873958982585, 0.9794890606717508, 0.9794906730881104, 0.9794922347161881, 0.9794937470791796, 0.9794952116541448, 0.9794966298708485, 0.9794980031101252, 0.9794993327021102, 0.9795006199248439, 0.9795018660038507, 0.9795030721132844, 0.9795042393790817, 0.9795053688842761, 0.9795064616762337, 0.9795075187751828, 0.9795085411831269, 0.9795095298921106, 0.9795104858909198, 0.9795114101695597, 0.9795123037212301, 0.9795131675418864, 0.9795140026277698, 0.9795148099714728, 0.9795155905571652, 0.979516345355559, 0.9795170753190948, 0.979517781377695, 0.9795184644352969, 0.9795191253672696, 0.9795197650187175, 0.9795203842036193, 0.9795209837046943, 0.9795215642738688, 0.979522126633201, 0.9795226714761189, 0.9795231994688377, 0.979523711251839, 0.9795242074413141, 0.9795246886304989, 0.9795251553908578, 0.9795256082730889, 0.9795260478079549, 0.9795264745069496, 0.9795268888628252, 0.9795272913500148, 0.9795276824249765, 0.9795280625264927, 0.9795284320759514, 0.9795287914776287, 0.979529141118988, 0.9795294813710105, 0.979529812588556, 0.9795301351107646, 0.97953044926149, 0.9795307553497672, 0.9795310536703082, 0.9795313445040208, 0.9795316281185417, 0.9795319047687855, 0.9795321746974959], 'MSE': [22376.091062522872, 513.77861002661143, 15.291861123737212, 12.210629830772911, 11.98875573027447, 11.24459791498893, 10.165347839796285, 8.5527758576411284, 6.6331556673817538, 5.2155930916252373, 4.020976541121426, 3.2224458043025868, 2.8185708236942584, 2.5168435167456336, 2.2917483273686887, 2.1313846052160659, 2.0005562484282358, 1.8812703828812023, 1.7698593607634165, 1.6723327581722844, 1.5945520711825247, 1.5319890055351069, 1.4778476818229724, 1.4249693021307679, 1.3688202161159047, 1.3082039812220225, 1.2465799973406133, 1.1902980901664924, 1.1442022577237878, 1.10885951846735, 1.0816256495964769, 1.0596481478491047, 1.0409842345891143, 1.0244549818363862, 1.0093928437773283, 0.99544229234056247, 0.98245395979190153, 0.97036565880757453, 0.95912732357281905, 0.94868273425661342, 0.93897050015623018, 0.92993035496244236, 0.9215097971993722, 0.91366609985843583, 0.90636464963686925, 0.89957652694163681, 0.89327642919289518, 0.88744117358201779, 0.88204862211588664, 0.87707636336359818, 0.87250007810655439, 0.86829252967713133, 0.86442403304427728, 0.86086420963417654, 0.85758377364185723, 0.85455554585902105, 0.85175483681176034, 0.84915951413451563, 0.84674990222022983, 0.84450858158997266, 0.84242014268726872, 0.84047093910537662, 0.83864886894396817, 0.83694319751119073, 0.83534442218293037, 0.83384416794323579, 0.83243509022314255, 0.83111075709038951, 0.82986549445681668, 0.82869420457635523, 0.82759219205253332, 0.82655503352904325, 0.82557850727290794, 0.82465857455885117, 0.82379139149753389, 0.82297333005550466, 0.82220099438729832, 0.82147122679820905, 0.82078110341499078, 0.82012792243878796, 0.81950918845092902, 0.81892259563283276, 0.8183660117317002, 0.81783746362314491, 0.81733512460714908, 0.81685730317354255, 0.81640243284349301, 0.81596906274809133, 0.81555584874624931, 0.81516154502986993, 0.81478499626099743, 0.81442513031783126, 0.81408095170445738, 0.81375153562924674, 0.81343602270471416, 0.81313361418414498, 0.81284356763481658, 0.81256519295199936, 0.8122978486365271, 0.8120409382835504, 0.81179390725485978, 0.81155623952678946, 0.811327454718069, 0.81110710530725727, 0.81089477404836752, 0.81069007158886774, 0.81049263428778429, 0.81030212222613662, 0.81011821739687762, 0.80994062205894879, 0.80976905723863879, 0.80960326136184757, 0.80944298900184086, 0.80928800972869375, 0.80913810704874001, 0.80899307742374271, 0.80885272936148112, 0.8087168825705231, 0.80858536717303708, 0.80845802297013858, 0.80833469875473529, 0.80821525166725083, 0.8080995465895966, 0.80798745557355511, 0.80787885730004061, 0.80777363656667189, 0.80767168380213028, 0.80757289460695891, 0.80747716932146318, 0.80738441262218796, 0.80729453314876776, 0.8072074431628713, 0.8071230582402803, 0.80704129699621452, 0.80696208084304499, 0.80688533377857452, 0.80681098220241698, 0.80673895475808854, 0.80666918219874284, 0.80660159727542446, 0.80653613464808971, 0.80647273082063153, 0.80641132410232819, 0.80635185459769754, 0.80629426422543571, 0.80623849676398773, 0.80618449791583324, 0.80613221537708823, 0.80608159889231989, 0.80603260027116641, 0.80598517334327102, 0.80593927383427122, 0.80589485915686776, 0.8058518881262704, 0.80581032062481417, 0.80577011725148129, 0.80573123899684551, 0.80569364697962942, 0.80565730227061594, 0.80562216581494783, 0.80558819844943363, 0.80555536099963954, 0.80552361443459164, 0.80549292005453266, 0.80546323968888944, 0.80543453588555636, 0.80540677207791034, 0.80537991272109399, 0.80535392339364276, 0.80532877086415233, 0.80530442312515671, 0.80528084939837874, 0.80525802011638214, 0.80523590688622615, 0.80521448244076677, 0.80519372058292504, 0.80517359612752659, 0.80515408484455431, 0.80513516340663371, 0.80511680934251106, 0.8050990009974982, 0.80508171750081103, 0.80506493873937679, 0.80504864533706266, 0.80503281863810228, 0.80501744069353853, 0.80500249424946035, 0.80498796273594619, 0.80497383025596159, 0.80496008157356458, 0.80494670210095476, 0.80493367788423564, 0.80492099558766794, 0.80490864247659322, 0.80489660639906524, 0.80488487576633871, 0.80487343953250534, 0.8048622871734753, 0.80485140866544047, 0.80484079446317214], 'Rp': [0.12198410261051881, 0.61223359333849892, 0.82071482587249067, 0.83139003862344685, 0.83401151710310295, 0.84537852506417299, 0.86163585518551367, 0.88543991966627045, 0.91283413553684001, 0.9323696303798048, 0.94841041724477582, 0.95873106092151461, 0.96385083319311604, 0.96774115313850007, 0.97062512114877531, 0.97268871182887495, 0.97438359365315441, 0.97593650679295774, 0.97738797909631869, 0.9786533666241789, 0.97965905713167623, 0.9804666621914998, 0.98116468455190631, 0.98184705298667463, 0.98257292658890616, 0.98335665862289057, 0.98415098260602807, 0.98487247549038792, 0.98545934694132775, 0.98590611986323395, 0.98624838801965731, 0.98652303499292826, 0.98675520004152162, 0.98696031894080127, 0.98714726485789583, 0.98732081421628026, 0.98748290034536623, 0.98763418461141517, 0.98777512489545294, 0.98790628584307238, 0.98802835053203941, 0.98814203209109552, 0.9882479731439604, 0.98834670538287794, 0.98843866101008437, 0.98852419874713604, 0.98860362841320393, 0.98867722988218654, 0.98874526825469333, 0.98880801494449777, 0.98886577383337304, 0.98891889367789232, 0.98896775495039346, 0.98901274182996646, 0.98905421965369644, 0.98909252504270107, 0.98912796350660881, 0.98916080969495146, 0.98919130888276818, 0.98921967934106581, 0.98924611514862959, 0.98927078896727705, 0.98929385445447537, 0.9893154481710027, 0.9893356909946629, 0.98935468920367464, 0.98937253554702431, 0.98938931068755964, 0.98940508525437576, 0.98941992236614262, 0.98943388012033706, 0.98944701348551967, 0.98945937531543782, 0.98947101657798542, 0.9894819861117784, 0.98949233023625816, 0.98950209243325271, 0.98951131319167995, 0.98952003001618138, 0.98952827755586314, 0.98953608779903646, 0.98954349028948585, 0.98955051233504687, 0.98955717919494379, 0.98956351424302635, 0.98956953911044432, 0.98957527381355559, 0.98958073687225889, 0.98958594542213207, 0.98959091532159893, 0.98959566125373588, 0.98960019682167433, 0.98960453463654885, 0.98960868639732313, 0.98961266296269612, 0.98961647441573009, 0.98962013012216687, 0.98962363878372039, 0.9896270084871811, 0.98963024675025058, 0.98963336056448614, 0.98963635643560954, 0.98963924042128515, 0.98964201816623965, 0.98964469493477092, 0.98964727564056976, 0.98964976487397038, 0.98965216692674907, 0.98965448581465187, 0.98965672529791626, 0.98965888889989362, 0.9896609799241467, 0.989663001470105, 0.98966495644747388, 0.98966684758957346, 0.9896686774656962, 0.98967044849256558, 0.98967216294502658, 0.98967382296600759, 0.98967543057578578, 0.98967698768071199, 0.98967849608130043, 0.98967995747991655, 0.98968137348797292, 0.98968274563272429, 0.98968407536377134, 0.98968536405920116, 0.98968661303134187, 0.98968782353232265, 0.98968899675916144, 0.98969013385856885, 0.9896912359313258, 0.98969230403630182, 0.98969333919400604, 0.98969434238983389, 0.98969531457692528, 0.98969625667861594, 0.98969716959072374, 0.98969805418342816, 0.98969891130288901, 0.98969974177261755, 0.98970054639439153, 0.98970132594885529, 0.98970208119551661, 0.98970281287238893, 0.98970352169496556, 0.98970420835485162, 0.98970487351815517, 0.9897055178239238, 0.98970614188299189, 0.98970674627762711, 0.98970733156233204, 0.98970789826590977, 0.98970844689475557, 0.98970897793718404, 0.9897094918681949, 0.98970998915428376, 0.98971047025762326, 0.98971093563932844, 0.98971138576152717, 0.98971182108815947, 0.98971224208468911, 0.98971264921698754, 0.98971304294955686, 0.98971342374348747, 0.98971379205436205, 0.98971414833027838, 0.989714493010037, 0.98971482652179854, 0.98971514928191162, 0.98971546169421154, 0.98971576414955953, 0.98971605702570009, 0.98971634068726377, 0.9897166154860666, 0.98971688176137329, 0.98971713984034948, 0.98971739003849712, 0.98971763266002488, 0.98971786799835137, 0.98971809633634655, 0.98971831794670373, 0.98971853309217217, 0.98971874202576038, 0.98971894499089375, 0.98971914222160118, 0.98971933394261802, 0.98971952036957189, 0.98971970170908785, 0.98971987815894413, 0.98972004990827556, 0.98972021713777814, 0.98972038001991702, 0.98972053871911314, 0.98972069339210345, 0.98972084418811213, 0.9897209912492001, 0.98972113471051704, 0.98972127470059723, 0.98972141134169178]}
vb_all_performances = eval(open(folder+'nmf_vb_performances.txt','r').read())

# Gibbs NMF
#gibbs_all_performances = {'R^2': [-662.9645488569937, -13.400122105593619, 0.17645193260128889, 0.6127782497604785, 0.7160099989922473, 0.799814985379875, 0.8550238723756092, 0.8851742486400449, 0.9045722692416157, 0.9164347408803937, 0.9236840810072953, 0.9297835079407162, 0.9355958044926235, 0.9392973352689515, 0.9424581113630625, 0.9444747099045256, 0.9465151361759567, 0.9485159678073823, 0.9491306188626712, 0.9501370627729735, 0.9516156973704143, 0.9525007119739566, 0.9533749694191433, 0.9541311587947142, 0.9550496291734387, 0.956379709543472, 0.9567269656200018, 0.9575168811827212, 0.9585182258460548, 0.9599378612640316, 0.9612796410631373, 0.961737954848491, 0.963070417460247, 0.9638160813763882, 0.9646865044019588, 0.9653743013523047, 0.9656482136757404, 0.9671666565754226, 0.9673712789626085, 0.9680438410991379, 0.9681511996606362, 0.968124655182077, 0.9685789831292737, 0.9685698791021364, 0.9688806661436373, 0.9691126546216264, 0.969591130150267, 0.9696148703746454, 0.9697765567805054, 0.9698402059637805, 0.9700546706960205, 0.9698037372627691, 0.9700401609405201, 0.9702163875362128, 0.969882716871385, 0.970283850618909, 0.9701937047420437, 0.9704534318958341, 0.9702202892856838, 0.9697828656570893, 0.9706386434854384, 0.9705085619239673, 0.9706182157415084, 0.9708256784364551, 0.9710764562903704, 0.9710075142726129, 0.9708353952455039, 0.9709331764462326, 0.9710071161557902, 0.9713005025262038, 0.9715869504052802, 0.971659854980303, 0.9714568128764176, 0.9719050358554164, 0.9724060939978977, 0.9722569492280279, 0.9720255908865315, 0.9723860693790372, 0.9724102719397947, 0.9725964825118425, 0.9725020963895517, 0.972489550018548, 0.9728747978627297, 0.9724732600719914, 0.9723193208686822, 0.9728163682146905, 0.9726870751424986, 0.973004933686741, 0.97277255554827, 0.9727858642175812, 0.9727510852975857, 0.972815451951981, 0.9729410188432301, 0.973056579849678, 0.9729231302691518, 0.973044390031468, 0.9728730907500651, 0.9730371793626005, 0.9730538678908851, 0.9734646162540909, 0.9731357254561516, 0.9732002301298573, 0.973213068415841, 0.9733230900838107, 0.9734592172300852, 0.9732950841173753, 0.9733187281458402, 0.9733613704282363, 0.9733041752541992, 0.9734447422317685, 0.9734403844320773, 0.9737299611116508, 0.9738350446907542, 0.9737207575087727, 0.9737620393919808, 0.9733917044385539, 0.9736063026596005, 0.9733121789189136, 0.9734918180005631, 0.9733402060693486, 0.9738321258675074, 0.9735330545881331, 0.9739889076457805, 0.9740587034980054, 0.9740248815774921, 0.9739553996681505, 0.9739830068035329, 0.974086208464017, 0.9740193918961417, 0.9739298751678279, 0.9739440348762471, 0.9742561307176453, 0.9740948461367266, 0.9740159522162681, 0.9738337528188152, 0.9739035797422545, 0.9737619319032488, 0.9741174414839576, 0.974242714871886, 0.9740222468191709, 0.9737633948480687, 0.9739141222608309, 0.973777254453234, 0.9739636841217783, 0.9740549792888916, 0.9741498259553937, 0.9740229234247583, 0.9744360985909937, 0.9742924496773906, 0.9744291130620703, 0.9745703659073174, 0.9744194223440288, 0.9741908668331777, 0.9742901628371125, 0.9742589756077683, 0.9743963390625072, 0.9739869182347995, 0.9741009817774022, 0.9742231750753376, 0.9741231909256389, 0.9745217211783955, 0.9742570751136441, 0.9742913376218282, 0.9744350656568305, 0.9737190256113751, 0.9740659215808045, 0.9745822421444627, 0.9741563502191798, 0.9743349436619991, 0.9742047055442487, 0.9739407261438568, 0.9738733404084772, 0.9738327476467455, 0.9743037910227257, 0.9744508000376574, 0.9739406996266857, 0.974096634787515, 0.9736489401932201, 0.9740982179857969, 0.9743641633336505, 0.9745007693040291, 0.9742889527411374, 0.9742150067479828, 0.974447348049596, 0.9749209801755785, 0.9746747308445618, 0.974504901556999, 0.9744632995819718, 0.9742063413652295, 0.9742798145511095, 0.9746632170572623, 0.9742877764843395, 0.9745946934443861, 0.9743352520783995, 0.9744455850379188, 0.9743220021009478, 0.9743422598055358, 0.9742022719312583, 0.9740954722931322, 0.974002577675045], 'MSE': [26108.575146577328, 566.24509661095919, 32.38375699653335, 15.226427648767766, 11.167123749229647, 7.8717237334819217, 5.7007864788221392, 4.5152060653004735, 3.7524323909486998, 3.2859734019283664, 3.0009130899099987, 2.7610699435907886, 2.5325174078252841, 2.3869649162088318, 2.2626761114576373, 2.1833789341446233, 2.1031447970503794, 2.0244676100007788, 2.0002981520175798, 1.9607225202942062, 1.9025792917617912, 1.8677785327119623, 1.8334007692539458, 1.8036657070866624, 1.7675493919247824, 1.7152476487793362, 1.7015927610525885, 1.6705315095682822, 1.6311563916718885, 1.5753331431945492, 1.5225713522594468, 1.5045494263505745, 1.4521540081178927, 1.4228328306210245, 1.3886058451418424, 1.361560126519352, 1.3507892796536505, 1.2910806993982948, 1.2830344882237472, 1.2565878366479262, 1.2523662572347878, 1.2534100456635251, 1.2355448518500984, 1.2359028426149046, 1.2236819991352681, 1.2145596918959056, 1.1957449610238802, 1.19481144215868, 1.1884535700631871, 1.1859507414296127, 1.177517507173937, 1.18738477254241, 1.178088063301505, 1.1711584383322409, 1.1842791172026088, 1.168505638619926, 1.1720503766700887, 1.1618373224881779, 1.1710050127925127, 1.1882054908868738, 1.1545543874074953, 1.1596694861408519, 1.155357652112496, 1.1471997536667917, 1.1373386060267285, 1.1400495607824839, 1.1468176669429249, 1.1429726908345736, 1.1400652156288202, 1.1285286055611379, 1.1172648325339232, 1.1143980611395921, 1.1223821320306306, 1.1047569992584707, 1.085054269363785, 1.0909189762047857, 1.100016505064036, 1.085841682286961, 1.084889983318446, 1.0775677660076479, 1.0812792400176168, 1.0817725914634599, 1.0666237822277997, 1.0824131486958279, 1.0884663834122292, 1.068921367029948, 1.0740054605964866, 1.0615065497696656, 1.0706441793330754, 1.0701208526081631, 1.0714884377417091, 1.068957396534602, 1.0640198247595125, 1.0594757068151823, 1.0647232436113061, 1.0599550378055269, 1.0666909097263451, 1.0602385774769012, 1.0595823471170791, 1.043430800282912, 1.0563635240673344, 1.0538270556314016, 1.0533222254338674, 1.0489959267016771, 1.0436431020153059, 1.0500971841114128, 1.0491674478852755, 1.0474906577068257, 1.0497397002226374, 1.0442122914124659, 1.0443836498696391, 1.0329968453898581, 1.0288647233866335, 1.0333587516961127, 1.0317354554647322, 1.0462978563904926, 1.0378593730555645, 1.0494249781760994, 1.0423611666057655, 1.0483228877639912, 1.0289794980627953, 1.040739651500457, 1.0228144869237183, 1.0200699574817924, 1.0213999112494179, 1.0241320957530853, 1.0230465212748177, 1.0189884005323238, 1.0216157778319239, 1.0251357763500391, 1.0245789848587536, 1.0123066764318913, 1.0186487478695123, 1.0217510337587867, 1.0289155226885778, 1.0261697714568172, 1.03173968216274, 1.0177602481413845, 1.0128342175751095, 1.0215035158556247, 1.0316821558914457, 1.0257552159824967, 1.0311371651331567, 1.0238063324567472, 1.0202164017364983, 1.0164868180952678, 1.0214769102064958, 1.0052299360345662, 1.0108785334815045, 1.0055046226984099, 0.99995024403293664, 1.0058856834653525, 1.0148729987376708, 1.0109684571699773, 1.0121948089719632, 1.0067933698640821, 1.0228927150251752, 1.0184074807176298, 1.0136025661976511, 1.0175341672001004, 1.0018630638705739, 1.0122695406632007, 1.0109222620002454, 1.0052705533224431, 1.0334268537859443, 1.0197861262780026, 0.99948324375332998, 1.0162302694111123, 1.0092075747046552, 1.0143288295820259, 1.0247090916368968, 1.0273588498792532, 1.0289550483086773, 1.0104325663474822, 1.0046518421805433, 1.0247101343515337, 1.0185784141090746, 1.0361827696096564, 1.018516159201958, 1.0080585916838252, 1.0026869385598165, 1.0110160408576232, 1.0139237631485032, 1.0047875820929564, 0.98616330467583468, 0.9958463806393193, 1.0025244491055603, 1.0041603320651473, 1.0142645054323718, 1.0113753749839074, 0.99629912857811476, 1.0110622939129292, 0.99899363071557989, 1.0091954470801001, 1.0048569076660436, 1.0097164659094724, 1.0089198875327439, 1.0144245247027166, 1.0186241259953506, 1.02227695071501], 'Rp': [0.0080868070913401556, 0.042026223945636883, 0.59222743921272136, 0.79135543266300012, 0.84700781873695985, 0.8943931917088791, 0.92471565460541638, 0.94084666443884091, 0.95115549337148864, 0.95738527037014032, 0.96113184845078126, 0.96432147219662379, 0.96732090547488569, 0.96920689106411473, 0.97085131948347902, 0.97190493295618596, 0.97295434848452356, 0.97397577245368705, 0.97430866926993853, 0.97477209348082894, 0.9755840866775537, 0.97598169789255962, 0.97645462211220313, 0.97682035007411383, 0.9773323645910047, 0.97799088176935656, 0.97813767699212595, 0.97855375517161403, 0.9790576078167974, 0.97980329463625715, 0.98050743093921455, 0.98074923071955955, 0.98141156773455307, 0.98179593844230639, 0.98222492421364427, 0.98256994391337715, 0.98268942106924551, 0.98349468898837145, 0.9835832998382763, 0.98393993200680263, 0.98400915014156776, 0.98394630830981678, 0.98420290129535892, 0.98418737012471402, 0.98436030955607023, 0.98447706207319485, 0.9846949839062008, 0.98472613093495931, 0.98487440509414526, 0.98483063043650287, 0.98493012041522265, 0.98483171775360023, 0.98491502550391052, 0.98503037006280436, 0.98485719198847865, 0.98505644156273087, 0.98501585114333545, 0.98512560959037132, 0.98503049870854809, 0.98479297943764255, 0.9852176498783507, 0.98516921403608126, 0.98521857205375774, 0.98531850236608198, 0.98545195981485034, 0.98541076480898571, 0.98533846384647772, 0.98537132890907309, 0.98540914012690428, 0.98556628581187966, 0.98570938306278655, 0.98577031748674904, 0.98564352973595348, 0.98585945776649253, 0.98612418793907486, 0.98603471989677971, 0.98592340358776831, 0.98610201537763387, 0.98614859189570847, 0.98621360039966144, 0.98615996904527814, 0.98615599519649455, 0.98635135455433642, 0.98614810294603916, 0.98607592557698542, 0.9863202712995971, 0.9862576071095589, 0.9864194243557789, 0.98630549866876893, 0.98631077035568671, 0.98629987723891899, 0.98631874179751966, 0.98639103231592984, 0.98644675307853591, 0.9863954063341539, 0.98643928866975916, 0.98635164342370263, 0.98644883668903149, 0.98645085125041942, 0.98665910979403293, 0.98648132761751639, 0.98651283778243026, 0.98653098528808036, 0.98657975847266155, 0.98666758773949603, 0.98656246288578997, 0.98657133457052482, 0.9866014652698557, 0.9865628044945659, 0.98663861365550176, 0.9866340269355659, 0.98678619655891464, 0.98683857676654041, 0.98678087515615209, 0.98680228300856632, 0.98661291970907405, 0.98672016232084037, 0.98656710690285643, 0.98666962796110202, 0.98658936483551651, 0.98683520437105099, 0.98669057388738268, 0.9869124903726999, 0.9869477842799389, 0.98693035265881224, 0.98689229416564395, 0.98690577790662204, 0.98696402056495169, 0.98692469970457253, 0.98688434618343401, 0.98688742855025258, 0.98704573674723739, 0.98696331021007089, 0.98692471031452111, 0.98683540680770965, 0.98688760284975541, 0.98680500683905215, 0.98698236512258952, 0.9870378715485274, 0.98692754071474265, 0.98679452127912048, 0.98687584358773794, 0.98680349172780313, 0.98689776941643281, 0.98694236520262413, 0.9870031525311751, 0.98693138982150852, 0.98713940455571847, 0.98706894852779681, 0.98713533097107753, 0.98720473384545226, 0.9871298662096909, 0.987017813997912, 0.98706795380857282, 0.98705057605797997, 0.98711603583059226, 0.98690955920502577, 0.98696920319270831, 0.98703045053091032, 0.98698006489848977, 0.98717929411172267, 0.9870462374213097, 0.98706275007825484, 0.98713976668877412, 0.98677271611344775, 0.98695854021310025, 0.98721002672016633, 0.98699413380974965, 0.98708624978334292, 0.98701896628494501, 0.98688478939624746, 0.98685337709208221, 0.98683281943131707, 0.98707049303729699, 0.98714735547368149, 0.98689317510559904, 0.98696340233636315, 0.9867450509470358, 0.98696559555749919, 0.9871018766188282, 0.98718032895287011, 0.98707148819274693, 0.9870233947751097, 0.98714332799539928, 0.98738579223844425, 0.98725630745290816, 0.9871772239220199, 0.98715020967728984, 0.98702275573789511, 0.98705818888693519, 0.98725159225244863, 0.98706074448914005, 0.98721712506321035, 0.98708655224867037, 0.98714139887910612, 0.98707831469671858, 0.98710027893298424, 0.98701861669410729, 0.98696577836800992, 0.98692203806319778]}
gibbs_all_performances = eval(open(folder+'nmf_gibbs_performances.txt','r').read())

# ICM NMF
#icm_all_performances = {'R^2': [-3.011325221921278, 0.6122247892013752, 0.6466573083285352, 0.7009971539050444, 0.7516170229311595, 0.7907776368331421, 0.8234330007573292, 0.8439394309755051, 0.863190988228737, 0.875907208593979, 0.8863902136389366, 0.8956711204838093, 0.9030691260197806, 0.9093572010424538, 0.915006474554024, 0.9208683743857938, 0.9297717022302099, 0.9382762694219999, 0.9440805949318114, 0.9481637834640294, 0.9512339963214808, 0.9536824976757972, 0.9557067102933176, 0.9574117113766332, 0.9588800821133757, 0.9601711935524039, 0.9613289552855884, 0.9623773397863895, 0.9633363247611982, 0.9642260298165124, 0.9650591336929771, 0.9658476771519857, 0.9665981939045396, 0.9673144124559565, 0.9679974803398015, 0.9686491553083643, 0.969270689248866, 0.9698621475376464, 0.9704231637295726, 0.9709522041051154, 0.9714462525541149, 0.9719082527778845, 0.9723401535497302, 0.9727429011312829, 0.9731153722352602, 0.9734587356715676, 0.973774679558256, 0.9740650713542474, 0.974331384589147, 0.9745760048935016, 0.9748003226577837, 0.9750056187155984, 0.9751933204372832, 0.9753656793342897, 0.975524450646072, 0.9756705826874299, 0.9758048782658982, 0.9759279983494072, 0.9760414435441985, 0.9761464198666829, 0.9762439737494745, 0.9763349709416392, 0.9764200978273005, 0.9765000143023518, 0.9765752982876535, 0.9766464029077505, 0.9767137870977944, 0.976777763158665, 0.9768385275485062, 0.976896216756862, 0.9769508565927314, 0.9770027176525754, 0.9770520143237956, 0.9770989747053823, 0.9771437967041209, 0.9771867068689287, 0.9772279068848454, 0.9772675330411751, 0.9773057059437851, 0.977342545050111, 0.9773781524421333, 0.9774125855589668, 0.9774458879203755, 0.9774780881680812, 0.9775092418374954, 0.9775394190363488, 0.9775686807741273, 0.9775970857638983, 0.9776246782141919, 0.9776514555564746, 0.9776773801685651, 0.9777025450581172, 0.977726974765106, 0.9777507057351827, 0.977773769986438, 0.9777961961130616, 0.9778180098685153, 0.9778391179450548, 0.9778594233471256, 0.9778791331558111, 0.9778982737730811, 0.9779168751767531, 0.9779349635705069, 0.9779525633727618, 0.9779697029026608, 0.9779863975071169, 0.9780026731155237, 0.9780185484716732, 0.9780340431606896, 0.978049172458006, 0.9780639490962261, 0.9780783664143862, 0.9780924240341047, 0.9781061480430513, 0.9781195515938678, 0.9781326453125075, 0.9781454390967911, 0.9781579418980331, 0.9781701632363203, 0.9781820969824855, 0.9781937497906589, 0.9782051380898764, 0.978216273617541, 0.97822716702872, 0.9782378275386251, 0.9782482636447294, 0.9782584834847775, 0.9782684969305622, 0.9782783083736516, 0.9782879238019593, 0.9782973496940097, 0.9783065918326681, 0.9783156553899555, 0.9783245452786685, 0.9783332660090225, 0.9783418221871046, 0.9783502214956838, 0.9783584688467293, 0.9783665679674812, 0.9783745221792527, 0.9783823342804722, 0.9783900075324913, 0.9783975455379338, 0.9784049516509242, 0.9784122290694917, 0.9784193810552732, 0.9784264109568401, 0.9784333215540182, 0.9784401168331144, 0.9784467972138723, 0.9784533657094477, 0.9784598251188316, 0.9784661780178132, 0.9784724286406051, 0.9784785765210536, 0.9784846246945589, 0.978490574938382, 0.9784964292070676, 0.9785021897245386, 0.9785078585313441, 0.9785134375766608, 0.9785189319154892, 0.9785243441381586, 0.9785296707472255, 0.9785349069305831, 0.9785400576798384, 0.9785451209562008, 0.9785501068063127, 0.9785550178068111, 0.9785598562371592, 0.9785646239133954, 0.9785693226602352, 0.9785739542582257, 0.9785785205438549, 0.9785830231596911, 0.978587463615462, 0.9785918433520977, 0.9785961637047367, 0.978600426176705, 0.9786046321511963, 0.9786087828566364, 0.9786128794436941, 0.9786169229892924, 0.978620914517937, 0.9786248550197832, 0.9786287454611107, 0.9786325867887052, 0.9786363799307498, 0.9786401256273268, 0.9786438249257021, 0.9786474789102443, 0.9786510881686012, 0.9786546542740576, 0.9786581782334028, 0.9786616608794534, 0.9786651029885662, 0.9786685052959115, 0.9786718685109778, 0.978675193270265, 0.9786784797118755], 'MSE': [157.73430399888665, 15.248190959207893, 13.894227084683257, 11.757462487642595, 9.7669757114233438, 8.2270925465674658, 6.9430104002824189, 6.1366515739550778, 5.3796371669360417, 4.8796068632731462, 4.4673915944769593, 4.1024455228758825, 3.8115393535582398, 3.5642781412850848, 3.3421360370804134, 3.1116329891045242, 2.7615341706047785, 2.4271155152741462, 2.1988764187606522, 2.0383162882317287, 1.9175886330538321, 1.8213080685030361, 1.7417114886432217, 1.674667022209924, 1.6169273916991174, 1.5661579943171295, 1.5206322064347553, 1.4794073766320301, 1.441697936689287, 1.4067127385564253, 1.373953225716426, 1.3429459284272729, 1.3134339265191106, 1.2852706068008652, 1.2584108456791596, 1.2327855243918189, 1.208345415925679, 1.1850879495364341, 1.1630275346685524, 1.142224480613619, 1.1227973875874049, 1.1046305026523751, 1.0876471956715863, 1.0718102575155173, 1.0571638583593252, 1.0436620379762187, 1.0312384157784562, 1.0198195590930468, 1.0093475254311981, 0.99972850644951539, 0.99090782887636197, 0.98283512746183466, 0.97545427480308333, 0.96867673642031549, 0.96243349236169251, 0.95668725276248079, 0.95140644942993569, 0.94656509162268587, 0.94210417213786168, 0.93797626770544396, 0.93414023024819359, 0.9305620165711973, 0.92721463651135805, 0.92407214148219363, 0.92111180633934875, 0.91831581320949329, 0.91566611573320567, 0.91315043353948344, 0.91076104145351322, 0.90849257240031112, 0.90634401151215838, 0.9043047183293389, 0.90236626265840725, 0.90051967513550812, 0.89875717362198382, 0.89706984970632575, 0.89544977268044479, 0.89389158334325391, 0.89239053920155542, 0.89094194292108075, 0.8895417804094069, 0.88818779303172968, 0.88687826949332238, 0.88561208353744347, 0.88438705138716822, 0.88320041624929679, 0.88204977909400717, 0.88093283119181676, 0.879847834164179, 0.87879488901158076, 0.87777547512257825, 0.87678593522762871, 0.87582530435987571, 0.87489214939457238, 0.87398521130859863, 0.87310336571426961, 0.87224559992771622, 0.87141558301871114, 0.87061712906998723, 0.86984209518892353, 0.8690894431908508, 0.86835799428075899, 0.86764671807118854, 0.86695465437512453, 0.8662806896203562, 0.86562422033184516, 0.8649842269076814, 0.86435997229992823, 0.86375068637758001, 0.86315576847634679, 0.86257471792169738, 0.86200779663765459, 0.86145501950304237, 0.86091536069217323, 0.86038830301368052, 0.85987342863123994, 0.85937034834035375, 0.85887871015525485, 0.85839813972478196, 0.8579288780615355, 0.85747066351018941, 0.85702285004420875, 0.85658497612258366, 0.85615662276416882, 0.85573742760618043, 0.85532705650891405, 0.85492518947799712, 0.85453143833240564, 0.85414563038582314, 0.85376753018006835, 0.8533968829650258, 0.85303346134546332, 0.85267706194591431, 0.85232749158420296, 0.85198457290854068, 0.85164812479725416, 0.85131784514663356, 0.85099354080704281, 0.85067506521502889, 0.85036228776911549, 0.85005509842882376, 0.8497533689504887, 0.8494569576708636, 0.84916573269825701, 0.84887956827898092, 0.8485983361581636, 0.84832190466246238, 0.84805016448289794, 0.84778295886893829, 0.8475202713153247, 0.84726198333801117, 0.84700798487439988, 0.84675817463867775, 0.84651238613211321, 0.84627063768491595, 0.84603280993833896, 0.84579883300649417, 0.84556863003229732, 0.84534211356611799, 0.84511920336899038, 0.84489982279490938, 0.84468377306992015, 0.84447095233647151, 0.84426149812187212, 0.84405559964896826, 0.84385306063656762, 0.84365396125449776, 0.84345790644623908, 0.84326479489265405, 0.84307453696012746, 0.84288706123796631, 0.8427022959742555, 0.84252017115390265, 0.84234061456207177, 0.84216356160928918, 0.84198895292968789, 0.84181673186265349, 0.84164684590755723, 0.84147923595023777, 0.8413138476004226, 0.84115063255365174, 0.8409895455630545, 0.84083054428159665, 0.84067358842341477, 0.84051863905338364, 0.8403656581752259, 0.84021460855919117, 0.84006545370704999, 0.83991816451709866, 0.83977269980849656, 0.83962901694143854, 0.83948709280829625, 0.83934686554397742, 0.83920829555927523, 0.839071350105973, 0.83893599865597379, 0.83880221230074248, 0.83866996314159414, 0.83853922614992127, 0.83840999589523302], 'Rp': [1.6650962751468002e-15, 0.7882267556563668, 0.81082005528312073, 0.84464755790440516, 0.87567154425592608, 0.89567605777854831, 0.911986474659361, 0.92304281921242981, 0.93245470293748689, 0.93857273971410227, 0.94411945168132871, 0.94835723957754248, 0.95195145202385845, 0.95508993701257561, 0.95790030948654403, 0.96112138648840095, 0.9655802028904521, 0.96976645853939103, 0.97255329793700007, 0.97450727939084725, 0.97599219525555536, 0.97717828980609389, 0.97815684773681111, 0.97897956277920639, 0.97968676041250824, 0.98030924782559825, 0.98086951941481348, 0.98137679317533166, 0.98184100134932395, 0.98227194231377801, 0.98267497979445817, 0.98305735022283247, 0.98342179300312593, 0.98376909949134639, 0.9841001154676412, 0.98441616710411484, 0.9847182706846539, 0.98500512484919034, 0.98527698390593077, 0.98553408169324486, 0.98577449886363677, 0.98599917346746624, 0.98620932631755143, 0.98640550554917072, 0.9865868263181865, 0.9867536070100219, 0.98690681008646364, 0.98704761771464311, 0.98717649401586283, 0.98729477309369285, 0.98740323712604328, 0.98750289398249202, 0.98759388723536434, 0.9876777408145121, 0.98775516856171364, 0.98782635223676929, 0.98789172050533436, 0.98795168375928677, 0.98800700316719514, 0.98805814337109588, 0.9881055964379204, 0.98814992588862671, 0.98819142608497657, 0.98823040016646768, 0.98826719659451212, 0.98830201978397603, 0.98833499476344389, 0.98836627741257366, 0.98839598124796169, 0.98842416526715737, 0.98845086882148236, 0.98847619957360466, 0.98850027249993688, 0.98852321409437904, 0.98854514246087655, 0.98856613598959342, 0.9885862900991409, 0.98860570614489096, 0.98862437069829079, 0.98864237583615411, 0.98865978949058841, 0.98867666989755565, 0.98869300426966844, 0.9887088025123586, 0.98872408501692555, 0.98873888627440343, 0.98875323786819735, 0.98876716833191103, 0.98878070763457426, 0.98879385628954841, 0.98880659388404946, 0.9888189381784126, 0.98883091673148737, 0.98884254993184817, 0.9888538545464316, 0.98886484435794753, 0.98887553158327124, 0.98888588614974082, 0.98889585916406963, 0.98890551656138648, 0.98891488565733354, 0.98892398781654889, 0.98893283506035368, 0.98894144940568662, 0.9889498420376277, 0.98895801680383988, 0.98896598275884429, 0.98897376288288286, 0.98898135704831713, 0.98898876886754861, 0.98899600495164453, 0.98900306515083236, 0.98900994598910519, 0.98901666055021531, 0.98902321701864448, 0.98902962089292512, 0.98903587709749796, 0.98904199029598217, 0.98904796555866281, 0.98905380683161292, 0.98905950874391446, 0.98906507915584196, 0.98907052519077776, 0.98907585069839266, 0.989081061329811, 0.98908616169840469, 0.98909115619310806, 0.98909605100892106, 0.98910084784303032, 0.98910554868545331, 0.9891101563168726, 0.98911467358897287, 0.98911910312636953, 0.98912344735955438, 0.98912770868844768, 0.98913189183769146, 0.98913599967536969, 0.98914003338198853, 0.98914399398336661, 0.98914788290824585, 0.98915170287281684, 0.98915545495386625, 0.98915914071032474, 0.98916276166326567, 0.98916631935387, 0.98916981549582716, 0.98917325157574698, 0.98917662884985613, 0.9891799512710493, 0.98918321660701081, 0.98918642658930078, 0.98918958320466677, 0.98919268791997528, 0.98919574438331481, 0.98919874928050555, 0.98920170497979909, 0.98920461252591718, 0.98920747295473088, 0.98921028736744432, 0.9892130567333659, 0.9892157819823445, 0.98921846634463872, 0.98922111229721765, 0.98922371515115415, 0.98922627523133499, 0.98922879624153026, 0.98923127856514548, 0.98923372177022806, 0.98923612780812831, 0.98923849797795116, 0.98924083352487735, 0.98924313552631349, 0.98924540519104887, 0.98924764297266665, 0.98924984937654337, 0.98925202506649701, 0.98925417065134291, 0.98925628688189982, 0.98925837456179899, 0.98926043422646315, 0.98926246637546478, 0.98926447159299391, 0.98926645045616168, 0.98926840351631695, 0.98927033129934649, 0.9892722343101118, 0.98927411303670243, 0.98927596795333295, 0.98927779952148565, 0.98927960946775573, 0.98928139939093485, 0.98928316617733236, 0.98928491243112571, 0.9892866382350306, 0.98928834382235475, 0.98929002950129463, 0.98929169564596531, 0.98929334257207657, 0.98929497053647408, 0.98929658161386502]}
icm_all_performances = eval(open(folder+'nmf_icm_performances.txt','r').read())

# Non-probabilistic NMF
#np_all_performances = {'R^2': [0.3032122365329063, 0.6133166405978905, 0.6431376044334463, 0.6593067085963278, 0.6717514727663727, 0.68228506665832, 0.6917125664190896, 0.7005339760645299, 0.7090723817749585, 0.7175252245809353, 0.7259934237903767, 0.7345036350654565, 0.7430317677039082, 0.75152937384811, 0.7599480851429183, 0.7682550228175197, 0.776436085576062, 0.784490285163333, 0.7924211663319218, 0.8002297289193113, 0.8079102319907545, 0.8154484610474781, 0.8228217510909723, 0.8300003544925733, 0.8369499438010377, 0.8436350246711801, 0.8500228818826858, 0.8560874492822713, 0.8618123094412313, 0.8671921091902559, 0.8722321105692831, 0.876946185389484, 0.8813539787340927, 0.8854780322176982, 0.8893414329509705, 0.8929662251700472, 0.896372547257493, 0.8995783054041361, 0.9025991611102144, 0.905448654072977, 0.9081383595637647, 0.9106780524041636, 0.9130758947401676, 0.9153386756498996, 0.9174721151698999, 0.9194812187586701, 0.9213706451927918, 0.923145040566608, 0.9248092957077478, 0.9263687005314527, 0.9278289900920716, 0.9291962964751085, 0.9304770333355508, 0.9316777441364161, 0.9328049422236668, 0.9338649637036158, 0.9348638457429038, 0.9358072355984199, 0.9367003304354385, 0.9375478448843411, 0.9383540018746, 0.9391225419794407, 0.9398567467937639, 0.9405594723975267, 0.941233189525269, 0.9418800275807032, 0.9425018200834387, 0.9431001495282554, 0.9436763900026273, 0.9442317462684834, 0.9447672883809836, 0.9452839812873185, 0.9457827092068222, 0.9462642949174859, 0.9467295143403786, 0.9471791070055592, 0.9476137830938077, 0.9480342277817988, 0.9484411035871358, 0.9488350513324426, 0.9492166902442043, 0.9495866175899556, 0.9499454081501066, 0.9502936137267446, 0.9506317628149454, 0.9509603605031547, 0.9512798886262251, 0.9515908061651354, 0.9518935498682876, 0.9521885350579884, 0.9524761565801545, 0.9527567898538667, 0.9530307919790423, 0.953298502864411, 0.953560246343582, 0.9538163312538315, 0.954067052459742, 0.9543126918115871, 0.9545535190357457, 0.9547897925610067, 0.9550217602898616, 0.9552496603275022, 0.9554737216830019, 0.9556941649570642, 0.9559112030289433, 0.9561250417519456, 0.9563358806627454, 0.9565439137050391, 0.9567493299633228, 0.956952314398204, 0.9571530485710693, 0.9573517113433512, 0.9575484795342386, 0.9577435285205056, 0.9579370327630805, 0.9581291662469268, 0.9583201028234776, 0.9585100164480038, 0.9586990813076265, 0.9588874718388863, 0.9590753626367163, 0.9592629282590452, 0.9594503429330747, 0.9596377801704293, 0.9598254122988978, 0.9600134099184604, 0.9602019412888035, 0.9603911716547099, 0.9605812625147117, 0.9607723708373238, 0.960964648228191, 0.961158240050655, 0.961353284501683, 0.9615499116448762, 0.9617482424024153, 0.9619483875083532, 0.9621504464266579, 0.9623545062388184, 0.9625606405076733, 0.9627689081263755, 0.9629793521640283, 0.9631919987224604, 0.9634068558217966, 0.9636239123357836, 0.9638431370011578, 0.964064477528489, 0.9642878598447232, 0.9645131874998351, 0.9647403412713568, 0.9649691790007782, 0.9651995356947132, 0.9654312239210366, 0.9656640345257972, 0.9658977376905069, 0.9661320843414578, 0.9663668079131659, 0.9666016264572074, 0.9668362450760232, 0.9670703586492495, 0.9673036548084315, 0.9675358171052365, 0.9677665283091601, 0.9679954737637889, 0.9682223447264301, 0.9684468416146467, 0.9686686770850869, 0.9688875788749307, 0.969103292344028, 0.9693155826659883, 0.9695242366285453, 0.9697290640168207, 0.9699298985669633, 0.9701265984913543, 0.9703190465894936, 0.9705071499702334, 0.9706908394207924, 0.970870068465593, 0.9710448121632769, 0.9712150656932355, 0.9713808427837262, 0.9715421740323554, 0.9716991051667034, 0.9718516952884712, 0.9720000151391545, 0.9721441454192552, 0.9722841751867779, 0.9724202003545587, 0.972552322300062, 0.972680646595887, 0.9728052818644556, 0.9729263387563182, 0.9730439290482211, 0.9731581648545349, 0.9732691579438102, 0.9733770191510263, 0.9734818578754834, 0.9735837816541444, 0.9736828958005008, 0.9737793030996176, 0.973873103550837], 'MSE': [27.399257558274289, 15.20525691358168, 14.032629735542894, 13.396824297110738, 12.907468259842803, 12.493263724126439, 12.122553290305664, 11.775675679109096, 11.439926417335327, 11.107541680858105, 10.774553096156563, 10.439912502812888, 10.104567201268855, 9.7704222699410597, 9.4393796610303511, 9.1127322415429362, 8.7910345060569508, 8.4743253149837283, 8.162465280701575, 7.8554150873583133, 7.5534004813834965, 7.2569804087480039, 6.967046108024455, 6.6847673226874669, 6.411493885106732, 6.148621512538762, 5.8974366408173555, 5.6589642495486725, 5.4338499088490657, 5.2223041173414577, 5.0241199598142039, 4.8387519655414986, 4.6654276457921826, 4.503260613726126, 4.3513430323738893, 4.2088080729315367, 4.0748638490318934, 3.9488062490930589, 3.8300194278013406, 3.7179709738951754, 3.6122057217453727, 3.5123393034449846, 3.4180507651081431, 3.3290731449570705, 3.2451815183265595, 3.1661790593625017, 3.0918825745213767, 3.022109368953747, 2.9566671243484737, 2.8953478293744874, 2.8379259688326601, 2.7841604153684467, 2.7337989696837179, 2.6865843281374646, 2.6422603713588617, 2.6005779494375738, 2.5612996674416277, 2.5242034625649303, 2.4890849706131246, 2.4557588017460175, 2.424058900905905, 2.3938381803645279, 2.3649676004506817, 2.3373348536950753, 2.3108427852744402, 2.2854076622591495, 2.2609573865460915, 2.2374297308914373, 2.2147706630940118, 2.1929328092128246, 2.1718740922791593, 2.1515565684053737, 2.1319454681042029, 2.1130084378997616, 2.094714966835455, 2.0770359749308032, 2.0599435362848069, 2.0434107082139512, 2.0274114390402396, 2.0119205301809138, 1.9969136322618262, 1.9823672593840194, 1.9682588098926799, 1.9545665856922183, 1.9412698051709747, 1.9283486071185023, 1.9157840447077645, 1.9035580697773249, 1.8916535084005006, 1.8800540291727479, 1.8687441058670919, 1.8577089761633205, 1.8469345980918024, 1.8364076056789749, 1.8261152650610468, 1.8160454320636972, 1.8061865119502274, 1.7965274217357818, 1.7870575551742123, 1.7777667502659633, 1.768645258929094, 1.7596837183334506, 1.7508731233286758, 1.7422047994003589, 1.7336703756587923, 1.7252617574903006, 1.7169710986653441, 1.7087907728828211, 1.7007133449162777, 1.6927315416998205, 1.6848382238325299, 1.6770263580817495, 1.6692889915204125, 1.6616192279404429, 1.6540102071468659, 1.6464550876607285, 1.638947033253777, 1.63147920361462, 1.6240447493150174, 1.6166368111189668, 1.6092485235621385, 1.6018730226352913, 1.5945034573341075, 1.5871330047923813, 1.5797548886949737, 1.572362400668047, 1.5649489243633816, 1.5575079619855172, 1.5500331630499766, 1.5425183552027111, 1.5349575769697661, 1.5273451123385378, 1.5196755270943338, 1.5119437068446611, 1.5041448966581834, 1.496274742223592, 1.4883293323945916, 1.4803052429317463, 1.4721995811792468, 1.4640100313262552, 1.4557348997990296, 1.4473731602151247, 1.4389244972052531, 1.4303893482786443, 1.4217689427769382, 1.4130653368377961, 1.4042814431798316, 1.395421054434353, 1.3864888586961726, 1.377490445956735, 1.3684323041260125, 1.3593218034555188, 1.350167168347705, 1.3409774357809285, 1.3317623998919894, 1.3225325426335526, 1.3132989508499662, 1.3040732205746344, 1.2948673498245507, 1.2856936216279229, 1.2765644794428934, 1.2674923974843511, 1.2584897487481586, 1.2495686736894238, 1.2407409525614406, 1.23201788434924, 1.2234101750375042, 1.2149278376480281, 1.2065801060811374, 1.1983753643213095, 1.1903210920441649, 1.1824238271172158, 1.1746891449476184, 1.1671216541218847, 1.1597250073282843, 1.1525019261685885, 1.1454542381667523, 1.1385829240729108, 1.1318881734442128, 1.1253694464547834, 1.1190255399381208, 1.1128546557832109, 1.1068544699786291, 1.1010222008101029, 1.0953546749529086, 1.0898483904465743, 1.0844995757832876, 1.0793042445737724, 1.0742582454666738, 1.0693573071847469, 1.0645970787001886, 1.0599731647006541, 1.0554811565976501, 1.0511166594010992, 1.0468753148310463, 1.0427528210616563, 1.0387449494983683, 1.034847558978512, 1.0310566077628192, 1.0273681636528726], 'Rp': [0.71512381537293201, 0.78597849089284466, 0.80377040312125636, 0.81334583838563035, 0.82052008049678993, 0.82657421038573053, 0.83202326012432404, 0.8371542244980632, 0.84214316183087712, 0.84709379671983231, 0.85205523586651666, 0.85703463102892763, 0.86201093305974008, 0.8669506254114846, 0.87182221366857859, 0.87660505338774353, 0.88129075447890504, 0.88587928555038986, 0.89037354341129082, 0.89477503847450479, 0.89908144546019331, 0.90328568609303683, 0.90737606322609299, 0.9113371653681035, 0.91515139153118608, 0.91880094027832948, 0.92227002110764256, 0.925546926331551, 0.92862552426576772, 0.93150581360650297, 0.93419344354135314, 0.93669842851977159, 0.93903349119423063, 0.94121246939821013, 0.94324907488007914, 0.94515610269101924, 0.94694504452279127, 0.94862598661559816, 0.95020766399010603, 0.95169757341970473, 0.95310209275261004, 0.95442659434562371, 0.95567556408930465, 0.95685274242061091, 0.95796129476174885, 0.95900400437735478, 0.95998346849743288, 0.96090227339400358, 0.96176312688951182, 0.96256893552625378, 0.96332282478432618, 0.96402811068901195, 0.96468823742485876, 0.96530669740870023, 0.96588694842463019, 0.96643233847388699, 0.96694604455401278, 0.96743102778100409, 0.96789000459976238, 0.96832543229579471, 0.96873950636706729, 0.96913416721989565, 0.96951111384692057, 0.96987182244771131, 0.97021756826160133, 0.97054944915782926, 0.97086840976155553, 0.97117526509802121, 0.97147072292498671, 0.97175540410903805, 0.97202986059052998, 0.97229459067261648, 0.97255005155395347, 0.97279666919060004, 0.9730348457076714, 0.97326496467791712, 0.97348739463749789, 0.97370249122339148, 0.97391059829682458, 0.97411204837454746, 0.97430716263381678, 0.9744962506975956, 0.97467961035005279, 0.97485752728354735, 0.97503027493874439, 0.9751981144692935, 0.97536129484069811, 0.97552005305844114, 0.9756746145107541, 0.97582519340628837, 0.97597199328420092, 0.97611520757383186, 0.97625502018227517, 0.97639160609012488, 0.97652513193894996, 0.97665575659748682, 0.97678363169752269, 0.97690890213449544, 0.97703170653158888, 0.97715217766970741, 0.97727044288808629, 0.97738662446238889, 0.97750083996796688, 0.9776132026357256, 0.97772382170727035, 0.97783280279431639, 0.97794024824493742, 0.97804625751700502, 0.97815092755664912, 0.9782543531772393, 0.97835662743262508, 0.97845784197685504, 0.97855808740231209, 0.97865745354755695, 0.97875602976717369, 0.97885390515667281, 0.97895116872698307, 0.97904790952470111, 0.97914421669594753, 0.97924017949340969, 0.97933588722766496, 0.97943142916489589, 0.97952689437441842, 0.97962237152963094, 0.97971794866657924, 0.97981371290398489, 0.97990975012864823, 0.98000614464941005, 0.98010297882253772, 0.98020033265071238, 0.98029828335732028, 0.98039690493741183, 0.98049626768616827, 0.9805964377058628, 0.98069747639213822, 0.98079943990093699, 0.98090237859769924, 0.98100633649133684, 0.98111135065633126, 0.98121745064756094, 0.98132465791371504, 0.9814329852166439, 0.98154243606579927, 0.98165300417829171, 0.98176467297713865, 0.98187741514164317, 0.98199119222529807, 0.98210595435787218, 0.98222164004878687, 0.98233817610919094, 0.98245547770950548, 0.98257344858769857, 0.98269198142163638, 0.98281095837511034, 0.98293025182377347, 0.98304972526164114, 0.98316923438379389, 0.98328862833456931, 0.98340775110480849, 0.98352644305513437, 0.98364454253751321, 0.98376188758200633, 0.98387831761255629, 0.98399367515335456, 0.98410780748657034, 0.98422056822347126, 0.98433181875321962, 0.98444142953784319, 0.98454928122694796, 0.98465526557202088, 0.98475928612691854, 0.98486125872826813, 0.98496111175656631, 0.9850587861851805, 0.98515423543072245, 0.98524742502282669, 0.98533833211559185, 0.98542694486548921, 0.98551326170203901, 0.98559729051808975, 0.98567904780546234, 0.98575855776085874, 0.98583585138377949, 0.98591096558626379, 0.98598394233059561, 0.98605482780829279, 0.98612367167012538, 0.9861905263143651, 0.9862554462372024, 0.98631848744719386, 0.98637970694335364, 0.98643916225483497, 0.98649691103895787, 0.98655301073320478, 0.98660751825644044, 0.98666048975406639, 0.98671198038194607, 0.98676204412391155, 0.98681073363811789, 0.98685810012779507]}
np_all_performances = eval(open(folder+'nmf_np_performances.txt','r').read())



# Assemble the average performances and method names
methods = ['VB-NM(T)F', 'G-NM(T)F', 'ICM-NM(T)F', 'NP-NM(T)F']
avr_performances = [
    vb_all_performances,
    gibbs_all_performances,
    icm_all_performances,
    np_all_performances
]
colours = ['r','b','g','c']

for metric in metrics:
    #fig = plt.figure(figsize=(3,2.5))
    #fig.subplots_adjust(left=0.09, right=0.96, bottom=0.12, top=0.96)
    fig = plt.figure(figsize=(1.9,1.5))
    fig.subplots_adjust(left=0.12, right=0.95, bottom=0.17, top=0.95)
    #plt.title("Performances (%s) for different fractions of missing values" % metric)
    plt.xlabel("Iterations", fontsize=8, labelpad=0)
    plt.ylabel(metric, fontsize=8, labelpad=-1)
    plt.yticks(range(0,MSE_max+1),fontsize=6)
    plt.xticks(fontsize=6)
    
    x = iterations
    for method, avr_performance, colour in zip(methods,avr_performances,colours):
        y = avr_performance[metric][0:len(iterations)]
        #plt.plot(x,y,label=method)
        plt.plot(x,y,linestyle='-', marker=None, label=method, c=colour)
        
    if metric == 'MSE':
        plt.ylim(0,MSE_max)
    elif metric == 'R^2' or metric == 'Rp':
        plt.ylim(0,1)
        
    # Set up the legend outside
    font_size_legend, number_of_columns, legend_box_line_width, legend_line_width = 12, 4, 1, 2
    ax = fig.add_subplot(111)
    legend_fig = plt.figure(figsize=(6.5,0.4))
    legend = legend_fig.legend(*ax.get_legend_handles_labels(), loc='center', prop={'size':font_size_legend}, ncol=number_of_columns)
    legend.get_frame().set_linewidth(legend_box_line_width)
    plt.setp(legend.get_lines(),linewidth=legend_line_width)
    